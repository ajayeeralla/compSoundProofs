(*

pose proof (mor_eval_andB 8  (if_then_else_M(Bvar 2) O
      (if_then_else_M (Bvar 3) O
         (if_then_else_M (Bvar 11)
            (if_then_else_M (Bvar 5) O
               (if_then_else_M
                  ((((Bvar 4) & (Bvar 11)) &
                    (Bvar 8)) & (notb (Bvar 12))) &
                  (Bvar 9)
                  (if_then_else_M (Bvar 7) O
                     (if_then_else_M (Bvar 19) grn4 O))
                  (if_then_else_M (Bvar 16)
                     (if_then_else_M
                        (Bvar 7) & (Bvar 10)
                        mx1rn1
                        (if_then_else_M
                           (Bvar 7) & (Bvar 16)
                           mx3rn3
                           (if_then_else_M
                              ((((Bvar 6) &
                                 (Bvar 11)) & 
                                (Bvar 8)) &
                               (notb (Bvar 12))) &
                              (Bvar 9) mx2rn1 O))) O)))
            (if_then_else_M (Bvar 13)
               (if_then_else_M (Bvar 4) O
                  (if_then_else_M
                     (Bvar 5) & (Bvar 10)
                     (if_then_else_M (Bvar 6) O
                        (if_then_else_M (Bvar 17) acc O))
                     (if_then_else_M (Bvar 14)
                        (if_then_else_M
                           (Bvar 7) & (Bvar 10)
                           mx1rn1
                           (if_then_else_M
                              (Bvar 7) & (Bvar 16)
                              mx3rn3
                              (if_then_else_M
                                 ((((Bvar 6) &
                                    (Bvar 11)) &
                                   (Bvar 8)) &
                                  (notb (Bvar 12))) &
                                 (Bvar 9) mx2rn1 O))) O))) O))))   (if_then_else_M (Bvar 8)
      (if_then_else_M (Bvar 3) O
         (if_then_else_M(Bvar 2) & (Bvar 8)
            (if_then_else_M (Bvar 5) O
               (if_then_else_M (Bvar 16) & (EQ_M (act x3) new)
                  (if_then_else_M (Bvar 7) O
                     (if_then_else_M (Bvar 13) acc O)) O))
            (if_then_else_M (Bvar 13) & (Bvar 12)
               (if_then_else_M (Bvar 5) O
                  (if_then_else_M
                     (Bvar 4) & (Bvar 8)
                     (if_then_else_M (Bvar 7) O
                        (if_then_else_M (Bvar 13) acc O))
                     (if_then_else_M
                        (Bvar 4) & (Bvar 11)
                        (if_then_else_M (Bvar 7) O
                           (if_then_else_M (Bvar 13) acc O))
                        (if_then_else_M (Bvar 16)
                           (if_then_else_M
                              (Bvar 6) & (Bvar 8)
                              mx1rn1
                              (if_then_else_M
                                 (Bvar 6) &
                                 (Bvar 11) mx2rn2
                                 (if_then_else_M
                                    ((((Bvar 7) &
                                       (Bvar 13)) &
                                      (Bvar 10)) &
                                     (notb (Bvar 12))) &
                                    (Bvar 9) mx2rn1
                                    (if_then_else_M
                                       ((((Bvar 7) &
                                          (Bvar 16)) &
                                         (Bvar 13)) &
                                        (notb (EQ_M (act x3) new))) &
                                       (Bvar 12) mx3rn2 O)))) O))))
               O)))
      (if_then_else_M (Bvar 10) & (Bvar 9)
         (if_then_else_M(Bvar 2) O
            (if_then_else_M (Bvar 3) O
               (if_then_else_M (Bvar 13)
                  (if_then_else_M (Bvar 4) O
                     (if_then_else_M
                        ((((Bvar 5) & (Bvar 13)) &
                          (Bvar 10)) & (notb (Bvar 12))) &
                        (Bvar 9)
                        (if_then_else_M (Bvar 6) O
                           (if_then_else_M (Bvar 17) grn4 O))
                        (if_then_else_M (Bvar 14)
                           (if_then_else_M
                              (Bvar 6) & (Bvar 8)
                              mx1rn1
                              (if_then_else_M
                                 (Bvar 6) &
                                 (Bvar 11) mx2rn2
                                 (if_then_else_M
                                    ((((Bvar 7) &
                                       (Bvar 13)) &
                                      (Bvar 10)) &
                                     (notb (Bvar 12))) &
                                    (Bvar 9) mx2rn1
                                    (if_then_else_M
                                       ((((Bvar 7) &
                                          (Bvar 16)) &
                                         (Bvar 13)) &
                                        (notb (EQ_M (act x3) new))) &
                                       (Bvar 12) mx3rn2 O)))) O)))
                  (if_then_else_M (Bvar 11)
                     (if_then_else_M (Bvar 5) O
                        (if_then_else_M
                           (Bvar 4) & (Bvar 8)
                           (if_then_else_M (Bvar 7) O
                              (if_then_else_M (Bvar 13) acc O))
                           (if_then_else_M
                              (Bvar 4) & (Bvar 11)
                              (if_then_else_M (Bvar 7) O
                                 (if_then_else_M (Bvar 13) acc O))
                              (if_then_else_M (Bvar 16)
                                 (if_then_else_M
                                    (Bvar 6) &
                                    (Bvar 8) mx1rn1
                                    (if_then_else_M
                                       (Bvar 6) &
                                       (Bvar 11) mx2rn2
                                       (if_then_else_M
                                          ((((Bvar 7) &
                                             (Bvar 13)) &
                                            (Bvar 10)) &
                                           (notb (Bvar 12))) &
                                          (Bvar 9) mx2rn1
                                          (if_then_else_M
                                             ((((Bvar 7) &
                                                (Bvar 16)) &
                                               (Bvar 13)) &
                                              (notb (EQ_M (act x3) new))) &
                                             (Bvar 12) mx3rn2 O))))
                                 O)))) O))))
         (if_then_else_M (Bvar 10)
            (if_then_else_M(Bvar 2) O
               (if_then_else_M
                 (Bvar 2) & (Bvar 8)
                  (if_then_else_M (Bvar 4) O
                     (if_then_else_M
                        (Bvar 14) & (EQ_M (act x3) new)
                        (if_then_else_M (Bvar 6) O
                           (if_then_else_M (Bvar 17) acc O)) O))
                  (if_then_else_M (Bvar 11) & (Bvar 12)
                     (if_then_else_M (Bvar 4) O
                        (if_then_else_M
                           (Bvar 5) & (Bvar 10)
                           (if_then_else_M (Bvar 6) O
                              (if_then_else_M (Bvar 17) acc O))
                           (if_then_else_M (Bvar 14)
                              (if_then_else_M
                                 (Bvar 7) &
                                 (Bvar 10) mx1rn1
                                 (if_then_else_M
                                    (Bvar 7) &
                                    (Bvar 16) mx3rn3
                                    (if_then_else_M
                                       ((((Bvar 6) &
                                          (Bvar 11)) &
                                         (Bvar 8)) &
                                        (notb (Bvar 12))) &
                                       (Bvar 9) mx2rn1 O))) O))) O)))
            O)))).
 





simpl in H. repeat rew_IFTF_all_in H.
 repeat rew_eval_in_msg H. repeat red_in H.
 
 repeat rew_ifmor_bol_bol_in_fst H.  
 
repeat red_in H.
 rew_ifmor_msg_bol_in H. repeat red_in H.
repeat rew_eval_in_msg H.
 repeat rew_ifmor_bol_bol_in_fst H.  

assert (m2m2':  (if_then_else_M (EQ_M (to x1) (i 1)) qc0010_ss
                 (if_then_else_M (EQ_M (to x1) (i 2)) & (EQ_M (act x1) new)
                    qc0100_ss
                    (if_then_else_M (EQ_M (to x1) (i 2)) qc0001_ss O))) # O).
simpl . try unfold qc0010_ss , qc0100_ss, qc0001_ss. repeat try unf_q.
 *) 
 
 
 
 
 simpl.

repeat redg.
pose proof(IFTF 3).
forall_elm 3 (if_then_else_B
                            (if_then_else_B
                               (if_then_else_B
                                  (EQ_M (reveal (f mphi2)) (i 1))
                                  (EQ_M (to (f mphi1)) (i 1)) FAlse) TRue
                               FAlse)
                            (if_then_else_B (EQ_M (act (f mphi1)) new) FAlse
                               TRue) FAlse) H.
apply Forall_ELM_EVAL_B with (n:=3) (b:=   (if_then_else_B
                            (if_then_else_B
                               (if_then_else_B
                                  (EQ_M (reveal (f mphi2)) (i 1))
                                  (EQ_M (to (f mphi1)) (i 1)) FAlse) TRue
                               FAlse)
                            (if_then_else_B (EQ_M (act (f mphi1)) new) FAlse
                               TRue) FAlse)) in H;simp_in  H; rew_clear H.
pose proof(IFTF 3);apply Forall_ELM_EVAL_B with (n:=3) (b:=  (if_then_else_B
                                  (EQ_M (reveal (f mphi2)) (i 1))
                                  (EQ_M (to (f mphi1)) (i 1)) FAlse)) in H;simp_in  H; rew_clear H.

pose proof(IFTF 3);apply Forall_ELM_EVAL_B with (n:=3) (b:=  (if_then_else_B
                                        (if_then_else_B
                                           (if_then_else_B
                                              (EQ_M (reveal (f mphi3)) (i 1))
                                              (EQ_M (to (f mphi1)) (i 1))
                                              FAlse) TRue FAlse)
                                        (if_then_else_B
                                           (EQ_M (act (f mphi1)) new) FAlse
                                           TRue) FAlse)) in H;simpl in H; rewrite H ; clear H.

pose proof(IFTF 3);apply Forall_ELM_EVAL_B with (n:=3) (b:=   (if_then_else_B
                                              (EQ_M (reveal (f mphi3)) (i 1))
                                              (EQ_M (to (f mphi1)) (i 1))
                                              FAlse)) in H;simpl in H; rewrite H ; clear H.

pose proof(IFTF 3);apply Forall_ELM_EVAL_B with (n:=3) (b:=   (if_then_else_B
                                             (if_then_else_B
                                                (EQ_M 
                                                  (reveal (f mphi3)) 
                                                  (i 2))
                                                (EQ_M (to (f mphi2)) (i 1))
                                                FAlse)
                                             (EQ_M (to (f mphi1)) (i 2))
                                             FAlse)) in H;simpl in H; rewrite H ; clear H.

pose proof(IFTF 3);apply Forall_ELM_EVAL_B with (n:=3) (b:=    (if_then_else_B
                                       (if_then_else_B
                                          (if_then_else_B
                                             (EQ_M (reveal (f mphi3)) (i 2))
                                             (EQ_M (to (f mphi2)) (i 1))
                                             FAlse)
                                          (EQ_M (to (f mphi1)) (i 2)) FAlse)
                                       (if_then_else_B
                                          (EQ_M (act (f mphi2)) new) FAlse
                                          TRue) FAlse)) in H;simpl in H; rewrite H ; clear H.

pose proof(IFTF 3);apply Forall_ELM_EVAL_B with (n:=3) (b:=   (if_then_else_B
                                                (if_then_else_B
                                                  (EQ_M 
                                                  (reveal (f mphi3)) 
                                                  (i 1))
                                                  (EQ_M (to (f mphi2)) (i 1))
                                                  FAlse)
                                                (EQ_M (to (f mphi1)) (i 2))
                                                FAlse)) in H;simpl in H; rewrite H ; clear H.

pose proof(IFTF 3);apply Forall_ELM_EVAL_B with (n:=3) (b:=    (if_then_else_B
                                             (if_then_else_B
                                                (if_then_else_B
                                                  (EQ_M 
                                                  (reveal (f mphi3)) 
                                                  (i 1))
                                                  (EQ_M (to (f mphi2)) (i 1))
                                                  FAlse)
                                                (EQ_M (to (f mphi1)) (i 2))
                                                FAlse)
                                             (if_then_else_B
                                                (EQ_M (act (f mphi2)) new)
                                                FAlse TRue) FAlse)) in H;simpl in H; rewrite H ; clear H.


pose proof(IFMORPH_B2 0  (EQ_M (to (f mphi1)) (i 1)) FAlse
                                        (if_then_else_B
                                           (EQ_M (act (f mphi1)) new) FAlse
                                           TRue) FAlse);
simpl in H ;rewrite IFFALSE_B in H;
apply Forall_ELM_EVAL_B with (n:=0) (b:=   (EQ_M (reveal (f mphi3)) (i 1))) in H;
simpl in H;
rewrite H; clear H.

pose proof(IFMORPH_B1   (if_then_else_B
                                              (EQ_M (act (f mphi1)) new)
                                              FAlse TRue) FAlse FAlse  0 1 );
rewrite IFSAME_B in H;

apply Forall_ELM_EVAL_B with (n:=1) (b:= (EQ_M (reveal (f mphi3)) (i 1))  ) in H;
simpl in H;

apply Forall_ELM_EVAL_B with (n:=0) (b:=  (EQ_M (to (f mphi1)) (i 1))) in H;
simpl in H;
rewrite H;
clear H. 


pose proof(IFMORPH_B1    FAlse TRue FAlse  0 1 );
rewrite IFSAME_B in H;

apply Forall_ELM_EVAL_B with (n:=1) (b:=  (EQ_M (reveal (f mphi3)) (i 1))  ) in H;
simpl in H;

apply Forall_ELM_EVAL_B with (n:=0) (b:=  (EQ_M (act (f mphi1)) new)) in H;
simpl in H;
rewrite H;
clear H. 

pose proof(IFTF 3);apply Forall_ELM_EVAL_B with (n:=3) (b:=    (EQ_M (reveal (f mphi3)) (i 1))) in H;simpl in H; rewrite H ; clear H.
pose proof(IFMORPH_B1   FAlse (EQ_M (reveal (f mphi3)) (i 1))  FAlse 0 1 );
rewrite IFSAME_B in H;

apply Forall_ELM_EVAL_B with (n:=1) (b:=  (EQ_M (to (f mphi1)) (i 1))  ) in H;
simpl in H;

apply Forall_ELM_EVAL_B with (n:=0) (b:=  (EQ_M (act (f mphi1)) new)) in H;
simpl in H;
rewrite H;
clear H. 

pose proof(IFMORPH_B4 0 FAlse  (EQ_M (reveal (f mphi3)) (i 1)) FAlse).
apply Forall_ELM_EVAL_B with (n:=0) (b:=  (EQ_M (act (f mphi1)) new)  ) in H;
simpl in H;

apply Forall_ELM_EVAL_B with (n:=1) (b:=  (EQ_M (to (f mphi1)) (i 1))) in H;
simpl in H; try rewrite IFSAME_B in H;
rewrite H;
clear H. 

pose proof(IFMORPH_B2 0   (EQ_M (to (f mphi1)) (i 1)) FAlse (if_then_else_B (EQ_M (act (f mphi1)) new) FAlse
                            TRue)  FAlse );
simpl in H ;rewrite IFFALSE_B in H;
apply Forall_ELM_EVAL_B with (n:=0) (b:=   (EQ_M (reveal (f mphi2)) (i 1))) in H;
simpl in H;
rewrite H; clear H.


pose proof(IFMORPH_B1    (if_then_else_B (EQ_M (act (f mphi1)) new) FAlse
                               TRue) FAlse FAlse  0 1 );
rewrite IFSAME_B in H;

apply Forall_ELM_EVAL_B with (n:=1) (b:=   (EQ_M (reveal (f mphi2)) (i 1)) ) in H;
simpl in H;

apply Forall_ELM_EVAL_B with (n:=0) (b:=  (EQ_M (to (f mphi1)) (i 1))) in H;
simpl in H;
rewrite H;
clear H. 

pose proof(IFMORPH_B1     FAlse
                               TRue FAlse  0 1 );
rewrite IFSAME_B in H;

apply Forall_ELM_EVAL_B with (n:=1) (b:=   (EQ_M (reveal (f mphi2)) (i 1)) ) in H;
simpl in H;

apply Forall_ELM_EVAL_B with (n:=0) (b:= (EQ_M (act (f mphi1)) new) ) in H;
simpl in H;
rewrite H;
clear H. 


pose proof(IFMORPH_B4 0 FAlse TRue FAlse).
apply Forall_ELM_EVAL_B with (n:=0) (b:= (EQ_M (act (f mphi1)) new) ) in H;
simpl in H;

apply Forall_ELM_EVAL_B with (n:=1) (b:=   (EQ_M (reveal (f mphi2)) (i 1))) in H;
simpl in H; try rewrite IFSAME_B in H;
rewrite H;
clear H. 

pose proof(IFMORPH_M2 0  (if_then_else_B
                                        (EQ_M (act (f mphi1)) new) FAlse
                                        (EQ_M (reveal (f mphi3)) (i 1)))
                                     FAlse    (exp (pi1 (ggen (N 0))) 
                                     (m (f mphi1)) 
                                     (r (N 1))) O) ;
            apply Forall_ELM_EVAL_M with (n:=0) (x:=  (EQ_M (to (f mphi1)) (i 1)) ) in H;
simpl in H;  red_in H; rew_clear H.

pose proof(IFMORPH_M2 0  FAlse
                                           (EQ_M (reveal (f mphi3)) (i 1))
                                        (exp (pi1 (ggen (N 0))) 
                                           (m (f mphi1)) 
                                           (r (N 1))) O) ;
            apply Forall_ELM_EVAL_M with (n:=0) (x:=   (EQ_M (act (f mphi1)) new) ) in H;
simpl in H;  try rewrite IFFALSE_M in H; rewrite H; clear H.

pose proof(IFMORPH_M2 0  (EQ_M (to (f mphi2)) (i 2)) FAlse
                                          (exp (pi1 (ggen (N 0))) 
                                     (m (f mphi2)) 
                                     (r (N 3)))
                                  (if_then_else_M (EQ_M (to (f mphi1)) (i 1))
                                     (if_then_else_M
                                        (EQ_M (act (f mphi1)) new) O
                                        (if_then_else_M
                                           (EQ_M (reveal (f mphi3)) (i 1))
                                           (exp (pi1 (ggen (N 0)))
                                              (m (f mphi1)) 
                                              (r (N 1))) O)) O)) ;
            apply Forall_ELM_EVAL_M with (n:=0) (x:=    (EQ_M (reveal (f mphi3)) (i 2)) ) in H;
simpl in H;  try rewrite IFFALSE_M in H; rewrite H; clear H.

pose proof(IFMORPH_M2 0   (if_then_else_B (EQ_M (reveal (f mphi2)) (i 1))
                            (if_then_else_B (EQ_M (act (f mphi1)) new) FAlse
                               TRue) FAlse) FAlse
                      (if_then_else_M (EQ_M (reveal (f mphi3)) (i 2)) O
                         (if_then_else_M (EQ_M (to (f mphi3)) (i 2))
                            (exp (pi1 (ggen (N 0))) 
                               (pi2 (ggen (N 0))) (r (N 4))) O))
                      (if_then_else_M (EQ_M (to (f mphi2)) (i 2))
                         (if_then_else_M
                            (if_then_else_B (EQ_M (reveal (f mphi3)) (i 2))
                               (EQ_M (to (f mphi0)) (i 2)) FAlse)
                            (exp (pi1 (ggen (N 0))) (m (f mphi0)) (r (N 1)))
                            (if_then_else_M (EQ_M (reveal (f mphi3)) (i 2))
                               (if_then_else_M (EQ_M (to (f mphi2)) (i 2))
                                  (exp (pi1 (ggen (N 0))) 
                                     (m (f mphi2)) 
                                     (r (N 3)))
                                  (if_then_else_M (EQ_M (to (f mphi1)) (i 1))
                                     (if_then_else_M
                                        (EQ_M (act (f mphi1)) new) O
                                        (if_then_else_M
                                           (EQ_M (reveal (f mphi3)) (i 1))
                                           (exp (pi1 (ggen (N 0)))
                                              (m (f mphi1)) 
                                              (r (N 1))) O)) O))
                               (if_then_else_M (EQ_M (to (f mphi1)) (i 1))
                                  (if_then_else_M (EQ_M (act (f mphi1)) new)
                                     O
                                     (if_then_else_M
                                        (EQ_M (reveal (f mphi3)) (i 1))
                                        (exp (pi1 (ggen (N 0))) 
                                           (m (f mphi1)) 
                                           (r (N 1))) O)) O))) O) ).
            apply Forall_ELM_EVAL_M with (n:=0) (x:=    (EQ_M (to (f mphi1)) (i 1))) in H;
simpl in H;  try rewrite IFFALSE_M in H; rewrite H; clear H.

pose proof(IFMORPH_M2 0   (if_then_else_B (EQ_M (act (f mphi1)) new) FAlse
                               TRue) FAlse
                         (if_then_else_M (EQ_M (reveal (f mphi3)) (i 2)) O
                            (if_then_else_M (EQ_M (to (f mphi3)) (i 2))
                               (exp (pi1 (ggen (N 0))) 
                                  (pi2 (ggen (N 0))) 
                                  (r (N 4))) O))
                         (if_then_else_M (EQ_M (to (f mphi2)) (i 2))
                            (if_then_else_M
                               (if_then_else_B
                                  (EQ_M (reveal (f mphi3)) (i 2))
                                  (EQ_M (to (f mphi0)) (i 2)) FAlse)
                               (exp (pi1 (ggen (N 0))) 
                                  (m (f mphi0)) (r (N 1)))
                               (if_then_else_M
                                  (EQ_M (reveal (f mphi3)) (i 2))
                                  (if_then_else_M (EQ_M (to (f mphi2)) (i 2))
                                     (exp (pi1 (ggen (N 0))) 
                                        (m (f mphi2)) 
                                        (r (N 3)))
                                     (if_then_else_M
                                        (EQ_M (to (f mphi1)) (i 1))
                                        (if_then_else_M
                                           (EQ_M (act (f mphi1)) new) O
                                           (if_then_else_M
                                              (EQ_M (reveal (f mphi3)) (i 1))
                                              (exp 
                                                 (pi1 (ggen (N 0)))
                                                 (m (f mphi1)) 
                                                 (r (N 1))) O)) O))
                                  (if_then_else_M (EQ_M (to (f mphi1)) (i 1))
                                     (if_then_else_M
                                        (EQ_M (act (f mphi1)) new) O
                                        (if_then_else_M
                                           (EQ_M (reveal (f mphi3)) (i 1))
                                           (exp (pi1 (ggen (N 0)))
                                              (m (f mphi1)) 
                                              (r (N 1))) O)) O))) O) ) ;
            apply Forall_ELM_EVAL_M with (n:=0) (x:=  (EQ_M (reveal (f mphi2)) (i 1))) in H;
simpl in H;  try rewrite IFFALSE_M in H; rewrite H; clear H.


pose proof(IFMORPH_M2 0  FAlse
                               TRue
                            (if_then_else_M (EQ_M (reveal (f mphi3)) (i 2)) O
                               (if_then_else_M (EQ_M (to (f mphi3)) (i 2))
                                  (exp (pi1 (ggen (N 0))) 
                                     (pi2 (ggen (N 0))) 
                                     (r (N 4))) O))
                            (if_then_else_M (EQ_M (to (f mphi2)) (i 2))
                               (if_then_else_M
                                  (if_then_else_B
                                     (EQ_M (reveal (f mphi3)) (i 2))
                                     (EQ_M (to (f mphi0)) (i 2)) FAlse)
                                  (exp (pi1 (ggen (N 0))) 
                                     (m (f mphi0)) 
                                     (r (N 1)))
                                  (if_then_else_M
                                     (EQ_M (reveal (f mphi3)) (i 2))
                                     (if_then_else_M
                                        (EQ_M (to (f mphi2)) (i 2))
                                        (exp (pi1 (ggen (N 0))) 
                                           (m (f mphi2)) 
                                           (r (N 3)))
                                        (if_then_else_M
                                           (EQ_M (to (f mphi1)) (i 1))
                                           (if_then_else_M
                                              (EQ_M (act (f mphi1)) new) O
                                              (if_then_else_M
                                                 (EQ_M 
                                                  (reveal (f mphi3)) 
                                                  (i 1))
                                                 (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi1)) 
                                                  (r (N 1))) O)) O))
                                     (if_then_else_M
                                        (EQ_M (to (f mphi1)) (i 1))
                                        (if_then_else_M
                                           (EQ_M (act (f mphi1)) new) O
                                           (if_then_else_M
                                              (EQ_M (reveal (f mphi3)) (i 1))
                                              (exp 
                                                 (pi1 (ggen (N 0)))
                                                 (m (f mphi1)) 
                                                 (r (N 1))) O)) O))) O)) ;
            apply Forall_ELM_EVAL_M with (n:=0) (x:=    (EQ_M (act (f mphi1)) new) ) in H;
simpl in H;  try rewrite IFFALSE_M in H; rewrite H; clear H.
rewrite IFTRUE_M.
(**********************(EQ_M (reveal (f mphi3)) (i 2))
                                     (EQ_M (to (f mphi0)) (i 2)) ********)
 pose proof ( mor_eval_andB  1  (exp (pi1 (ggen (N 0))) 
                                     (m (f mphi0)) 
                                     (r (N 1)))   (if_then_else_M
                                     (Bvar 1)
                                     (if_then_else_M
                                        (EQ_M (to (f mphi2)) (i 2))
                                        (exp (pi1 (ggen (N 0))) 
                                           (m (f mphi2)) 
                                           (r (N 3)))
                                        (if_then_else_M
                                           (EQ_M (to (f mphi1)) (i 1))
                                           (if_then_else_M
                                              (EQ_M (act (f mphi1)) new) O
                                              (if_then_else_M
                                                 (EQ_M 
                                                  (reveal (f mphi3)) 
                                                  (i 1))
                                                 (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi1)) 
                                                  (r (N 1))) O)) O))
                                     (if_then_else_M
                                        (EQ_M (to (f mphi1)) (i 1))
                                        (if_then_else_M
                                           (EQ_M (act (f mphi1)) new) O
                                           (if_then_else_M
                                              (EQ_M (reveal (f mphi3)) (i 1))
                                              (exp 
                                                 (pi1 (ggen (N 0)))
                                                 (m (f mphi1)) 
                                                 (r (N 1))) O)) O)) ).


simpl in H.

repeat red_in H.
apply Forall_ELM_EVAL_M with (n:=1) (x:=  (EQ_M (reveal (f mphi3)) (i 2))) in H;simpl in H;
apply Forall_ELM_EVAL_M with (n:=2) (x:=   (EQ_M (to (f mphi0)) (i 2)) ) in H;
simpl in H;rewrite H;clear H.

(*****************RHS**************)

pose proof(IFMORPH_B2 0   (EQ_M (to (f mphi2)) (i 1)) FAlse
                                       (EQ_M (to (f mphi1)) (i 2)) FAlse);
simpl in H ;rewrite IFFALSE_B in H;
apply Forall_ELM_EVAL_B with (n:=0) (b:=   ((EQ_M (reveal (f mphi3)) (i 2)))) in H;
simpl in H;
rewrite H; clear H.


pose proof(IFMORPH_B2 0  (if_then_else_B
                                          (EQ_M (to (f mphi2)) (i 1))
                                          (EQ_M (to (f mphi1)) (i 2)) FAlse)
                                       FAlse
                                    (if_then_else_B
                                       (EQ_M (act (f mphi2)) new) FAlse TRue)
                                    FAlse);
simpl in H ;rewrite IFFALSE_B in H;
apply Forall_ELM_EVAL_B with (n:=0) (b:=    (EQ_M (reveal (f mphi3)) (i 2))) in H;
simpl in H;
rewrite H; clear H.


pose proof(IFMORPH_B2 0  (EQ_M (to (f mphi1)) (i 2)) FAlse
                                       (if_then_else_B
                                          (EQ_M (act (f mphi2)) new) FAlse
                                          TRue) FAlse);
simpl in H ;rewrite IFFALSE_B in H;
apply Forall_ELM_EVAL_B with (n:=0) (b:=    (EQ_M (to (f mphi2)) (i 1))) in H;
simpl in H;
rewrite H; clear H.

pose proof(IFMORPH_B2 0  (if_then_else_B
                                       (EQ_M (to (f mphi2)) (i 1))
                                       (if_then_else_B
                                          (EQ_M (to (f mphi1)) (i 2))
                                          (if_then_else_B
                                             (EQ_M (act (f mphi2)) new) FAlse
                                             TRue) FAlse) FAlse) FAlse
                                 (EQ_M (m (f mphi1))
                                    (exp (pi1 (ggen (N 0)))
                                       (pi2 (ggen (N 0))) 
                                       (r (N 1)))) FAlse);
simpl in H. rewrite IFFALSE_B in H.
apply Forall_ELM_EVAL_B with (n:=0) (b:=   (EQ_M (reveal (f mphi3)) (i 2))) in H;
simpl in H;
rewrite H; clear H.
pose proof(IFMORPH_B2 0   (if_then_else_B
                                    (if_then_else_B
                                       (EQ_M (to (f mphi2)) (i 1))
                                       (if_then_else_B
                                          (EQ_M (to (f mphi1)) (i 2))
                                          (if_then_else_B
                                             (EQ_M (act (f mphi2)) new) FAlse
                                             TRue) FAlse) FAlse)
                                    (EQ_M (m (f mphi1))
                                       (exp (pi1 (ggen (N 0)))
                                          (pi2 (ggen (N 0))) 
                                          (r (N 1)))) FAlse) FAlse
                              (EQ_M (m (f mphi2))
                                 (exp (pi1 (ggen (N 0))) 
                                    (pi2 (ggen (N 0))) 
                                    (r (N 2)))) FAlse);
simpl in H. rewrite IFFALSE_B in H.
apply Forall_ELM_EVAL_B with (n:=0) (b:=  (EQ_M (reveal (f mphi3)) (i 2))) in H;
simpl in H;
rewrite H; clear H.
pose proof(IFMORPH_B2 0    (if_then_else_B
                                          (EQ_M (to (f mphi1)) (i 2))
                                          (if_then_else_B
                                             (EQ_M (act (f mphi2)) new) FAlse
                                             TRue) FAlse) FAlse
                                    (EQ_M (m (f mphi1))
                                       (exp (pi1 (ggen (N 0)))
                                          (pi2 (ggen (N 0))) 
                                          (r (N 1)))) FAlse);
simpl in H. rewrite IFFALSE_B in H.
apply Forall_ELM_EVAL_B with (n:=0) (b:=(EQ_M (to (f mphi2)) (i 1))  ) in H;
simpl in H;
rewrite H; clear H.

pose proof(IFMORPH_B2 0    (if_then_else_B
                                             (EQ_M (act (f mphi2)) new) FAlse
                                             TRue) FAlse
                                       (EQ_M (m (f mphi1))
                                          (exp (pi1 (ggen (N 0)))
                                             (pi2 (ggen (N 0))) 
                                             (r (N 1)))) FAlse);
simpl in H. rewrite IFFALSE_B in H.
apply Forall_ELM_EVAL_B with (n:=0) (b:= (EQ_M (to (f mphi1)) (i 2))  ) in H;
simpl in H;
rewrite H; clear H.


pose proof(IFMORPH_B2 0   FAlse
                                             TRue
                                          (EQ_M (m (f mphi1))
                                             (exp (pi1 (ggen (N 0)))
                                                (pi2 (ggen (N 0))) 
                                                (r (N 1)))) FAlse);
simpl in H. rewrite IFFALSE_B in H.
apply Forall_ELM_EVAL_B with (n:=0) (b:= (EQ_M (act (f mphi2)) new)) in H;
simpl in H;
rewrite H; clear H.
rewrite IFTRUE_B.

pose proof(IFMORPH_B2 0    (if_then_else_B
                                       (EQ_M (to (f mphi1)) (i 2))
                                       (if_then_else_B
                                          (EQ_M (act (f mphi2)) new) FAlse
                                          (EQ_M (m (f mphi1))
                                             (exp (pi1 (ggen (N 0)))
                                                (pi2 (ggen (N 0))) 
                                                (r (N 1))))) FAlse) FAlse
                                 (EQ_M (m (f mphi2))
                                    (exp (pi1 (ggen (N 0)))
                                       (pi2 (ggen (N 0))) 
                                       (r (N 2)))) FAlse);
simpl in H. rewrite IFFALSE_B in H.
apply Forall_ELM_EVAL_B with (n:=0) (b:=  (EQ_M (to (f mphi2)) (i 1))) in H;
simpl in H;
rewrite H; clear H.

pose proof(IFMORPH_B2 0     (if_then_else_B
                                          (EQ_M (act (f mphi2)) new) FAlse
                                          (EQ_M (m (f mphi1))
                                             (exp (pi1 (ggen (N 0)))
                                                (pi2 (ggen (N 0))) 
                                                (r (N 1))))) FAlse
                                    (EQ_M (m (f mphi2))
                                       (exp (pi1 (ggen (N 0)))
                                          (pi2 (ggen (N 0))) 
                                          (r (N 2)))) FAlse);
simpl in H. rewrite IFFALSE_B in H.
apply Forall_ELM_EVAL_B with (n:=0) (b:= (EQ_M (to (f mphi1)) (i 2))) in H;
simpl in H;
rewrite H; clear H.
pose proof(IFMORPH_B2 0   FAlse
                                          (EQ_M (m (f mphi1))
                                             (exp (pi1 (ggen (N 0)))
                                                (pi2 (ggen (N 0))) 
                                                (r (N 1))))
                                       (EQ_M (m (f mphi2))
                                          (exp (pi1 (ggen (N 0)))
                                             (pi2 (ggen (N 0))) 
                                             (r (N 2)))) FAlse  );
simpl in H; rewrite IFFALSE_B in H;
apply Forall_ELM_EVAL_B with (n:=0) (b:=(EQ_M (act (f mphi2)) new)) in H;
simpl in H;
rewrite H; clear H.
 pose proof(IFMORPH_B4 0   FAlse    (EQ_M (m (f mphi2))
                                             (exp (pi1 (ggen (N 0)))
                                                (pi2 (ggen (N 0))) 
                                                (r (N 2)))) FAlse );
apply Forall_ELM_EVAL_B with (n:=0) (b:= (EQ_M (act (f mphi2)) new) ) in H;
simpl in H;

apply Forall_ELM_EVAL_B with (n:=1) (b:=  (EQ_M (m (f mphi1))
                                             (exp (pi1 (ggen (N 0)))
                                                (pi2 (ggen (N 0))) 
                                                (r (N 1))))) in H;
simpl in H; try rewrite IFSAME_B in H;
rewrite H;
clear H.

pose proof(IFMORPH_B1    
                                             (if_then_else_B
                                          (EQ_M (act (f mphi2)) new) FAlse
                                          (EQ_M (m (f mphi2))
                                             (exp (pi1 (ggen (N 0)))
                                                (pi2 (ggen (N 0))) 
                                                (r (N 2))))) FAlse FAlse  0 1 );
rewrite IFSAME_B in H;

apply Forall_ELM_EVAL_B with (n:=1) (b:= (EQ_M (to (f mphi1)) (i 2))  ) in H;
simpl in H;

apply Forall_ELM_EVAL_B with (n:=0) (b:=  (EQ_M (m (f mphi1))
                                          (exp (pi1 (ggen (N 0)))
                                             (pi2 (ggen (N 0))) 
                                             (r (N 1)))) ) in H;
simpl in H;
rewrite H;
clear H. 


pose proof(IFMORPH_B1    
                                         FAlse
                                          (EQ_M (m (f mphi2))
                                             (exp (pi1 (ggen (N 0)))
                                                (pi2 (ggen (N 0))) 
                                                (r (N 2)))) FAlse  0 1 );
rewrite IFSAME_B in H;

apply Forall_ELM_EVAL_B with (n:=1) (b:=  (EQ_M (to (f mphi1)) (i 2)) ) in H;
simpl in H;

apply Forall_ELM_EVAL_B with (n:=0) (b:= (EQ_M (act (f mphi2)) new) ) in H;
simpl in H;
rewrite H;
clear H. 
 pose proof(IFMORPH_B4 0   FAlse   (EQ_M (m (f mphi2))
                                             (exp (pi1 (ggen (N 0)))
                                                (pi2 (ggen (N 0))) 
                                                (r (N 2)))) FAlse    );
apply Forall_ELM_EVAL_B with (n:=0) (b:=  (EQ_M (act (f mphi2)) new) ) in H;
simpl in H;

apply Forall_ELM_EVAL_B with (n:=1) (b:=(EQ_M (to (f mphi1)) (i 2))  ) in H;
simpl in H; try rewrite IFSAME_B in H;
rewrite H;
clear H.
pose proof(IFMORPH_B1    (if_then_else_B
                                          (EQ_M (act (f mphi2)) new) FAlse
                                          (EQ_M (m (f mphi2))
                                             (exp (pi1 (ggen (N 0)))
                                                (pi2 (ggen (N 0))) 
                                                (r (N 2))))) FAlse FAlse 0 1);

rewrite IFSAME_B in H;

apply Forall_ELM_EVAL_B with (n:=1) (b:=  (EQ_M (m (f mphi1))
                                       (exp (pi1 (ggen (N 0)))
                                          (pi2 (ggen (N 0))) 
                                          (r (N 1)))) ) in H;
simpl in H;

apply Forall_ELM_EVAL_B with (n:=0) (b:=  (EQ_M (to (f mphi1)) (i 2)) ) in H;
simpl in H;
rewrite H;
clear H. 


pose proof(IFMORPH_B1   FAlse
                                          (EQ_M (m (f mphi2))
                                             (exp (pi1 (ggen (N 0)))
                                                (pi2 (ggen (N 0))) 
                                                (r (N 2)))) FAlse  0 1);

rewrite IFSAME_B in H;

apply Forall_ELM_EVAL_B with (n:=1) (b:=   (EQ_M (m (f mphi1))
                                          (exp (pi1 (ggen (N 0)))
                                             (pi2 (ggen (N 0))) 
                                             (r (N 1))))) in H;
simpl in H;

apply Forall_ELM_EVAL_B with (n:=0) (b:=  (EQ_M (act (f mphi2)) new)  ) in H;
simpl in H;
rewrite H;
clear H. 

pose proof(IFMORPH_B2 0    (EQ_M (to (f mphi2)) (i 1))
                                                FAlse
                                             (EQ_M (to (f mphi1)) (i 2))
                                             FAlse);
simpl in H. rewrite IFFALSE_B in H.
apply Forall_ELM_EVAL_B with (n:=0) (b:=  (EQ_M 
                                                  (reveal (f mphi3)) 
                                                  (i 1)) ) in H;
simpl in H;
rewrite H; clear H.


pose proof(IFMORPH_B2 0     (if_then_else_B
                                             (EQ_M (to (f mphi2)) (i 1))
                                             (EQ_M (to (f mphi1)) (i 2))
                                             FAlse) FAlse
                                       (if_then_else_B
                                          (EQ_M (act (f mphi2)) new) FAlse
                                          TRue) FAlse);
simpl in H; rewrite IFFALSE_B in H;
apply Forall_ELM_EVAL_B with (n:=0) (b:= (EQ_M (reveal (f mphi3)) (i 1))) in H;
simpl in H;
rewrite H; clear H.
pose proof(IFMORPH_B2 0      (if_then_else_B
                                          (if_then_else_B
                                             (EQ_M (to (f mphi2)) (i 1))
                                             (EQ_M (to (f mphi1)) (i 2))
                                             FAlse)
                                          (if_then_else_B
                                             (EQ_M (act (f mphi2)) new) FAlse
                                             TRue) FAlse) FAlse
                                    (EQ_M (m (f mphi1))
                                       (exp (pi1 (ggen (N 0)))
                                          (pi2 (ggen (N 0))) 
                                          (r (N 1)))) FAlse);
simpl in H; rewrite IFFALSE_B in H;
apply Forall_ELM_EVAL_B with (n:=0) (b:= (EQ_M (reveal (f mphi3)) (i 1))) in H;
simpl in H;
rewrite H; clear H.

pose proof(IFMORPH_B2 0       (EQ_M (to (f mphi1)) (i 2))
                                             FAlse
                                          (if_then_else_B
                                             (EQ_M (act (f mphi2)) new) FAlse
                                             TRue) FAlse);
simpl in H; rewrite IFFALSE_B in H;
apply Forall_ELM_EVAL_B with (n:=0) (b:= (EQ_M (to (f mphi2)) (i 1))) in H;
simpl in H;
rewrite H; clear H.


pose proof(IFMORPH_B2 0      (if_then_else_B
                                             (EQ_M (to (f mphi1)) (i 2))
                                             (if_then_else_B
                                                (EQ_M (act (f mphi2)) new)
                                                FAlse TRue) FAlse) FAlse
                                       (EQ_M (m (f mphi1))
                                          (exp (pi1 (ggen (N 0)))
                                             (pi2 (ggen (N 0))) 
                                             (r (N 1)))) FAlse);
simpl in H; rewrite IFFALSE_B in H;
apply Forall_ELM_EVAL_B with (n:=0) (b:= (EQ_M (to (f mphi2)) (i 1))) in H;
simpl in H;
rewrite H; clear H.

pose proof(IFMORPH_B2 0        (if_then_else_B
                                                (EQ_M (act (f mphi2)) new)
                                                FAlse TRue) FAlse
                                          (EQ_M (m (f mphi1))
                                             (exp (pi1 (ggen (N 0)))
                                                (pi2 (ggen (N 0))) 
                                                (r (N 1)))) FAlse);
simpl in H; rewrite IFFALSE_B in H;
apply Forall_ELM_EVAL_B with (n:=0) (b:= (EQ_M (to (f mphi1)) (i 2))) in H;
simpl in H;
rewrite H; clear H.

pose proof(IFMORPH_B2 0       FAlse TRue
                                             (EQ_M 
                                                (m (f mphi1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1)))) FAlse);
simpl in H; rewrite IFFALSE_B in H;
apply Forall_ELM_EVAL_B with (n:=0) (b:= (EQ_M (act (f mphi2)) new)) in H;
simpl in H;
rewrite H; clear H.
rewrite IFTRUE_B.
pose proof(IFMORPH_B2 0       (if_then_else_B
                                       (EQ_M (to (f mphi2)) (i 1))
                                       (if_then_else_B
                                          (EQ_M (to (f mphi1)) (i 2))
                                          (if_then_else_B
                                             (EQ_M (act (f mphi2)) new) FAlse
                                             (EQ_M 
                                                (m (f mphi1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))) FAlse) FAlse)
                                    FAlse
                                 (EQ_M (m (f mphi2))
                                    (exp (pi1 (ggen (N 0)))
                                       (pi2 (ggen (N 0))) 
                                       (r (N 2)))) FAlse);
simpl in H; rewrite IFFALSE_B in H;
apply Forall_ELM_EVAL_B with (n:=0) (b:=  (EQ_M (reveal (f mphi3)) (i 1))) in H;
simpl in H;
rewrite H; clear H.

pose proof(IFMORPH_B2 0        (if_then_else_B
                                          (EQ_M (to (f mphi1)) (i 2))
                                          (if_then_else_B
                                             (EQ_M (act (f mphi2)) new) FAlse
                                             (EQ_M 
                                                (m (f mphi1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))) FAlse) FAlse
                                    (EQ_M (m (f mphi2))
                                       (exp (pi1 (ggen (N 0)))
                                          (pi2 (ggen (N 0))) 
                                          (r (N 2)))) FAlse );
simpl in H; rewrite IFFALSE_B in H;
apply Forall_ELM_EVAL_B with (n:=0) (b:=  (EQ_M (to (f mphi2)) (i 1))) in H;
simpl in H;
rewrite H; clear H.

pose proof(IFMORPH_B2 0       (if_then_else_B
                                             (EQ_M (act (f mphi2)) new) FAlse
                                             (EQ_M 
                                                (m (f mphi1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))) FAlse
                                       (EQ_M (m (f mphi2))
                                          (exp (pi1 (ggen (N 0)))
                                             (pi2 (ggen (N 0))) 
                                             (r (N 2)))) FAlse );
simpl in H; rewrite IFFALSE_B in H;
apply Forall_ELM_EVAL_B with (n:=0) (b:=   (EQ_M (to (f mphi1)) (i 2))) in H;
simpl in H;
rewrite H; clear H.

pose proof(IFMORPH_B2 0       FAlse
                                             (EQ_M 
                                                (m (f mphi1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                          (EQ_M (m (f mphi2))
                                             (exp (pi1 (ggen (N 0)))
                                                (pi2 (ggen (N 0))) 
                                                (r (N 2)))) FAlse );
simpl in H; rewrite IFFALSE_B in H;
apply Forall_ELM_EVAL_B with (n:=0) (b:= (EQ_M (act (f mphi2)) new)  ) in H;
simpl in H;
rewrite H; clear H.
pose proof(IFMORPH_M2 0    (if_then_else_B (EQ_M (reveal (f mphi2)) (i 1))
                           (if_then_else_B (EQ_M (act (f mphi1)) new) FAlse
                              TRue) FAlse) FAlse   (if_then_else_M (EQ_M (reveal (f mphi3)) (i 2)) O
                        (if_then_else_M (EQ_M (to (f mphi3)) (i 2))
                           (exp (pi1 (ggen (N 0))) 
                              (pi2 (ggen (N 0))) (r (N 4))) O)) (if_then_else_M (EQ_M (to (f mphi2)) (i 2))
                        (if_then_else_M
                           (if_then_else_B (EQ_M (reveal (f mphi3)) (i 2))
                              (if_then_else_B (EQ_M (to (f mphi2)) (i 1))
                                 (if_then_else_B (EQ_M (to (f mphi1)) (i 2))
                                    (if_then_else_B
                                       (EQ_M (act (f mphi2)) new) FAlse
                                       (if_then_else_B
                                          (EQ_M (m (f mphi1))
                                             (exp (pi1 (ggen (N 0)))
                                                (pi2 (ggen (N 0))) 
                                                (r (N 1))))
                                          (EQ_M (m (f mphi2))
                                             (exp (pi1 (ggen (N 0)))
                                                (pi2 (ggen (N 0))) 
                                                (r (N 2)))) FAlse)) FAlse)
                                 FAlse) FAlse)
                           (exp (pi1 (ggen (N 0))) (m (f mphi1)) (r (N 2)))
                           (if_then_else_M
                              (if_then_else_B (EQ_M (reveal (f mphi3)) (i 1))
                                 (if_then_else_B (EQ_M (to (f mphi2)) (i 1))
                                    (if_then_else_B
                                       (EQ_M (to (f mphi1)) (i 2))
                                       (if_then_else_B
                                          (EQ_M (act (f mphi2)) new) FAlse
                                          (if_then_else_B
                                             (EQ_M 
                                                (m (f mphi1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                             (EQ_M 
                                                (m (f mphi2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse)) FAlse)
                                    FAlse) FAlse)
                              (exp (pi1 (ggen (N 0))) (m (f mphi2)) (r (N 1)))
                              (if_then_else_M (EQ_M (reveal (f mphi3)) (i 2))
                                 (if_then_else_M (EQ_M (to (f mphi0)) (i 2))
                                    (exp (pi1 (ggen (N 0))) 
                                       (m (f mphi0)) 
                                       (r (N 1)))
                                    (if_then_else_M
                                       (EQ_M (to (f mphi2)) (i 2))
                                       (exp (pi1 (ggen (N 0))) 
                                          (m (f mphi2)) 
                                          (r (N 3)))
                                       (if_then_else_M
                                          (EQ_M (to (f mphi1)) (i 1))
                                          (if_then_else_M
                                             (EQ_M (act (f mphi1)) new) O
                                             (if_then_else_M
                                                (EQ_M 
                                                  (reveal (f mphi3)) 
                                                  (i 1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi1)) 
                                                  (r (N 1))) O)) O)))
                                 (if_then_else_M (EQ_M (to (f mphi1)) (i 1))
                                    (if_then_else_M
                                       (EQ_M (act (f mphi1)) new) O
                                       (if_then_else_M
                                          (EQ_M (reveal (f mphi3)) (i 1))
                                          (exp (pi1 (ggen (N 0)))
                                             (m (f mphi1)) 
                                             (r (N 1))) O)) O)))) O) );
            apply Forall_ELM_EVAL_M with (n:=0) (x:=   (EQ_M (to (f mphi1)) (i 1))) in H;
simpl in H;  try rewrite IFFALSE_M in H; rewrite H; clear H.



 



pose proof(IFMORPH_M2 0     (if_then_else_B (EQ_M (act (f mphi1)) new) FAlse
                              TRue) FAlse
                        (if_then_else_M (EQ_M (reveal (f mphi3)) (i 2)) O
                           (if_then_else_M (EQ_M (to (f mphi3)) (i 2))
                              (exp (pi1 (ggen (N 0))) 
                                 (pi2 (ggen (N 0))) 
                                 (r (N 4))) O))    (if_then_else_M (EQ_M (to (f mphi2)) (i 2))
                           (if_then_else_M
                              (if_then_else_B (EQ_M (reveal (f mphi3)) (i 2))
                                 (if_then_else_B (EQ_M (to (f mphi2)) (i 1))
                                    (if_then_else_B
                                       (EQ_M (to (f mphi1)) (i 2))
                                       (if_then_else_B
                                          (EQ_M (act (f mphi2)) new) FAlse
                                          (if_then_else_B
                                             (EQ_M 
                                                (m (f mphi1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                             (EQ_M 
                                                (m (f mphi2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse)) FAlse)
                                    FAlse) FAlse)
                              (exp (pi1 (ggen (N 0))) (m (f mphi1)) (r (N 2)))
                              (if_then_else_M
                                 (if_then_else_B
                                    (EQ_M (reveal (f mphi3)) (i 1))
                                    (if_then_else_B
                                       (EQ_M (to (f mphi2)) (i 1))
                                       (if_then_else_B
                                          (EQ_M (to (f mphi1)) (i 2))
                                          (if_then_else_B
                                             (EQ_M (act (f mphi2)) new) FAlse
                                             (if_then_else_B
                                                (EQ_M 
                                                  (m (f mphi1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                                (EQ_M 
                                                  (m (f mphi2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse)) FAlse)
                                       FAlse) FAlse)
                                 (exp (pi1 (ggen (N 0))) 
                                    (m (f mphi2)) (r (N 1)))
                                 (if_then_else_M
                                    (EQ_M (reveal (f mphi3)) (i 2))
                                    (if_then_else_M
                                       (EQ_M (to (f mphi0)) (i 2))
                                       (exp (pi1 (ggen (N 0))) 
                                          (m (f mphi0)) 
                                          (r (N 1)))
                                       (if_then_else_M
                                          (EQ_M (to (f mphi2)) (i 2))
                                          (exp (pi1 (ggen (N 0)))
                                             (m (f mphi2)) 
                                             (r (N 3)))
                                          (if_then_else_M
                                             (EQ_M (to (f mphi1)) (i 1))
                                             (if_then_else_M
                                                (EQ_M (act (f mphi1)) new) O
                                                (if_then_else_M
                                                  (EQ_M 
                                                  (reveal (f mphi3)) 
                                                  (i 1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi1)) 
                                                  (r (N 1))) O)) O)))
                                    (if_then_else_M
                                       (EQ_M (to (f mphi1)) (i 1))
                                       (if_then_else_M
                                          (EQ_M (act (f mphi1)) new) O
                                          (if_then_else_M
                                             (EQ_M (reveal (f mphi3)) (i 1))
                                             (exp (pi1 (ggen (N 0)))
                                                (m (f mphi1)) 
                                                (r (N 1))) O)) O)))) O)); 
            apply Forall_ELM_EVAL_M with (n:=0) (x:=   (EQ_M (reveal (f mphi2)) (i 1))) in H;
simpl in H;  try rewrite IFFALSE_M in H; rewrite H; clear H.


pose proof(IFMORPH_M2 0     FAlse TRue
                        (if_then_else_M (EQ_M (reveal (f mphi3)) (i 2)) O
                           (if_then_else_M (EQ_M (to (f mphi3)) (i 2))
                              (exp (pi1 (ggen (N 0))) 
                                 (pi2 (ggen (N 0))) 
                                 (r (N 4))) O))    (if_then_else_M (EQ_M (to (f mphi2)) (i 2))
                           (if_then_else_M
                              (if_then_else_B (EQ_M (reveal (f mphi3)) (i 2))
                                 (if_then_else_B (EQ_M (to (f mphi2)) (i 1))
                                    (if_then_else_B
                                       (EQ_M (to (f mphi1)) (i 2))
                                       (if_then_else_B
                                          (EQ_M (act (f mphi2)) new) FAlse
                                          (if_then_else_B
                                             (EQ_M 
                                                (m (f mphi1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                             (EQ_M 
                                                (m (f mphi2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse)) FAlse)
                                    FAlse) FAlse)
                              (exp (pi1 (ggen (N 0))) (m (f mphi1)) (r (N 2)))
                              (if_then_else_M
                                 (if_then_else_B
                                    (EQ_M (reveal (f mphi3)) (i 1))
                                    (if_then_else_B
                                       (EQ_M (to (f mphi2)) (i 1))
                                       (if_then_else_B
                                          (EQ_M (to (f mphi1)) (i 2))
                                          (if_then_else_B
                                             (EQ_M (act (f mphi2)) new) FAlse
                                             (if_then_else_B
                                                (EQ_M 
                                                  (m (f mphi1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                                (EQ_M 
                                                  (m (f mphi2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse)) FAlse)
                                       FAlse) FAlse)
                                 (exp (pi1 (ggen (N 0))) 
                                    (m (f mphi2)) (r (N 1)))
                                 (if_then_else_M
                                    (EQ_M (reveal (f mphi3)) (i 2))
                                    (if_then_else_M
                                       (EQ_M (to (f mphi0)) (i 2))
                                       (exp (pi1 (ggen (N 0))) 
                                          (m (f mphi0)) 
                                          (r (N 1)))
                                       (if_then_else_M
                                          (EQ_M (to (f mphi2)) (i 2))
                                          (exp (pi1 (ggen (N 0)))
                                             (m (f mphi2)) 
                                             (r (N 3)))
                                          (if_then_else_M
                                             (EQ_M (to (f mphi1)) (i 1))
                                             (if_then_else_M
                                                (EQ_M (act (f mphi1)) new) O
                                                (if_then_else_M
                                                  (EQ_M 
                                                  (reveal (f mphi3)) 
                                                  (i 1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi1)) 
                                                  (r (N 1))) O)) O)))
                                    (if_then_else_M
                                       (EQ_M (to (f mphi1)) (i 1))
                                       (if_then_else_M
                                          (EQ_M (act (f mphi1)) new) O
                                          (if_then_else_M
                                             (EQ_M (reveal (f mphi3)) (i 1))
                                             (exp (pi1 (ggen (N 0)))
                                                (m (f mphi1)) 
                                                (r (N 1))) O)) O)))) O)); 
            apply Forall_ELM_EVAL_M with (n:=0) (x:=   (EQ_M (act (f mphi1)) new)) in H;
simpl in H;  try rewrite IFFALSE_M in H; rewrite H; clear H.

repeat (try rewrite IFTRUE_M ; try rewrite IFFALSE_M ; try rewrite IFSAME_M ;try rewrite IFTRUE_B ; try rewrite IFFALSE_B ; try rewrite IFSAME_B).
(***************************(EQ_M (to (f mphi1)) (i 1))***************)

pose proof(IFEVAL_M (if_then_else_M (EQ_M (reveal (f mphi2)) (i 1))
                         (if_then_else_M (EQ_M (act (f mphi1)) new)
                            (if_then_else_M (EQ_M (to (f mphi2)) (i 2))
                               (if_then_else_M
                                  (EQ_M (reveal (f mphi3)) (i 2))
                                  (if_then_else_M (EQ_M (to (f mphi0)) (i 2))
                                     (exp (pi1 (ggen (N 0))) 
                                        (m (f mphi0)) 
                                        (r (N 1)))
                                     (if_then_else_M
                                        (EQ_M (to (f mphi2)) (i 2))
                                        (exp (pi1 (ggen (N 0))) 
                                           (m (f mphi2)) 
                                           (r (N 3)))
                                        (if_then_else_M
                                           (Bvar 0)
                                           (if_then_else_M
                                              (EQ_M (act (f mphi1)) new) O
                                              (if_then_else_M
                                                 (EQ_M 
                                                  (reveal (f mphi3)) 
                                                  (i 1))
                                                 (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi1)) 
                                                  (r (N 1))) O)) O)))
                                  (if_then_else_M (Bvar 0)
                                     (if_then_else_M
                                        (EQ_M (act (f mphi1)) new) O
                                        (if_then_else_M
                                           (EQ_M (reveal (f mphi3)) (i 1))
                                           (exp (pi1 (ggen (N 0)))
                                              (m (f mphi1)) 
                                              (r (N 1))) O)) O)) O)
                            (if_then_else_M (EQ_M (reveal (f mphi3)) (i 2)) O
                               (if_then_else_M (EQ_M (to (f mphi3)) (i 2))
                                  (exp (pi1 (ggen (N 0))) 
                                     (pi2 (ggen (N 0))) 
                                     (r (N 4))) O)))
                         (if_then_else_M (EQ_M (to (f mphi2)) (i 2))
                            (if_then_else_M (EQ_M (reveal (f mphi3)) (i 2))
                               (if_then_else_M (EQ_M (to (f mphi0)) (i 2))
                                  (exp (pi1 (ggen (N 0))) 
                                     (m (f mphi0)) 
                                     (r (N 1)))
                                  (if_then_else_M (EQ_M (to (f mphi2)) (i 2))
                                     (exp (pi1 (ggen (N 0))) 
                                        (m (f mphi2)) 
                                        (r (N 3)))
                                     (if_then_else_M
                                        (Bvar 0)
                                        (if_then_else_M
                                           (EQ_M (act (f mphi1)) new) O
                                           (if_then_else_M
                                              (EQ_M (reveal (f mphi3)) (i 1))
                                              (exp 
                                                 (pi1 (ggen (N 0)))
                                                 (m (f mphi1)) 
                                                 (r (N 1))) O)) O)))
                               (if_then_else_M (Bvar 0)
                                  (if_then_else_M (EQ_M (act (f mphi1)) new)
                                     O
                                     (if_then_else_M
                                        (EQ_M (reveal (f mphi3)) (i 1))
                                        (exp (pi1 (ggen (N 0))) 
                                           (m (f mphi1)) 
                                           (r (N 1))) O)) O)) O)) (if_then_else_M (EQ_M (to (f mphi2)) (i 2))
                         (if_then_else_M (EQ_M (reveal (f mphi3)) (i 2))
                            (if_then_else_M (EQ_M (to (f mphi0)) (i 2))
                               (exp (pi1 (ggen (N 0))) 
                                  (m (f mphi0)) (r (N 1)))
                               (if_then_else_M (EQ_M (to (f mphi2)) (i 2))
                                  (exp (pi1 (ggen (N 0))) 
                                     (m (f mphi2)) 
                                     (r (N 3)))
                                  (if_then_else_M (Bvar 0)
                                     (if_then_else_M
                                        (EQ_M (act (f mphi1)) new) O
                                        (if_then_else_M
                                           (EQ_M (reveal (f mphi3)) (i 1))
                                           (exp (pi1 (ggen (N 0)))
                                              (m (f mphi1)) 
                                              (r (N 1))) O)) O)))
                            (if_then_else_M (Bvar 0)
                               (if_then_else_M (EQ_M (act (f mphi1)) new) O
                                  (if_then_else_M
                                     (EQ_M (reveal (f mphi3)) (i 1))
                                     (exp (pi1 (ggen (N 0))) 
                                        (m (f mphi1)) 
                                        (r (N 1))) O)) O)) O) 0);

simpl in H;

repeat (try rewrite IFTRUE_M in H; try rewrite IFFALSE_M in H; try rewrite IFSAME_M in H;try rewrite IFTRUE_B in H; try rewrite IFFALSE_B in H; try rewrite IFSAME_B in H);

apply Forall_ELM_EVAL_M with (n:=0) (x:= (EQ_M (to (f mphi1)) (i 1)) ) in H;
simpl in H; rewrite H; clear H.

(***********************RHS *(EQ_M (to (f mphi1)) (i 1)) ***************)

pose proof(IFEVAL_M (if_then_else_M (EQ_M (reveal (f mphi2)) (i 1))
                        (if_then_else_M (EQ_M (act (f mphi1)) new)
                           (if_then_else_M (EQ_M (to (f mphi2)) (i 2))
                              (if_then_else_M
                                 (if_then_else_B
                                    (EQ_M (reveal (f mphi3)) (i 2))
                                    (if_then_else_B
                                       (EQ_M (to (f mphi2)) (i 1))
                                       (if_then_else_B
                                          (EQ_M (to (f mphi1)) (i 2))
                                          (if_then_else_B
                                             (EQ_M (act (f mphi2)) new) FAlse
                                             (if_then_else_B
                                                (EQ_M 
                                                  (m (f mphi1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                                (EQ_M 
                                                  (m (f mphi2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse)) FAlse)
                                       FAlse) FAlse)
                                 (exp (pi1 (ggen (N 0))) 
                                    (m (f mphi1)) (r (N 2)))
                                 (if_then_else_M
                                    (if_then_else_B
                                       (EQ_M (reveal (f mphi3)) (i 1))
                                       (if_then_else_B
                                          (EQ_M (to (f mphi2)) (i 1))
                                          (if_then_else_B
                                             (EQ_M (to (f mphi1)) (i 2))
                                             (if_then_else_B
                                                (EQ_M (act (f mphi2)) new)
                                                FAlse
                                                (if_then_else_B
                                                  (EQ_M 
                                                  (m (f mphi1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                                  (EQ_M 
                                                  (m (f mphi2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse)) FAlse)
                                          FAlse) FAlse)
                                    (exp (pi1 (ggen (N 0))) 
                                       (m (f mphi2)) 
                                       (r (N 1)))
                                    (if_then_else_M
                                       (EQ_M (reveal (f mphi3)) (i 2))
                                       (if_then_else_M
                                          (EQ_M (to (f mphi0)) (i 2))
                                          (exp (pi1 (ggen (N 0)))
                                             (m (f mphi0)) 
                                             (r (N 1)))
                                          (if_then_else_M
                                             (EQ_M (to (f mphi2)) (i 2))
                                             (exp (pi1 (ggen (N 0)))
                                                (m (f mphi2)) 
                                                (r (N 3)))
                                             (if_then_else_M
                                                (Bvar 0)
                                                (if_then_else_M
                                                  (EQ_M (act (f mphi1)) new)
                                                  O
                                                  (if_then_else_M
                                                  (EQ_M 
                                                  (reveal (f mphi3)) 
                                                  (i 1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi1)) 
                                                  (r (N 1))) O)) O)))
                                       (if_then_else_M
                                          (Bvar 0)
                                          (if_then_else_M
                                             (EQ_M (act (f mphi1)) new) O
                                             (if_then_else_M
                                                (EQ_M 
                                                  (reveal (f mphi3)) 
                                                  (i 1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi1)) 
                                                  (r (N 1))) O)) O)))) O)
                           (if_then_else_M (EQ_M (reveal (f mphi3)) (i 2)) O
                              (if_then_else_M (EQ_M (to (f mphi3)) (i 2))
                                 (exp (pi1 (ggen (N 0))) 
                                    (pi2 (ggen (N 0))) 
                                    (r (N 4))) O)))
                        (if_then_else_M (EQ_M (to (f mphi2)) (i 2))
                           (if_then_else_M
                              (if_then_else_B (EQ_M (reveal (f mphi3)) (i 2))
                                 (if_then_else_B (EQ_M (to (f mphi2)) (i 1))
                                    (if_then_else_B
                                       (EQ_M (to (f mphi1)) (i 2))
                                       (if_then_else_B
                                          (EQ_M (act (f mphi2)) new) FAlse
                                          (if_then_else_B
                                             (EQ_M 
                                                (m (f mphi1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                             (EQ_M 
                                                (m (f mphi2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse)) FAlse)
                                    FAlse) FAlse)
                              (exp (pi1 (ggen (N 0))) (m (f mphi1)) (r (N 2)))
                              (if_then_else_M
                                 (if_then_else_B
                                    (EQ_M (reveal (f mphi3)) (i 1))
                                    (if_then_else_B
                                       (EQ_M (to (f mphi2)) (i 1))
                                       (if_then_else_B
                                          (EQ_M (to (f mphi1)) (i 2))
                                          (if_then_else_B
                                             (EQ_M (act (f mphi2)) new) FAlse
                                             (if_then_else_B
                                                (EQ_M 
                                                  (m (f mphi1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                                (EQ_M 
                                                  (m (f mphi2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse)) FAlse)
                                       FAlse) FAlse)
                                 (exp (pi1 (ggen (N 0))) 
                                    (m (f mphi2)) (r (N 1)))
                                 (if_then_else_M
                                    (EQ_M (reveal (f mphi3)) (i 2))
                                    (if_then_else_M
                                       (EQ_M (to (f mphi0)) (i 2))
                                       (exp (pi1 (ggen (N 0))) 
                                          (m (f mphi0)) 
                                          (r (N 1)))
                                       (if_then_else_M
                                          (EQ_M (to (f mphi2)) (i 2))
                                          (exp (pi1 (ggen (N 0)))
                                             (m (f mphi2)) 
                                             (r (N 3)))
                                          (if_then_else_M
                                             (Bvar 0)
                                             (if_then_else_M
                                                (EQ_M (act (f mphi1)) new) O
                                                (if_then_else_M
                                                  (EQ_M 
                                                  (reveal (f mphi3)) 
                                                  (i 1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi1)) 
                                                  (r (N 1))) O)) O)))
                                    (if_then_else_M
                                       (Bvar 0)
                                       (if_then_else_M
                                          (EQ_M (act (f mphi1)) new) O
                                          (if_then_else_M
                                             (EQ_M (reveal (f mphi3)) (i 1))
                                             (exp (pi1 (ggen (N 0)))
                                                (m (f mphi1)) 
                                                (r (N 1))) O)) O)))) O)) (if_then_else_M (EQ_M (to (f mphi2)) (i 2))
                        (if_then_else_M
                           (if_then_else_B (EQ_M (reveal (f mphi3)) (i 2))
                              (if_then_else_B (EQ_M (to (f mphi2)) (i 1))
                                 (if_then_else_B (EQ_M (to (f mphi1)) (i 2))
                                    (if_then_else_B
                                       (EQ_M (act (f mphi2)) new) FAlse
                                       (if_then_else_B
                                          (EQ_M (m (f mphi1))
                                             (exp (pi1 (ggen (N 0)))
                                                (pi2 (ggen (N 0))) 
                                                (r (N 1))))
                                          (EQ_M (m (f mphi2))
                                             (exp (pi1 (ggen (N 0)))
                                                (pi2 (ggen (N 0))) 
                                                (r (N 2)))) FAlse)) FAlse)
                                 FAlse) FAlse)
                           (exp (pi1 (ggen (N 0))) (m (f mphi1)) (r (N 2)))
                           (if_then_else_M
                              (if_then_else_B (EQ_M (reveal (f mphi3)) (i 1))
                                 (if_then_else_B (EQ_M (to (f mphi2)) (i 1))
                                    (if_then_else_B
                                       (EQ_M (to (f mphi1)) (i 2))
                                       (if_then_else_B
                                          (EQ_M (act (f mphi2)) new) FAlse
                                          (if_then_else_B
                                             (EQ_M 
                                                (m (f mphi1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                             (EQ_M 
                                                (m (f mphi2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse)) FAlse)
                                    FAlse) FAlse)
                              (exp (pi1 (ggen (N 0))) (m (f mphi2)) (r (N 1)))
                              (if_then_else_M (EQ_M (reveal (f mphi3)) (i 2))
                                 (if_then_else_M (EQ_M (to (f mphi0)) (i 2))
                                    (exp (pi1 (ggen (N 0))) 
                                       (m (f mphi0)) 
                                       (r (N 1)))
                                    (if_then_else_M
                                       (EQ_M (to (f mphi2)) (i 2))
                                       (exp (pi1 (ggen (N 0))) 
                                          (m (f mphi2)) 
                                          (r (N 3)))
                                       (if_then_else_M
                                          (Bvar 0)
                                          (if_then_else_M
                                             (EQ_M (act (f mphi1)) new) O
                                             (if_then_else_M
                                                (EQ_M 
                                                  (reveal (f mphi3)) 
                                                  (i 1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi1)) 
                                                  (r (N 1))) O)) O)))
                                 (if_then_else_M (Bvar 0)
                                    (if_then_else_M
                                       (EQ_M (act (f mphi1)) new) O
                                       (if_then_else_M
                                          (EQ_M (reveal (f mphi3)) (i 1))
                                          (exp (pi1 (ggen (N 0)))
                                             (m (f mphi1)) 
                                             (r (N 1))) O)) O)))) O) 0);

simpl in H;

repeat (try rewrite IFTRUE_M in H; try rewrite IFFALSE_M in H; try rewrite IFSAME_M in H;try rewrite IFTRUE_B in H; try rewrite IFFALSE_B in H; try rewrite IFSAME_B in H);

apply Forall_ELM_EVAL_M with (n:=0) (x:= (EQ_M (to (f mphi1)) (i 1)) ) in H;
simpl in H; rewrite H; clear H.




(**************************RHS**************************)



pose proof(IFEVAL_M (if_then_else_M (EQ_M (reveal (f mphi2)) (i 2)) O
                  (if_then_else_M (Bvar 0)
                     (if_then_else_M (EQ_M (reveal (f mphi2)) (i 1))
                        (if_then_else_M (EQ_M (act (f mphi1)) new)
                           (if_then_else_M (EQ_M (to (f mphi2)) (i 2))
                              (if_then_else_M
                                 (if_then_else_B
                                    (EQ_M (reveal (f mphi3)) (i 2))
                                    (if_then_else_B
                                       (EQ_M (to (f mphi2)) (i 1))
                                       (if_then_else_B
                                          (EQ_M (to (f mphi1)) (i 2))
                                          (if_then_else_B
                                             (EQ_M (act (f mphi2)) new) FAlse
                                             (if_then_else_B
                                                (EQ_M 
                                                  (m (f mphi1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                                (EQ_M 
                                                  (m (f mphi2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse)) FAlse)
                                       FAlse) FAlse)
                                 (exp (pi1 (ggen (N 0))) 
                                    (m (f mphi1)) (r (N 2)))
                                 (if_then_else_M
                                    (if_then_else_B
                                       (EQ_M (reveal (f mphi3)) (i 1))
                                       (if_then_else_B
                                          (EQ_M (to (f mphi2)) (i 1))
                                          (if_then_else_B
                                             (EQ_M (to (f mphi1)) (i 2))
                                             (if_then_else_B
                                                (EQ_M (act (f mphi2)) new)
                                                FAlse
                                                (if_then_else_B
                                                  (EQ_M 
                                                  (m (f mphi1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                                  (EQ_M 
                                                  (m (f mphi2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse)) FAlse)
                                          FAlse) FAlse)
                                    (exp (pi1 (ggen (N 0))) 
                                       (m (f mphi2)) 
                                       (r (N 1)))
                                    (if_then_else_M
                                       (EQ_M (reveal (f mphi3)) (i 2))
                                       (if_then_else_M
                                          (EQ_M (to (f mphi0)) (i 2))
                                          (exp (pi1 (ggen (N 0)))
                                             (m (f mphi0)) 
                                             (r (N 1)))
                                          (if_then_else_M
                                             (EQ_M (to (f mphi2)) (i 2))
                                             (exp (pi1 (ggen (N 0)))
                                                (m (f mphi2)) 
                                                (r (N 3)))
                                             (if_then_else_M
                                                (EQ_M (act (f mphi1)) new) O
                                                (if_then_else_M
                                                  (EQ_M 
                                                  (reveal (f mphi3)) 
                                                  (i 1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi1)) 
                                                  (r (N 1))) O))))
                                       (if_then_else_M
                                          (EQ_M (act (f mphi1)) new) O
                                          (if_then_else_M
                                             (EQ_M (reveal (f mphi3)) (i 1))
                                             (exp (pi1 (ggen (N 0)))
                                                (m (f mphi1)) 
                                                (r (N 1))) O))))) O)
                           (if_then_else_M (EQ_M (reveal (f mphi3)) (i 2)) O
                              (if_then_else_M (EQ_M (to (f mphi3)) (i 2))
                                 (exp (pi1 (ggen (N 0))) 
                                    (pi2 (ggen (N 0))) 
                                    (r (N 4))) O)))
                        (if_then_else_M (EQ_M (to (f mphi2)) (i 2))
                           (if_then_else_M
                              (if_then_else_B (EQ_M (reveal (f mphi3)) (i 2))
                                 (if_then_else_B (EQ_M (to (f mphi2)) (i 1))
                                    (if_then_else_B
                                       (EQ_M (to (f mphi1)) (i 2))
                                       (if_then_else_B
                                          (EQ_M (act (f mphi2)) new) FAlse
                                          (if_then_else_B
                                             (EQ_M 
                                                (m (f mphi1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                             (EQ_M 
                                                (m (f mphi2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse)) FAlse)
                                    FAlse) FAlse)
                              (exp (pi1 (ggen (N 0))) (m (f mphi1)) (r (N 2)))
                              (if_then_else_M
                                 (if_then_else_B
                                    (EQ_M (reveal (f mphi3)) (i 1))
                                    (if_then_else_B
                                       (EQ_M (to (f mphi2)) (i 1))
                                       (if_then_else_B
                                          (EQ_M (to (f mphi1)) (i 2))
                                          (if_then_else_B
                                             (EQ_M (act (f mphi2)) new) FAlse
                                             (if_then_else_B
                                                (EQ_M 
                                                  (m (f mphi1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                                (EQ_M 
                                                  (m (f mphi2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse)) FAlse)
                                       FAlse) FAlse)
                                 (exp (pi1 (ggen (N 0))) 
                                    (m (f mphi2)) (r (N 1)))
                                 (if_then_else_M
                                    (EQ_M (reveal (f mphi3)) (i 2))
                                    (if_then_else_M
                                       (EQ_M (to (f mphi0)) (i 2))
                                       (exp (pi1 (ggen (N 0))) 
                                          (m (f mphi0)) 
                                          (r (N 1)))
                                       (if_then_else_M
                                          (EQ_M (to (f mphi2)) (i 2))
                                          (exp (pi1 (ggen (N 0)))
                                             (m (f mphi2)) 
                                             (r (N 3)))
                                          (if_then_else_M
                                             (EQ_M (act (f mphi1)) new) O
                                             (if_then_else_M
                                                (EQ_M 
                                                  (reveal (f mphi3)) 
                                                  (i 1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi1)) 
                                                  (r (N 1))) O))))
                                    (if_then_else_M
                                       (EQ_M (act (f mphi1)) new) O
                                       (if_then_else_M
                                          (EQ_M (reveal (f mphi3)) (i 1))
                                          (exp (pi1 (ggen (N 0)))
                                             (m (f mphi1)) 
                                             (r (N 1))) O))))) O))
                     (if_then_else_M (EQ_M (to (f mphi2)) (i 2))
                        (if_then_else_M
                           (if_then_else_B (EQ_M (reveal (f mphi3)) (i 2))
                              (if_then_else_B (EQ_M (to (f mphi2)) (i 1))
                                 (if_then_else_B (EQ_M (to (f mphi1)) (i 2))
                                    (if_then_else_B
                                       (EQ_M (act (f mphi2)) new) FAlse
                                       (if_then_else_B
                                          (EQ_M (m (f mphi1))
                                             (exp (pi1 (ggen (N 0)))
                                                (pi2 (ggen (N 0))) 
                                                (r (N 1))))
                                          (EQ_M (m (f mphi2))
                                             (exp (pi1 (ggen (N 0)))
                                                (pi2 (ggen (N 0))) 
                                                (r (N 2)))) FAlse)) FAlse)
                                 FAlse) FAlse)
                           (exp (pi1 (ggen (N 0))) (m (f mphi1)) (r (N 2)))
                           (if_then_else_M
                              (if_then_else_B (EQ_M (reveal (f mphi3)) (i 1))
                                 (if_then_else_B (EQ_M (to (f mphi2)) (i 1))
                                    (if_then_else_B
                                       (EQ_M (to (f mphi1)) (i 2))
                                       (if_then_else_B
                                          (EQ_M (act (f mphi2)) new) FAlse
                                          (if_then_else_B
                                             (EQ_M 
                                                (m (f mphi1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                             (EQ_M 
                                                (m (f mphi2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse)) FAlse)
                                    FAlse) FAlse)
                              (exp (pi1 (ggen (N 0))) (m (f mphi2)) (r (N 1)))
                              (if_then_else_M (EQ_M (reveal (f mphi3)) (i 2))
                                 (if_then_else_M (EQ_M (to (f mphi0)) (i 2))
                                    (exp (pi1 (ggen (N 0))) 
                                       (m (f mphi0)) 
                                       (r (N 1)))
                                    (if_then_else_M
                                       (EQ_M (to (f mphi2)) (i 2))
                                       (exp (pi1 (ggen (N 0))) 
                                          (m (f mphi2)) 
                                          (r (N 3))) O)) O))) O)))
               (if_then_else_M (EQ_M (to (f mphi1)) (i 2))
                  (if_then_else_M (EQ_M (reveal (f mphi2)) (i 1)) O
                     (if_then_else_M
                        (if_then_else_B (EQ_M (reveal (f mphi2)) (i 2))
                           (EQ_M (to (f mphi0)) (i 2)) FAlse)
                        (if_then_else_M (EQ_M (reveal (f mphi3)) (i 1)) O
                           (if_then_else_M (EQ_M (to (f mphi3)) (i 1)) acc O))
                        (if_then_else_M (EQ_M (to (f mphi2)) (i 1))
                           (if_then_else_M
                              (if_then_else_B (EQ_M (reveal (f mphi3)) (i 2))
                                 (if_then_else_B (EQ_M (to (f mphi2)) (i 1))
                                    (if_then_else_B
                                       (EQ_M (to (f mphi1)) (i 2))
                                       (if_then_else_B
                                          (EQ_M (act (f mphi2)) new) FAlse
                                          (if_then_else_B
                                             (EQ_M 
                                                (m (f mphi1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                             (EQ_M 
                                                (m (f mphi2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse)) FAlse)
                                    FAlse) FAlse)
                              (exp (pi1 (ggen (N 0))) (m (f mphi1)) (r (N 2)))
                              (if_then_else_M
                                 (if_then_else_B
                                    (EQ_M (reveal (f mphi3)) (i 1))
                                    (if_then_else_B
                                       (EQ_M (to (f mphi2)) (i 1))
                                       (if_then_else_B
                                          (EQ_M (to (f mphi1)) (i 2))
                                          (if_then_else_B
                                             (EQ_M (act (f mphi2)) new) FAlse
                                             (if_then_else_B
                                                (EQ_M 
                                                  (m (f mphi1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                                (EQ_M 
                                                  (m (f mphi2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse)) FAlse)
                                       FAlse) FAlse)
                                 (exp (pi1 (ggen (N 0))) 
                                    (m (f mphi2)) (r (N 1)))
                                 (if_then_else_M
                                    (EQ_M (reveal (f mphi3)) (i 2))
                                    (if_then_else_M
                                       (EQ_M (to (f mphi0)) (i 2))
                                       (exp (pi1 (ggen (N 0))) 
                                          (m (f mphi0)) 
                                          (r (N 1)))
                                       (if_then_else_M
                                          (EQ_M (to (f mphi2)) (i 2))
                                          (exp (pi1 (ggen (N 0)))
                                             (m (f mphi2)) 
                                             (r (N 3)))
                                          (if_then_else_M
                                             (Bvar 0)
                                             (if_then_else_M
                                                (EQ_M (act (f mphi1)) new) O
                                                (if_then_else_M
                                                  (EQ_M 
                                                  (reveal (f mphi3)) 
                                                  (i 1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi1)) 
                                                  (r (N 1))) O)) O)))
                                    (if_then_else_M
                                       (Bvar 0)
                                       (if_then_else_M
                                          (EQ_M (act (f mphi1)) new) O
                                          (if_then_else_M
                                             (EQ_M (reveal (f mphi3)) (i 1))
                                             (exp (pi1 (ggen (N 0)))
                                                (m (f mphi1)) 
                                                (r (N 1))) O)) O)))) O))) O) 0 );


simpl in H;

repeat (try rewrite IFTRUE_M in H; try rewrite IFFALSE_M in H; try rewrite IFSAME_M in H;try rewrite IFTRUE_B in H; try rewrite IFFALSE_B in H; try rewrite IFSAME_B in H);

apply Forall_ELM_EVAL_M with (n:=0) (x:= (EQ_M (to (f mphi1)) (i 1)) ) in H;
simpl in H; rewrite H; clear H.

(************RHS:*(EQ_M (act (f mphi1)) new)****************)



pose proof(IFEVAL_M  (if_then_else_M (EQ_M (to (f mphi2)) (i 2))
                           (if_then_else_M
                              (if_then_else_B (EQ_M (reveal (f mphi3)) (i 2))
                                 (if_then_else_B (EQ_M (to (f mphi2)) (i 1))
                                    (if_then_else_B
                                       (EQ_M (to (f mphi1)) (i 2))
                                       (if_then_else_B
                                          (EQ_M (act (f mphi2)) new) FAlse
                                          (if_then_else_B
                                             (EQ_M 
                                                (m (f mphi1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                             (EQ_M 
                                                (m (f mphi2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse)) FAlse)
                                    FAlse) FAlse)
                              (exp (pi1 (ggen (N 0))) (m (f mphi1)) (r (N 2)))
                              (if_then_else_M
                                 (if_then_else_B
                                    (EQ_M (reveal (f mphi3)) (i 1))
                                    (if_then_else_B
                                       (EQ_M (to (f mphi2)) (i 1))
                                       (if_then_else_B
                                          (EQ_M (to (f mphi1)) (i 2))
                                          (if_then_else_B
                                             (EQ_M (act (f mphi2)) new) FAlse
                                             (if_then_else_B
                                                (EQ_M 
                                                  (m (f mphi1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                                (EQ_M 
                                                  (m (f mphi2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse)) FAlse)
                                       FAlse) FAlse)
                                 (exp (pi1 (ggen (N 0))) 
                                    (m (f mphi2)) (r (N 1)))
                                 (if_then_else_M
                                    (EQ_M (reveal (f mphi3)) (i 2))
                                    (if_then_else_M
                                       (EQ_M (to (f mphi0)) (i 2))
                                       (exp (pi1 (ggen (N 0))) 
                                          (m (f mphi0)) 
                                          (r (N 1)))
                                       (if_then_else_M
                                          (EQ_M (to (f mphi2)) (i 2))
                                          (exp (pi1 (ggen (N 0)))
                                             (m (f mphi2)) 
                                             (r (N 3)))
                                          (if_then_else_M
                                             (Bvar 0) O
                                             (if_then_else_M
                                                (EQ_M 
                                                  (reveal (f mphi3)) 
                                                  (i 1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi1)) 
                                                  (r (N 1))) O))))
                                    (if_then_else_M
                                       (Bvar 0) O
                                       (if_then_else_M
                                          (EQ_M (reveal (f mphi3)) (i 1))
                                          (exp (pi1 (ggen (N 0)))
                                             (m (f mphi1)) 
                                             (r (N 1))) O))))) O) (if_then_else_M (EQ_M (reveal (f mphi3)) (i 2)) O
                           (if_then_else_M (EQ_M (to (f mphi3)) (i 2))
                              (exp (pi1 (ggen (N 0))) 
                                 (pi2 (ggen (N 0))) 
                                 (r (N 4))) O)) 0).

simpl in H;

repeat (try rewrite IFTRUE_M in H; try rewrite IFFALSE_M in H; try rewrite IFSAME_M in H;try rewrite IFTRUE_B in H; try rewrite IFFALSE_B in H; try rewrite IFSAME_B in H);

apply Forall_ELM_EVAL_M with (n:=0) (x:=(EQ_M (act (f mphi1)) new) ) in H;
simpl in H; rewrite H; clear H.

(***************(EQ_M (to (f mphi2)) (i 2))*********)


pose proof(IFEVAL_M (if_then_else_M
                              (if_then_else_B (EQ_M (reveal (f mphi3)) (i 2))
                                 (if_then_else_B (EQ_M (to (f mphi2)) (i 1))
                                    (if_then_else_B
                                       (EQ_M (to (f mphi1)) (i 2))
                                       (if_then_else_B
                                          (EQ_M (act (f mphi2)) new) FAlse
                                          (if_then_else_B
                                             (EQ_M 
                                                (m (f mphi1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                             (EQ_M 
                                                (m (f mphi2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse)) FAlse)
                                    FAlse) FAlse)
                              (exp (pi1 (ggen (N 0))) (m (f mphi1)) (r (N 2)))
                              (if_then_else_M
                                 (if_then_else_B
                                    (EQ_M (reveal (f mphi3)) (i 1))
                                    (if_then_else_B
                                       (EQ_M (to (f mphi2)) (i 1))
                                       (if_then_else_B
                                          (EQ_M (to (f mphi1)) (i 2))
                                          (if_then_else_B
                                             (EQ_M (act (f mphi2)) new) FAlse
                                             (if_then_else_B
                                                (EQ_M 
                                                  (m (f mphi1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                                (EQ_M 
                                                  (m (f mphi2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse)) FAlse)
                                       FAlse) FAlse)
                                 (exp (pi1 (ggen (N 0))) 
                                    (m (f mphi2)) (r (N 1)))
                                 (if_then_else_M
                                    (EQ_M (reveal (f mphi3)) (i 2))
                                    (if_then_else_M
                                       (EQ_M (to (f mphi0)) (i 2))
                                       (exp (pi1 (ggen (N 0))) 
                                          (m (f mphi0)) 
                                          (r (N 1)))
                                       (if_then_else_M
                                          (Bvar 0)
                                          (exp (pi1 (ggen (N 0)))
                                             (m (f mphi2)) 
                                             (r (N 3))) O)) O))) O 0);


simpl in H;

repeat (try rewrite IFTRUE_M in H; try rewrite IFFALSE_M in H; try rewrite IFSAME_M in H;try rewrite IFTRUE_B in H; try rewrite IFFALSE_B in H; try rewrite IFSAME_B in H);

apply Forall_ELM_EVAL_M with (n:=0) (x:=(EQ_M (to (f mphi2)) (i 2)) ) in H;
simpl in H; rewrite H; clear H.


(*************LHS: (EQ_M (act (f mphi1)) new)*********)


 pose proof (IFEVAL_M (if_then_else_M (EQ_M (to (f mphi2)) (i 2))
                               (if_then_else_M
                                  (EQ_M (reveal (f mphi3)) (i 2))
                                  (if_then_else_M (EQ_M (to (f mphi0)) (i 2))
                                     (exp (pi1 (ggen (N 0))) 
                                        (m (f mphi0)) 
                                        (r (N 1)))
                                     (if_then_else_M
                                        (EQ_M (to (f mphi2)) (i 2))
                                        (exp (pi1 (ggen (N 0))) 
                                           (m (f mphi2)) 
                                           (r (N 3)))
                                        (if_then_else_M
                                          (Bvar 0) O
                                           (if_then_else_M
                                              (EQ_M (reveal (f mphi3)) (i 1))
                                              (exp 
                                                 (pi1 (ggen (N 0)))
                                                 (m (f mphi1)) 
                                                 (r (N 1))) O))))
                                  (if_then_else_M(Bvar 0)
                                     O
                                     (if_then_else_M
                                        (EQ_M (reveal (f mphi3)) (i 1))
                                        (exp (pi1 (ggen (N 0))) 
                                           (m (f mphi1)) 
                                           (r (N 1))) O))) O)
                            (if_then_else_M (EQ_M (reveal (f mphi3)) (i 2)) O
                               (if_then_else_M (EQ_M (to (f mphi3)) (i 2))
                                  (exp (pi1 (ggen (N 0))) 
                                     (pi2 (ggen (N 0))) 
                                     (r (N 4))) O)) 0);




simpl in H;

repeat (try rewrite IFTRUE_M in H; try rewrite IFFALSE_M in H; try rewrite IFSAME_M in H;try rewrite IFTRUE_B in H; try rewrite IFFALSE_B in H; try rewrite IFSAME_B in H);

apply Forall_ELM_EVAL_M with (n:=0) (x:= (EQ_M (act (f mphi1)) new)) in H;
simpl in H; rewrite H; clear H.


(***********************************(EQ_M (to (f mphi2)) (i 2))***********)

 pose proof (IFEVAL_M (if_then_else_M
                                  (EQ_M (reveal (f mphi3)) (i 2))
                                  (if_then_else_M (EQ_M (to (f mphi0)) (i 2))
                                     (exp (pi1 (ggen (N 0))) 
                                        (m (f mphi0)) 
                                        (r (N 1)))
                                     (if_then_else_M
                                        (Bvar 0)
                                        (exp (pi1 (ggen (N 0))) 
                                           (m (f mphi2)) 
                                           (r (N 3))) O)) O) O 0);

simpl in H;

repeat (try rewrite IFTRUE_M in H; try rewrite IFFALSE_M in H; try rewrite IFSAME_M in H;try rewrite IFTRUE_B in H; try rewrite IFFALSE_B in H; try rewrite IFSAME_B in H);

apply Forall_ELM_EVAL_M with (n:=0) (x:=(EQ_M (to (f mphi2)) (i 2))) in H;
simpl in H; rewrite H; clear H.


 pose proof (IFEVAL_M  (if_then_else_M (EQ_M (reveal (f mphi3)) (i 2))
                               (if_then_else_M (EQ_M (to (f mphi0)) (i 2))
                                  (exp (pi1 (ggen (N 0))) 
                                     (m (f mphi0)) 
                                     (r (N 1)))
                                  (if_then_else_M (Bvar 0)
                                     (exp (pi1 (ggen (N 0))) 
                                        (m (f mphi2)) 
                                        (r (N 3)))
                                     (if_then_else_M
                                        (EQ_M (act (f mphi1)) new) O
                                        (if_then_else_M
                                           (EQ_M (reveal (f mphi3)) (i 1))
                                           (exp (pi1 (ggen (N 0)))
                                              (m (f mphi1)) 
                                              (r (N 1))) O))))
                               (if_then_else_M (EQ_M (act (f mphi1)) new) O
                                  (if_then_else_M
                                     (EQ_M (reveal (f mphi3)) (i 1))
                                     (exp (pi1 (ggen (N 0))) 
                                        (m (f mphi1)) 
                                        (r (N 1))) O))) O 0);

simpl in H;

repeat (try rewrite IFTRUE_M in H; try rewrite IFFALSE_M in H; try rewrite IFSAME_M in H;try rewrite IFTRUE_B in H; try rewrite IFFALSE_B in H; try rewrite IFSAME_B in H);

apply Forall_ELM_EVAL_M with (n:=0) (x:=(EQ_M (to (f mphi2)) (i 2))) in H;
simpl in H; rewrite H; clear H.


(***********************(EQ_M (reveal (f mphi2)) (i 2))
                            (EQ_M (to (f mphi0)) (i 2))******)


pose proof (mor_eval_andB 1 (if_then_else_M (EQ_M (reveal (f mphi3)) (i 1)) O
                            (if_then_else_M (EQ_M (to (f mphi3)) (i 1)) acc O)) (if_then_else_M (EQ_M (to (f mphi2)) (i 1))
                            (if_then_else_M (EQ_M (reveal (f mphi3)) (i 2))
                               (if_then_else_M(Bvar 2)
                                  (exp (pi1 (ggen (N 0))) 
                                     (m (f mphi0)) 
                                     (r (N 1)))
                                  (if_then_else_M (EQ_M (to (f mphi2)) (i 2))
                                     (exp (pi1 (ggen (N 0))) 
                                        (m (f mphi2)) 
                                        (r (N 3)))
                                     (if_then_else_M
                                        (EQ_M (to (f mphi1)) (i 1))
                                        (if_then_else_M
                                           (EQ_M (act (f mphi1)) new) O
                                           (if_then_else_M
                                              (EQ_M (reveal (f mphi3)) (i 1))
                                              (exp 
                                                 (pi1 (ggen (N 0)))
                                                 (m (f mphi1)) 
                                                 (r (N 1))) O)) O)))
                               (if_then_else_M (EQ_M (to (f mphi1)) (i 1))
                                  (if_then_else_M (EQ_M (act (f mphi1)) new)
                                     O
                                     (if_then_else_M
                                        (EQ_M (reveal (f mphi3)) (i 1))
                                        (exp (pi1 (ggen (N 0))) 
                                           (m (f mphi1)) 
                                           (r (N 1))) O)) O)) O));

simpl in H;

repeat (try rewrite IFTRUE_M in H; try rewrite IFFALSE_M in H; try rewrite IFSAME_M in H;try rewrite IFTRUE_B in H; try rewrite IFFALSE_B in H; try rewrite IFSAME_B in H);

apply Forall_ELM_EVAL_M with (n:=1) (x:=  (EQ_M (reveal (f mphi2)) (i 2))  ) in H;

apply Forall_ELM_EVAL_M with (n:=2) (x:=  (EQ_M (to (f mphi0)) (i 2))) in H;
simpl in H;
rewrite H;
clear H.


(****************(EQ_M (reveal (f mphi3)) (i 2))
                                 (if_then_else_B (EQ_M (to (f mphi2)) (i 1))
                                    (if_then_else_B
                                       (EQ_M (to (f mphi1)) (i 2))
                                       (if_then_else_B
                                          (EQ_M (act (f mphi2)) new) FAlse
                                          (if_then_else_B
                                             (EQ_M 
                                                (m (f mphi1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                             (EQ_M 
                                                (m (f mphi2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse)) FAlse)
                                    FAlse) ***************)







 pose proof (mor_eval_andB 1 (exp (pi1 (ggen (N 0))) (m (f mphi1)) (r (N 2)))
                              (if_then_else_M
                                 (if_then_else_B
                                    (EQ_M (reveal (f mphi3)) (i 1))
                                    (if_then_else_B
                                       (EQ_M (to (f mphi2)) (i 1))
                                       (if_then_else_B
                                          (EQ_M (to (f mphi1)) (i 2))
                                          (if_then_else_B
                                             (EQ_M (act (f mphi2)) new) FAlse
                                             (if_then_else_B
                                                (EQ_M 
                                                  (m (f mphi1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                                (EQ_M 
                                                  (m (f mphi2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse)) FAlse)
                                       FAlse) FAlse)
                                 (exp (pi1 (ggen (N 0))) 
                                    (m (f mphi2)) (r (N 1)))
                                 (if_then_else_M
                                    (Bvar 1)
                                    (if_then_else_M
                                       (EQ_M (to (f mphi0)) (i 2))
                                       (exp (pi1 (ggen (N 0))) 
                                          (m (f mphi0)) 
                                          (r (N 1)))
                                       (exp (pi1 (ggen (N 0))) 
                                          (m (f mphi2)) 
                                          (r (N 3)))) O)));


simpl in H;

repeat (try rewrite IFTRUE_M in H; try rewrite IFFALSE_M in H; try rewrite IFSAME_M in H;try rewrite IFTRUE_B in H; try rewrite IFFALSE_B in H; try rewrite IFSAME_B in H);

apply Forall_ELM_EVAL_M with (n:=1) (x:=  (EQ_M (reveal (f mphi3)) (i 2))  ) in H;

apply Forall_ELM_EVAL_M with (n:=2) (x:=  (if_then_else_B (EQ_M (to (f mphi2)) (i 1))
                                    (if_then_else_B
                                       (EQ_M (to (f mphi1)) (i 2))
                                       (if_then_else_B
                                          (EQ_M (act (f mphi2)) new) FAlse
                                          (if_then_else_B
                                             (EQ_M 
                                                (m (f mphi1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                             (EQ_M 
                                                (m (f mphi2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse)) FAlse)
                                    FAlse)) in H;
simpl in H;
rewrite H;
clear H.


pose proof (mor_eval_andB 1 (exp (pi1 (ggen (N 0))) 
                                    (m (f mphi1)) (r (N 2)))
                                 (if_then_else_M
                                    (if_then_else_B
                                       (EQ_M (reveal (f mphi3)) (i 1))
                                       (if_then_else_B
                                          (Bvar 1)
                                          (if_then_else_B
                                             (EQ_M (to (f mphi1)) (i 2))
                                             (if_then_else_B
                                                (EQ_M (act (f mphi2)) new)
                                                FAlse
                                                (if_then_else_B
                                                  (EQ_M 
                                                  (m (f mphi1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                                  (EQ_M 
                                                  (m (f mphi2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse)) FAlse)
                                          FAlse) FAlse)
                                    (exp (pi1 (ggen (N 0))) 
                                       (m (f mphi2)) 
                                       (r (N 1)))
                                    (if_then_else_M
                                       (EQ_M (to (f mphi0)) (i 2))
                                       (exp (pi1 (ggen (N 0))) 
                                          (m (f mphi0)) 
                                          (r (N 1)))
                                       (exp (pi1 (ggen (N 0))) 
                                          (m (f mphi2)) 
                                          (r (N 3))))));


simpl in H;

repeat (try rewrite IFTRUE_M in H; try rewrite IFFALSE_M in H; try rewrite IFSAME_M in H;try rewrite IFTRUE_B in H; try rewrite IFFALSE_B in H; try rewrite IFSAME_B in H);

apply Forall_ELM_EVAL_M with (n:=1) (x:=  (EQ_M (to (f mphi2)) (i 1)) ) in H;

apply Forall_ELM_EVAL_M with (n:=2) (x:= (if_then_else_B
                                       (EQ_M (to (f mphi1)) (i 2))
                                       (if_then_else_B
                                          (EQ_M (act (f mphi2)) new) FAlse
                                          (if_then_else_B
                                             (EQ_M 
                                                (m (f mphi1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                             (EQ_M 
                                                (m (f mphi2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse)) FAlse)) in H;
simpl in H;
rewrite H;
clear H.


pose proof(IFMORPH_B1   FAlse
                                          (if_then_else_B
                                             (EQ_M 
                                                (m (f mphi1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                             (EQ_M 
                                                (m (f mphi2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse) FAlse  0 1 );
rewrite IFSAME_B in H;

apply Forall_ELM_EVAL_B with (n:=1) (b:= (EQ_M (to (f mphi1)) (i 2))  ) in H;
simpl in H;

apply Forall_ELM_EVAL_B with (n:=0) (b:=  (EQ_M (act (f mphi2)) new)) in H;
simpl in H;
rewrite H;
clear H. 







pose proof(IFMORPH_B4 0   FAlse  (if_then_else_B
                                             (EQ_M 
                                                (m (f mphi1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                             (EQ_M 
                                                (m (f mphi2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse) FAlse );
apply Forall_ELM_EVAL_B with (n:=0) (b:= (EQ_M (act (f mphi2)) new) ) in H;
simpl in H;

apply Forall_ELM_EVAL_B with (n:=1) (b:= (EQ_M (to (f mphi1)) (i 2))) in H;
simpl in H; try rewrite IFSAME_B in H;
rewrite H;
clear H.


pose proof(IFMORPH_B4 0   FAlse  (EQ_M 
                                                (m (f mphi2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse  );
apply Forall_ELM_EVAL_B with (n:=0) (b:=(EQ_M (act (f mphi2)) new)) in H;
simpl in H;

apply Forall_ELM_EVAL_B with (n:=1) (b:= (EQ_M 
                                                (m (f mphi1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))) in H;
simpl in H; try rewrite IFSAME_B in H;
rewrite H;
clear H.


pose proof(IFMORPH_B1    (if_then_else_B
                                             (EQ_M (act (f mphi2)) new) FAlse
                                             (EQ_M 
                                                (m (f mphi2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2))))) FAlse FAlse  0 1 );
rewrite IFSAME_B in H;

apply Forall_ELM_EVAL_B with (n:=1) (b:= (EQ_M (to (f mphi1)) (i 2))  ) in H;
simpl in H;

apply Forall_ELM_EVAL_B with (n:=0) (b:= (EQ_M (m (f mphi1))
                                             (exp (pi1 (ggen (N 0)))
                                                (pi2 (ggen (N 0))) 
                                                (r (N 1))))) in H;
simpl in H;
rewrite H;
clear H. 


pose proof(IFMORPH_B1    FAlse
                                             (EQ_M 
                                                (m (f mphi2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse  0 1 );
rewrite IFSAME_B in H;

apply Forall_ELM_EVAL_B with (n:=1) (b:= (EQ_M (to (f mphi1)) (i 2)) ) in H;
simpl in H;

apply Forall_ELM_EVAL_B with (n:=0) (b:= (EQ_M (act (f mphi2)) new)) in H;
simpl in H;
rewrite H;
clear H. 




pose proof(IFMORPH_B4 0   FAlse  (EQ_M 
                                                (m (f mphi2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse );
apply Forall_ELM_EVAL_B with (n:=0) (b:=(EQ_M (act (f mphi2)) new)) in H;
simpl in H;

apply Forall_ELM_EVAL_B with (n:=1) (b:= (EQ_M (to (f mphi1)) (i 2))) in H;
simpl in H; try rewrite IFSAME_B in H;
rewrite H;
clear H.

pose proof(IFMORPH_B1   FAlse
                                             (EQ_M 
                                                (m (f mphi2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse  0 1 );
rewrite IFSAME_B in H;

apply Forall_ELM_EVAL_B with (n:=1) (b:=  (EQ_M (to (f mphi1)) (i 2)) ) in H;
simpl in H;

apply Forall_ELM_EVAL_B with (n:=0) (b:= (EQ_M (act (f mphi2)) new)) in H;
simpl in H;
rewrite H;
clear H. 

pose proof(IFMORPH_B1   FAlse
                                             (if_then_else_B
                                             (EQ_M (to (f mphi1)) (i 2))
                                             (EQ_M 
                                                (m (f mphi2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse) FAlse  0 1 );
rewrite IFSAME_B in H;

apply Forall_ELM_EVAL_B with (n:=1) (b:=  (EQ_M (m (f mphi1))
                                          (exp (pi1 (ggen (N 0)))
                                             (pi2 (ggen (N 0))) 
                                             (r (N 1))))) in H;
simpl in H;

apply Forall_ELM_EVAL_B with (n:=0) (b:=  (EQ_M (act (f mphi2)) new)) in H;
simpl in H;
rewrite H;
clear H. 

pose proof(IFMORPH_B4 0   FAlse   
                                             (if_then_else_B
                                             (EQ_M (to (f mphi1)) (i 2))
                                             (EQ_M 
                                                (m (f mphi2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse) FAlse);
apply Forall_ELM_EVAL_B with (n:=0) (b:=(EQ_M (act (f mphi2)) new)) in H;
simpl in H;

apply Forall_ELM_EVAL_B with (n:=1) (b:=   (EQ_M (m (f mphi1))
                                             (exp (pi1 (ggen (N 0)))
                                                (pi2 (ggen (N 0))) 
                                                (r (N 1))))) in H;
simpl in H; try rewrite IFSAME_B in H;
rewrite H;
clear H.
pose proof(IFMORPH_B4 0   FAlse   
                                             (EQ_M 
                                                (m (f mphi2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse);
apply Forall_ELM_EVAL_B with (n:=0) (b:=(EQ_M (act (f mphi2)) new)) in H;
simpl in H;

apply Forall_ELM_EVAL_B with (n:=1) (b:=   (EQ_M (to (f mphi1)) (i 2))) in H;
simpl in H; try rewrite IFSAME_B in H;
rewrite H;
clear H.
pose proof(IFMORPH_B1  
                                             (if_then_else_B
                                             (EQ_M (act (f mphi2)) new) FAlse
                                             (EQ_M 
                                                (m (f mphi2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2))))) FAlse FAlse  0 1 );
rewrite IFSAME_B in H;

apply Forall_ELM_EVAL_B with (n:=1) (b:=  (EQ_M (m (f mphi1))
                                          (exp (pi1 (ggen (N 0)))
                                             (pi2 (ggen (N 0))) 
                                             (r (N 1))))) in H;
simpl in H;

apply Forall_ELM_EVAL_B with (n:=0) (b:= (EQ_M (to (f mphi1)) (i 2))) in H;
simpl in H;
rewrite H;
clear H. 



pose proof(IFMORPH_M2 0  (if_then_else_B
                                          (EQ_M (m (f mphi1))
                                             (exp (pi1 (ggen (N 0)))
                                                (pi2 (ggen (N 0))) 
                                                (r (N 1))))
                                          (if_then_else_B
                                             (EQ_M (act (f mphi2)) new) FAlse
                                             (EQ_M 
                                                (m (f mphi2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2))))) FAlse) FAlse
                                    (exp (pi1 (ggen (N 0))) 
                                       (m (f mphi1)) 
                                       (r (N 2))) (if_then_else_M
                                       (if_then_else_B
                                          (EQ_M (reveal (f mphi3)) (i 1))
                                          (if_then_else_B
                                             (EQ_M (to (f mphi1)) (i 2))
                                             (if_then_else_B
                                                (EQ_M 
                                                  (m (f mphi1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                                (if_then_else_B
                                                  (EQ_M (act (f mphi2)) new)
                                                  FAlse
                                                  (EQ_M 
                                                  (m (f mphi2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2))))) FAlse) FAlse)
                                          FAlse)
                                       (exp (pi1 (ggen (N 0))) 
                                          (m (f mphi2)) 
                                          (r (N 1)))
                                       (if_then_else_M
                                          (EQ_M (to (f mphi0)) (i 2))
                                          (exp (pi1 (ggen (N 0)))
                                             (m (f mphi0)) 
                                             (r (N 1)))
                                          (exp (pi1 (ggen (N 0)))
                                             (m (f mphi2)) 
                                             (r (N 3))))) ) ;
            apply Forall_ELM_EVAL_M with (n:=0) (x:=   (EQ_M (to (f mphi1)) (i 2)) ) in H;
simpl in H;  try rewrite IFFALSE_M in H; rewrite H; clear H.





pose proof(IFMORPH_M2 0 (if_then_else_B
                                             (EQ_M (act (f mphi2)) new) FAlse
                                             (EQ_M 
                                                (m (f mphi2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2))))) FAlse
                                       (exp (pi1 (ggen (N 0))) 
                                          (m (f mphi1)) 
                                          (r (N 2))) (if_then_else_M
                                          (if_then_else_B
                                             (EQ_M (reveal (f mphi3)) (i 1))
                                             (if_then_else_B
                                                (EQ_M (to (f mphi1)) (i 2))
                                                (if_then_else_B
                                                  (EQ_M 
                                                  (m (f mphi1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                                  (if_then_else_B
                                                  (EQ_M (act (f mphi2)) new)
                                                  FAlse
                                                  (EQ_M 
                                                  (m (f mphi2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2))))) FAlse) FAlse)
                                             FAlse)
                                          (exp (pi1 (ggen (N 0)))
                                             (m (f mphi2)) 
                                             (r (N 1)))
                                          (if_then_else_M
                                             (EQ_M (to (f mphi0)) (i 2))
                                             (exp (pi1 (ggen (N 0)))
                                                (m (f mphi0)) 
                                                (r (N 1)))
                                             (exp (pi1 (ggen (N 0)))
                                                (m (f mphi2)) 
                                                (r (N 3))))) ) ;
            apply Forall_ELM_EVAL_M with (n:=0) (x:=   (EQ_M (m (f mphi1))
                                             (exp (pi1 (ggen (N 0)))
                                                (pi2 (ggen (N 0))) 
                                                (r (N 1)))) ) in H;
simpl in H;  try rewrite IFFALSE_M in H; rewrite H; clear H.



pose proof(IFMORPH_M2 0  FAlse
                                             (EQ_M 
                                                (m (f mphi2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) (exp (pi1 (ggen (N 0)))
                                             (m (f mphi1)) 
                                             (r (N 2)))  (if_then_else_M
                                             (if_then_else_B
                                                (EQ_M 
                                                  (reveal (f mphi3)) 
                                                  (i 1))
                                                (if_then_else_B
                                                  (EQ_M (to (f mphi1)) (i 2))
                                                  (if_then_else_B
                                                  (EQ_M 
                                                  (m (f mphi1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                                  (if_then_else_B
                                                  (EQ_M (act (f mphi2)) new)
                                                  FAlse
                                                  (EQ_M 
                                                  (m (f mphi2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0))) 
                                                  (r (N 2))))) FAlse) FAlse)
                                                FAlse)
                                             (exp (pi1 (ggen (N 0)))
                                                (m (f mphi2)) 
                                                (r (N 1)))
                                             (if_then_else_M
                                                (EQ_M (to (f mphi0)) (i 2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi0)) 
                                                  (r (N 1)))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi2)) 
                                                  (r (N 3))))) ) ;
            apply Forall_ELM_EVAL_M with (n:=0) (x:=  (EQ_M (act (f mphi2)) new) ) in H;
simpl in H;  try rewrite IFFALSE_M in H; rewrite H; clear H.


pose proof(IFMORPH_M2 0   (if_then_else_B
                                                  (EQ_M (to (f mphi1)) (i 2))
                                                  (if_then_else_B
                                                  (EQ_M 
                                                  (m (f mphi1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                                  (if_then_else_B
                                                  (EQ_M (act (f mphi2)) new)
                                                  FAlse
                                                  (EQ_M 
                                                  (m (f mphi2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0))) 
                                                  (r (N 2))))) FAlse) FAlse )
                                                FAlse  (exp (pi1 (ggen (N 0)))
                                                (m (f mphi2)) 
                                                (r (N 1)))
                                             (if_then_else_M
                                                (EQ_M (to (f mphi0)) (i 2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi0)) 
                                                  (r (N 1)))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi2)) 
                                                  (r (N 3))))) ;
            apply Forall_ELM_EVAL_M with (n:=0) (x:=  (EQ_M 
                                                  (reveal (f mphi3)) 
                                                  (i 1)) ) in H;
simpl in H;  try rewrite IFFALSE_M in H; rewrite H; clear H.

pose proof(IFMORPH_M2 0   (if_then_else_B
                                                  (EQ_M 
                                                  (m (f mphi1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                                  (if_then_else_B
                                                  (EQ_M (act (f mphi2)) new)
                                                  FAlse
                                                  (EQ_M 
                                                  (m (f mphi2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0))) 
                                                  (r (N 2))))) FAlse) FAlse
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi2)) 
                                                  (r (N 1)))  (if_then_else_M
                                                  (EQ_M (to (f mphi0)) (i 2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi0)) 
                                                  (r (N 1)))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi2)) 
                                                  (r (N 3)))) ) ;
            apply Forall_ELM_EVAL_M with (n:=0) (x:=  (EQ_M (to (f mphi1)) (i 2)) ) in H;
simpl in H;  try rewrite IFFALSE_M in H; rewrite H; clear H.


pose proof (IFMORPH_M2 0 (if_then_else_B
                                                  (EQ_M (act (f mphi2)) new)
                                                  FAlse
                                                  (EQ_M 
                                                  (m (f mphi2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0))) 
                                                  (r (N 2))))) FAlse
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi2)) 
                                                  (r (N 1)))
                                                   (if_then_else_M
                                                  (EQ_M (to (f mphi0)) (i 2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi0)) 
                                                  (r (N 1)))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi2)) 
                                                  (r (N 3))))); 
                       apply Forall_ELM_EVAL_M with (n:=0) (x:=  (EQ_M 
                                                  (m (f mphi1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1)))) ) in H;
simpl in H;  try rewrite IFFALSE_M in H; rewrite H; clear H.


pose proof (IFMORPH_M2 0  FAlse
                                                  (EQ_M 
                                                  (m (f mphi2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0))) 
                                                  (r (N 2))))         (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi2)) 
                                                  (r (N 1)))
                                                  (if_then_else_M
                                                  (EQ_M (to (f mphi0)) (i 2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi0)) 
                                                  (r (N 1)))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi2)) 
                                                  (r (N 3))))); 
                       apply Forall_ELM_EVAL_M with (n:=0) (x:= (EQ_M (act (f mphi2)) new) ) in H;
simpl in H;  try rewrite IFFALSE_M in H; rewrite H; clear H.

pose proof (IFMORPH_M2 0  (if_then_else_B
                                       (EQ_M (to (f mphi2)) (i 1))
                                       (if_then_else_B
                                          (EQ_M (to (f mphi1)) (i 2))
                                          (if_then_else_B
                                             (EQ_M 
                                                (m (f mphi1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                             (if_then_else_B
                                                (EQ_M (act (f mphi2)) new)
                                                FAlse
                                                (EQ_M 
                                                  (m (f mphi2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2))))) FAlse) FAlse)
                                       FAlse) FAlse
                                 (exp (pi1 (ggen (N 0))) 
                                    (m (f mphi2)) (r (N 1))) O); 
                       apply Forall_ELM_EVAL_M with (n:=0) (x:=(EQ_M (reveal (f mphi3)) (i 1))) in H;
simpl in H;  try rewrite IFFALSE_M in H; rewrite H; clear H.


pose proof (IFMORPH_M2 0  (if_then_else_B
                                          (EQ_M (to (f mphi1)) (i 2))
                                          (if_then_else_B
                                             (EQ_M 
                                                (m (f mphi1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                             (if_then_else_B
                                                (EQ_M (act (f mphi2)) new)
                                                FAlse
                                                (EQ_M 
                                                  (m (f mphi2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2))))) FAlse) FAlse)
                                       FAlse
                                    (exp (pi1 (ggen (N 0))) 
                                       (m (f mphi2)) 
                                       (r (N 1))) O); 
                       apply Forall_ELM_EVAL_M with (n:=0) (x:=(EQ_M (to (f mphi2)) (i 1))) in H;
simpl in H;  try rewrite IFFALSE_M in H; rewrite H; clear H.



pose proof (IFMORPH_M2 0   (if_then_else_B
                                             (EQ_M 
                                                (m (f mphi1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                             (if_then_else_B
                                                (EQ_M (act (f mphi2)) new)
                                                FAlse
                                                (EQ_M 
                                                  (m (f mphi2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2))))) FAlse) FAlse
                                       (exp (pi1 (ggen (N 0))) 
                                          (m (f mphi2)) 
                                          (r (N 1))) O); 
                       apply Forall_ELM_EVAL_M with (n:=0) (x:=(EQ_M (to (f mphi1)) (i 2))) in H;
simpl in H;  try rewrite IFFALSE_M in H; rewrite H; clear H.




pose proof (IFMORPH_M2 0   (if_then_else_B
                                                (EQ_M (act (f mphi2)) new)
                                                FAlse
                                                (EQ_M 
                                                  (m (f mphi2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2))))) FAlse
                                          (exp (pi1 (ggen (N 0)))
                                             (m (f mphi2)) 
                                             (r (N 1))) O); 
                       apply Forall_ELM_EVAL_M with (n:=0) (x:=(EQ_M 
                                                (m (f mphi1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))) in H;
simpl in H;  try rewrite IFFALSE_M in H; rewrite H; clear H.

pose proof (IFMORPH_M2 0    FAlse
                                                (EQ_M 
                                                  (m (f mphi2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2))))
                                             (exp (pi1 (ggen (N 0)))
                                                (m (f mphi2)) 
                                                (r (N 1))) O); 
                       apply Forall_ELM_EVAL_M with (n:=0) (x:=(EQ_M (act (f mphi2)) new)) in H;
simpl in H;  try rewrite IFFALSE_M in H; rewrite H; clear H.

pose proof (IFMORPH_M2 0  (if_then_else_B
                                       (EQ_M (to (f mphi2)) (i 1))
                                       (if_then_else_B
                                          (EQ_M (to (f mphi1)) (i 2))
                                          (if_then_else_B
                                             (EQ_M 
                                                (m (f mphi1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                             (if_then_else_B
                                                (EQ_M (act (f mphi2)) new)
                                                FAlse
                                                (EQ_M 
                                                  (m (f mphi2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2))))) FAlse) FAlse)
                                       FAlse) FAlse
                                 (exp (pi1 (ggen (N 0))) 
                                    (m (f mphi2)) (r (N 1)))  (if_then_else_M
                                    (EQ_M (reveal (f mphi3)) (i 2))
                                    (if_then_else_M
                                       (EQ_M (to (f mphi0)) (i 2))
                                       (exp (pi1 (ggen (N 0))) 
                                          (m (f mphi0)) 
                                          (r (N 1)))
                                       (if_then_else_M
                                          (EQ_M (to (f mphi2)) (i 2))
                                          (exp (pi1 (ggen (N 0)))
                                             (m (f mphi2)) 
                                             (r (N 3))) O)) O)) ; 
                       apply Forall_ELM_EVAL_M with (n:=0) (x:= (EQ_M (reveal (f mphi3)) (i 1))) in H;
simpl in H;  try rewrite IFFALSE_M in H; rewrite H; clear H.


pose proof(IFMORPH_B1    FAlse
                                                (EQ_M 
                                                  (m (f mphi2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse  0 1 );
rewrite IFSAME_B in H;

apply Forall_ELM_EVAL_B with (n:=1) (b:= (EQ_M 
                                                (m (f mphi1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1)))) ) in H;
simpl in H;

apply Forall_ELM_EVAL_B with (n:=0) (b:= (EQ_M (act (f mphi2)) new)) in H;
simpl in H;
rewrite H;
clear H. 

                          
pose proof(IFMORPH_B4 0   FAlse    (EQ_M 
                                                  (m (f mphi2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse );
apply Forall_ELM_EVAL_B with (n:=0) (b:=(EQ_M (act (f mphi2)) new)) in H;
simpl in H;

apply Forall_ELM_EVAL_B with (n:=1) (b:=   (EQ_M 
                                                  (m (f mphi1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))) in H;
simpl in H; try rewrite IFSAME_B in H;
rewrite H;
clear H.


pose proof(IFMORPH_B1    FAlse
                                                (EQ_M 
                                                  (m (f mphi2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse  0 1 );
rewrite IFSAME_B in H;

apply Forall_ELM_EVAL_B with (n:=1) (b:= (EQ_M 
                                                (m (f mphi1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1)))) ) in H;
simpl in H;

apply Forall_ELM_EVAL_B with (n:=0) (b:= (EQ_M (act (f mphi2)) new)) in H;
simpl in H;
rewrite H;
clear H. 
pose proof (IFMORPH_M2 0   (if_then_else_B
                                          (EQ_M (to (f mphi1)) (i 2))
                                          (if_then_else_B
                                             (EQ_M (act (f mphi2)) new) FAlse
                                             (if_then_else_B
                                                (EQ_M 
                                                  (m (f mphi1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                                (EQ_M 
                                                  (m (f mphi2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse)) FAlse)
                                       FAlse
                              (exp (pi1 (ggen (N 0))) (m (f mphi2)) (r (N 1)))
                                (if_then_else_M
                                       (EQ_M (reveal (f mphi3)) (i 2))
                                       (if_then_else_M
                                          (EQ_M (to (f mphi0)) (i 2))
                                          (exp (pi1 (ggen (N 0)))
                                             (m (f mphi0)) 
                                             (r (N 1)))
                                          (if_then_else_M
                                             (EQ_M (to (f mphi2)) (i 2))
                                             (exp (pi1 (ggen (N 0)))
                                                (m (f mphi2)) 
                                                (r (N 3))) O)) O)) ; 
                       apply Forall_ELM_EVAL_M with (n:=0) (x:=  (EQ_M (to (f mphi2)) (i 1))) in H;
simpl in H;  try rewrite IFFALSE_M in H; rewrite H; clear H.
pose proof (IFMORPH_M2 0   (if_then_else_B
                                             (EQ_M (act (f mphi2)) new) FAlse
                                             (if_then_else_B
                                                (EQ_M 
                                                  (m (f mphi1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                                (EQ_M 
                                                  (m (f mphi2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse)) FAlse
                                       (exp (pi1 (ggen (N 0))) 
                                          (m (f mphi2)) 
                                          (r (N 1)))  (if_then_else_M
                                          (EQ_M (reveal (f mphi3)) (i 2))
                                          (if_then_else_M
                                             (EQ_M (to (f mphi0)) (i 2))
                                             (exp (pi1 (ggen (N 0)))
                                                (m (f mphi0)) 
                                                (r (N 1)))
                                             (if_then_else_M
                                                (EQ_M (to (f mphi2)) (i 2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi2)) 
                                                  (r (N 3))) O)) O)) ; 
                       apply Forall_ELM_EVAL_M with (n:=0) (x:=   (EQ_M (to (f mphi1)) (i 2))) in H;
simpl in H;  try rewrite IFFALSE_M in H; rewrite H; clear H.


pose proof (IFMORPH_M2 0    FAlse
                                             (if_then_else_B
                                                (EQ_M 
                                                  (m (f mphi1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                                (EQ_M 
                                                  (m (f mphi2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse) (exp (pi1 (ggen (N 0)))
                                             (m (f mphi2)) 
                                             (r (N 1)))
                                          (if_then_else_M
                                             (EQ_M (reveal (f mphi3)) (i 2))
                                             (if_then_else_M
                                                (EQ_M (to (f mphi0)) (i 2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi0)) 
                                                  (r (N 1)))
                                                (if_then_else_M
                                                  (EQ_M (to (f mphi2)) (i 2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi2)) 
                                                  (r (N 3))) O)) O) ) ; 
                       apply Forall_ELM_EVAL_M with (n:=0) (x:=   (EQ_M (act (f mphi2)) new)) in H;
simpl in H;  try rewrite IFFALSE_M in H; rewrite H; clear H.



pose proof (IFMORPH_M2 0   (EQ_M 
                                                  (m (f mphi2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse
                                             (exp (pi1 (ggen (N 0)))
                                                (m (f mphi2)) 
                                                (r (N 1)))
                                             (if_then_else_M
                                                (EQ_M 
                                                  (reveal (f mphi3)) 
                                                  (i 2))
                                                (if_then_else_M
                                                  (EQ_M (to (f mphi0)) (i 2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi0)) 
                                                  (r (N 1)))
                                                  (if_then_else_M
                                                  (EQ_M (to (f mphi2)) (i 2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi2)) 
                                                  (r (N 3))) O)) O)) ; 
                       apply Forall_ELM_EVAL_M with (n:=0) (x:=   (EQ_M 
                                                  (m (f mphi1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))) in H;
simpl in H;  try rewrite IFFALSE_M in H; rewrite H; clear H.


pose proof (IFMORPH_M2 0   (if_then_else_B (EQ_M (to (f mphi2)) (i 1))
                                    (if_then_else_B
                                       (EQ_M (to (f mphi1)) (i 2))
                                       (if_then_else_B
                                          (EQ_M (act (f mphi2)) new) FAlse
                                          (if_then_else_B
                                             (EQ_M 
                                                (m (f mphi1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                             (EQ_M 
                                                (m (f mphi2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse)) FAlse)
                                    FAlse) FAlse
                              (exp (pi1 (ggen (N 0))) (m (f mphi1)) (r (N 2))) (if_then_else_M (EQ_M (reveal (f mphi3)) (i 1))
                                 (if_then_else_M (EQ_M (to (f mphi2)) (i 1))
                                    (if_then_else_M
                                       (EQ_M (to (f mphi1)) (i 2))
                                       (if_then_else_M
                                          (EQ_M (act (f mphi2)) new)
                                          (if_then_else_M
                                             (EQ_M (reveal (f mphi3)) (i 2))
                                             (if_then_else_M
                                                (EQ_M (to (f mphi0)) (i 2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi0)) 
                                                  (r (N 1)))
                                                (if_then_else_M
                                                  (EQ_M (to (f mphi2)) (i 2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi2)) 
                                                  (r (N 3))) O)) O)
                                          (if_then_else_M
                                             (EQ_M 
                                                (m (f mphi1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                             (if_then_else_M
                                                (EQ_M 
                                                  (m (f mphi2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2))))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi2)) 
                                                  (r (N 1)))
                                                (if_then_else_M
                                                  (EQ_M 
                                                  (reveal (f mphi3)) 
                                                  (i 2))
                                                  (if_then_else_M
                                                  (EQ_M (to (f mphi0)) (i 2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi0)) 
                                                  (r (N 1)))
                                                  (if_then_else_M
                                                  (EQ_M (to (f mphi2)) (i 2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi2)) 
                                                  (r (N 3))) O)) O))
                                             (if_then_else_M
                                                (EQ_M 
                                                  (reveal (f mphi3)) 
                                                  (i 2))
                                                (if_then_else_M
                                                  (EQ_M (to (f mphi0)) (i 2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi0)) 
                                                  (r (N 1)))
                                                  (if_then_else_M
                                                  (EQ_M (to (f mphi2)) (i 2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi2)) 
                                                  (r (N 3))) O)) O)))
                                       (if_then_else_M
                                          (EQ_M (reveal (f mphi3)) (i 2))
                                          (if_then_else_M
                                             (EQ_M (to (f mphi0)) (i 2))
                                             (exp (pi1 (ggen (N 0)))
                                                (m (f mphi0)) 
                                                (r (N 1)))
                                             (if_then_else_M
                                                (EQ_M (to (f mphi2)) (i 2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi2)) 
                                                  (r (N 3))) O)) O))
                                    (if_then_else_M
                                       (EQ_M (reveal (f mphi3)) (i 2))
                                       (if_then_else_M
                                          (EQ_M (to (f mphi0)) (i 2))
                                          (exp (pi1 (ggen (N 0)))
                                             (m (f mphi0)) 
                                             (r (N 1)))
                                          (if_then_else_M
                                             (EQ_M (to (f mphi2)) (i 2))
                                             (exp (pi1 (ggen (N 0)))
                                                (m (f mphi2)) 
                                                (r (N 3))) O)) O))
                                 (if_then_else_M
                                    (EQ_M (reveal (f mphi3)) (i 2))
                                    (if_then_else_M
                                       (EQ_M (to (f mphi0)) (i 2))
                                       (exp (pi1 (ggen (N 0))) 
                                          (m (f mphi0)) 
                                          (r (N 1)))
                                       (if_then_else_M
                                          (EQ_M (to (f mphi2)) (i 2))
                                          (exp (pi1 (ggen (N 0)))
                                             (m (f mphi2)) 
                                             (r (N 3))) O)) O))) ; 
                       apply Forall_ELM_EVAL_M with (n:=0) (x:=   (EQ_M (reveal (f mphi3)) (i 2))) in H;
simpl in H;  try rewrite IFFALSE_M in H; rewrite H; clear H.

pose proof (IFMORPH_M2 0     (if_then_else_B
                                       (EQ_M (to (f mphi1)) (i 2))
                                       (if_then_else_B
                                          (EQ_M (act (f mphi2)) new) FAlse
                                          (if_then_else_B
                                             (EQ_M 
                                                (m (f mphi1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                             (EQ_M 
                                                (m (f mphi2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse)) FAlse)
                                        FAlse
                                 (exp (pi1 (ggen (N 0))) 
                                    (m (f mphi1)) (r (N 2)))
                                            (if_then_else_M
                                    (EQ_M (reveal (f mphi3)) (i 1))
                                    (if_then_else_M
                                       (EQ_M (to (f mphi2)) (i 1))
                                       (if_then_else_M
                                          (EQ_M (to (f mphi1)) (i 2))
                                          (if_then_else_M
                                             (EQ_M (act (f mphi2)) new)
                                             (if_then_else_M
                                                (EQ_M 
                                                  (reveal (f mphi3)) 
                                                  (i 2))
                                                (if_then_else_M
                                                  (EQ_M (to (f mphi0)) (i 2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi0)) 
                                                  (r (N 1)))
                                                  (if_then_else_M
                                                  (EQ_M (to (f mphi2)) (i 2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi2)) 
                                                  (r (N 3))) O)) O)
                                             (if_then_else_M
                                                (EQ_M 
                                                  (m (f mphi1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                                (if_then_else_M
                                                  (EQ_M 
                                                  (m (f mphi2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2))))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi2)) 
                                                  (r (N 1)))
                                                  (if_then_else_M
                                                  (EQ_M 
                                                  (reveal (f mphi3)) 
                                                  (i 2))
                                                  (if_then_else_M
                                                  (EQ_M (to (f mphi0)) (i 2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi0)) 
                                                  (r (N 1)))
                                                  (if_then_else_M
                                                  (EQ_M (to (f mphi2)) (i 2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi2)) 
                                                  (r (N 3))) O)) O))
                                                (if_then_else_M
                                                  (EQ_M 
                                                  (reveal (f mphi3)) 
                                                  (i 2))
                                                  (if_then_else_M
                                                  (EQ_M (to (f mphi0)) (i 2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi0)) 
                                                  (r (N 1)))
                                                  (if_then_else_M
                                                  (EQ_M (to (f mphi2)) (i 2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi2)) 
                                                  (r (N 3))) O)) O)))
                                          (if_then_else_M
                                             (EQ_M (reveal (f mphi3)) (i 2))
                                             (if_then_else_M
                                                (EQ_M (to (f mphi0)) (i 2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi0)) 
                                                  (r (N 1)))
                                                (if_then_else_M
                                                  (EQ_M (to (f mphi2)) (i 2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi2)) 
                                                  (r (N 3))) O)) O))
                                       (if_then_else_M
                                          (EQ_M (reveal (f mphi3)) (i 2))
                                          (if_then_else_M
                                             (EQ_M (to (f mphi0)) (i 2))
                                             (exp (pi1 (ggen (N 0)))
                                                (m (f mphi0)) 
                                                (r (N 1)))
                                             (if_then_else_M
                                                (EQ_M (to (f mphi2)) (i 2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi2)) 
                                                  (r (N 3))) O)) O))
                                    (if_then_else_M
                                       (EQ_M (reveal (f mphi3)) (i 2))
                                       (if_then_else_M
                                          (EQ_M (to (f mphi0)) (i 2))
                                          (exp (pi1 (ggen (N 0)))
                                             (m (f mphi0)) 
                                             (r (N 1)))
                                          (if_then_else_M
                                             (EQ_M (to (f mphi2)) (i 2))
                                             (exp (pi1 (ggen (N 0)))
                                                (m (f mphi2)) 
                                                (r (N 3))) O)) O))    ) ; 
                       apply Forall_ELM_EVAL_M with (n:=0) (x:=   (EQ_M (to (f mphi2)) (i 1))) in H;
simpl in H;  try rewrite IFFALSE_M in H; rewrite H; clear H.

pose proof(IFMORPH_B1    FAlse
                                       (if_then_else_B
                                          (EQ_M (m (f mphi1))
                                             (exp (pi1 (ggen (N 0)))
                                                (pi2 (ggen (N 0))) 
                                                (r (N 1))))
                                          (EQ_M (m (f mphi2))
                                             (exp (pi1 (ggen (N 0)))
                                                (pi2 (ggen (N 0))) 
                                                (r (N 2)))) FAlse) FAlse  0 1 );
rewrite IFSAME_B in H;

apply Forall_ELM_EVAL_B with (n:=1) (b:= (EQ_M (to (f mphi1)) (i 2))) in H;
simpl in H;

apply Forall_ELM_EVAL_B with (n:=0) (b:= (EQ_M (act (f mphi2)) new)) in H;
simpl in H;
rewrite H;
clear H. 

pose proof(IFMORPH_B1     FAlse
                                       (if_then_else_B
                                          (EQ_M (to (f mphi1)) (i 2))
                                          (if_then_else_B
                                             (EQ_M 
                                                (m (f mphi1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                             (EQ_M 
                                                (m (f mphi2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse) FAlse)
                                    FAlse  0 1 );
rewrite IFSAME_B in H;

apply Forall_ELM_EVAL_B with (n:=1) (b:= (EQ_M (to (f mphi2)) (i 1))) in H;
simpl in H;

apply Forall_ELM_EVAL_B with (n:=0) (b:=  (EQ_M (act (f mphi2)) new)) in H;
simpl in H;
rewrite H;
clear H. 


pose proof (IFMORPH_M2 0   (if_then_else_B (EQ_M (act (f mphi2)) new)
                                    FAlse
                                    (if_then_else_B
                                       (EQ_M (to (f mphi2)) (i 1))
                                       (if_then_else_B
                                          (EQ_M (to (f mphi1)) (i 2))
                                          (if_then_else_B
                                             (EQ_M 
                                                (m (f mphi1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                             (EQ_M 
                                                (m (f mphi2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse) FAlse)
                                       FAlse)) FAlse   (exp (pi1 (ggen (N 0))) (m (f mphi2)) (r (N 1))) (if_then_else_M (EQ_M (reveal (f mphi3)) (i 2))
                                 (if_then_else_M (EQ_M (to (f mphi0)) (i 2))
                                    (exp (pi1 (ggen (N 0))) 
                                       (m (f mphi0)) 
                                       (r (N 1)))
                                    (if_then_else_M
                                       (EQ_M (to (f mphi2)) (i 2))
                                       (exp (pi1 (ggen (N 0))) 
                                          (m (f mphi2)) 
                                          (r (N 3)))
                                       (if_then_else_M
                                          (EQ_M (act (f mphi1)) new) O
                                          (if_then_else_M
                                             (EQ_M (reveal (f mphi3)) (i 1))
                                             (exp (pi1 (ggen (N 0)))
                                                (m (f mphi1)) 
                                                (r (N 1))) O))))
                                 (if_then_else_M (EQ_M (act (f mphi1)) new) O
                                    (if_then_else_M
                                       (EQ_M (reveal (f mphi3)) (i 1))
                                       (exp (pi1 (ggen (N 0))) 
                                          (m (f mphi1)) 
                                          (r (N 1))) O))) ) ; 
                       apply Forall_ELM_EVAL_M with (n:=0) (x:=  (EQ_M (reveal (f mphi3)) (i 1))) in H;
simpl in H;  try rewrite IFFALSE_M in H; rewrite H; clear H.
pose proof(IFMORPH_B1    (EQ_M 
                                                (m (f mphi2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse FAlse  0 1 );
rewrite IFSAME_B in H;

apply Forall_ELM_EVAL_B with (n:=1) (b:= (EQ_M (to (f mphi1)) (i 2))) in H;
simpl in H;

apply Forall_ELM_EVAL_B with (n:=0) (b:=   (EQ_M 
                                                (m (f mphi1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))) in H;
simpl in H;
rewrite H;
clear H. 

pose proof(IFMORPH_B1     
                                             (EQ_M 
                                                (m (f mphi2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse FAlse 0 1 );
rewrite IFSAME_B in H;

apply Forall_ELM_EVAL_B with (n:=1) (b:= (EQ_M (m (f mphi1))
                                             (exp (pi1 (ggen (N 0)))
                                                (pi2 (ggen (N 0))) 
                                                (r (N 1))))) in H;
simpl in H;

apply Forall_ELM_EVAL_B with (n:=0) (b:=   (EQ_M (to (f mphi1)) (i 2))) in H;
simpl in H;
rewrite H;
clear H. 
pose proof(IFMORPH_M2   0 (if_then_else_B (EQ_M (act (f mphi2)) new)
                                 FAlse
                                 (if_then_else_B (EQ_M (to (f mphi2)) (i 1))
                                    (if_then_else_B
                                       (EQ_M (to (f mphi1)) (i 2))
                                       (if_then_else_B
                                          (EQ_M (m (f mphi1))
                                             (exp (pi1 (ggen (N 0)))
                                                (pi2 (ggen (N 0))) 
                                                (r (N 1))))
                                          (EQ_M (m (f mphi2))
                                             (exp (pi1 (ggen (N 0)))
                                                (pi2 (ggen (N 0))) 
                                                (r (N 2)))) FAlse) FAlse)
                                    FAlse)) FAlse
                           (exp (pi1 (ggen (N 0))) (m (f mphi1)) (r (N 2)))   (if_then_else_M (EQ_M (reveal (f mphi3)) (i 1))
                              (if_then_else_M
                                 (if_then_else_B (EQ_M (act (f mphi2)) new)
                                    FAlse
                                    (if_then_else_B
                                       (EQ_M (to (f mphi2)) (i 1))
                                       (if_then_else_B
                                          (EQ_M (to (f mphi1)) (i 2))
                                          (if_then_else_B
                                             (EQ_M 
                                                (m (f mphi1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                             (EQ_M 
                                                (m (f mphi2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse) FAlse)
                                       FAlse))
                                 (exp (pi1 (ggen (N 0))) 
                                    (m (f mphi2)) (r (N 1)))
                                 (if_then_else_M
                                    (EQ_M (reveal (f mphi3)) (i 2))
                                    (if_then_else_M
                                       (EQ_M (to (f mphi0)) (i 2))
                                       (exp (pi1 (ggen (N 0))) 
                                          (m (f mphi0)) 
                                          (r (N 1)))
                                       (if_then_else_M
                                          (EQ_M (to (f mphi2)) (i 2))
                                          (exp (pi1 (ggen (N 0)))
                                             (m (f mphi2)) 
                                             (r (N 3)))
                                          (if_then_else_M
                                             (EQ_M (act (f mphi1)) new) O
                                             (if_then_else_M
                                                (EQ_M 
                                                  (reveal (f mphi3)) 
                                                  (i 1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi1)) 
                                                  (r (N 1))) O))))
                                    (if_then_else_M
                                       (EQ_M (act (f mphi1)) new) O
                                       (if_then_else_M
                                          (EQ_M (reveal (f mphi3)) (i 1))
                                          (exp (pi1 (ggen (N 0)))
                                             (m (f mphi1)) 
                                             (r (N 1))) O))))
                              (if_then_else_M (EQ_M (reveal (f mphi3)) (i 2))
                                 (if_then_else_M (EQ_M (to (f mphi0)) (i 2))
                                    (exp (pi1 (ggen (N 0))) 
                                       (m (f mphi0)) 
                                       (r (N 1)))
                                    (if_then_else_M
                                       (EQ_M (to (f mphi2)) (i 2))
                                       (exp (pi1 (ggen (N 0))) 
                                          (m (f mphi2)) 
                                          (r (N 3)))
                                       (if_then_else_M
                                          (EQ_M (act (f mphi1)) new) O
                                          (if_then_else_M
                                             (EQ_M (reveal (f mphi3)) (i 1))
                                             (exp (pi1 (ggen (N 0)))
                                                (m (f mphi1)) 
                                                (r (N 1))) O))))
                                 (if_then_else_M (EQ_M (act (f mphi1)) new) O
                                    (if_then_else_M
                                       (EQ_M (reveal (f mphi3)) (i 1))
                                       (exp (pi1 (ggen (N 0))) 
                                          (m (f mphi1)) 
                                          (r (N 1))) O))))  );
 apply Forall_ELM_EVAL_M with (n:=0) (x:=  (EQ_M (reveal (f mphi3)) (i 2))) in H;
simpl in H;  try rewrite IFFALSE_M in H; rewrite H; clear H.


pose proof (IFMORPH_M2 0  FAlse
                                 (if_then_else_B (EQ_M (to (f mphi2)) (i 1))
                                    (if_then_else_B
                                       (EQ_M (to (f mphi1)) (i 2))
                                       (if_then_else_B
                                          (EQ_M (m (f mphi1))
                                             (exp (pi1 (ggen (N 0)))
                                                (pi2 (ggen (N 0))) 
                                                (r (N 1))))
                                          (EQ_M (m (f mphi2))
                                             (exp (pi1 (ggen (N 0)))
                                                (pi2 (ggen (N 0))) 
                                                (r (N 2)))) FAlse) FAlse)
                                    FAlse))
                              (exp (pi1 (ggen (N 0))) (m (f mphi1)) (r (N 2)))
   (if_then_else_M (EQ_M (reveal (f mphi3)) (i 1))
                                 (if_then_else_M
                                    (if_then_else_B
                                       (EQ_M (act (f mphi2)) new) FAlse
                                       (if_then_else_B
                                          (EQ_M (to (f mphi2)) (i 1))
                                          (if_then_else_B
                                             (EQ_M (to (f mphi1)) (i 2))
                                             (if_then_else_B
                                                (EQ_M 
                                                  (m (f mphi1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                                (EQ_M 
                                                  (m (f mphi2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse) FAlse)
                                          FAlse))
                                    (exp (pi1 (ggen (N 0))) 
                                       (m (f mphi2)) 
                                       (r (N 1)))
                                    (if_then_else_M
                                       (EQ_M (reveal (f mphi3)) (i 2))
                                       (if_then_else_M
                                          (EQ_M (to (f mphi0)) (i 2))
                                          (exp (pi1 (ggen (N 0)))
                                             (m (f mphi0)) 
                                             (r (N 1)))
                                          (if_then_else_M
                                             (EQ_M (to (f mphi2)) (i 2))
                                             (exp (pi1 (ggen (N 0)))
                                                (m (f mphi2)) 
                                                (r (N 3)))
                                             (if_then_else_M
                                                (EQ_M (act (f mphi1)) new) O
                                                (if_then_else_M
                                                  (EQ_M 
                                                  (reveal (f mphi3)) 
                                                  (i 1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi1)) 
                                                  (r (N 1))) O))))
                                       (if_then_else_M
                                          (EQ_M (act (f mphi1)) new) O
                                          (if_then_else_M
                                             (EQ_M (reveal (f mphi3)) (i 1))
                                             (exp (pi1 (ggen (N 0)))
                                                (m (f mphi1)) 
                                                (r (N 1))) O))))
                                 (if_then_else_M
                                    (EQ_M (reveal (f mphi3)) (i 2))
                                    (if_then_else_M
                                       (EQ_M (to (f mphi0)) (i 2))
                                       (exp (pi1 (ggen (N 0))) 
                                          (m (f mphi0)) 
                                          (r (N 1)))
                                       (if_then_else_M
                                          (EQ_M (to (f mphi2)) (i 2))
                                          (exp (pi1 (ggen (N 0)))
                                             (m (f mphi2)) 
                                             (r (N 3)))
                                          (if_then_else_M
                                             (EQ_M (act (f mphi1)) new) O
                                             (if_then_else_M
                                                (EQ_M 
                                                  (reveal (f mphi3)) 
                                                  (i 1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi1)) 
                                                  (r (N 1))) O))))
                                    (if_then_else_M
                                       (EQ_M (act (f mphi1)) new) O
                                       (if_then_else_M
                                          (EQ_M (reveal (f mphi3)) (i 1))
                                          (exp (pi1 (ggen (N 0)))
                                             (m (f mphi1)) 
                                             (r (N 1))) O)))) ; 
                       apply Forall_ELM_EVAL_M with (n:=0) (x:=   (EQ_M (act (f mphi2)) new)) in H;
simpl in H;  try rewrite IFFALSE_M in H; rewrite H; clear H.



pose proof (IFMORPH_M2 0  FAlse
                                       (if_then_else_B
                                          (EQ_M (to (f mphi2)) (i 1))
                                          (if_then_else_B
                                             (EQ_M (to (f mphi1)) (i 2))
                                             (if_then_else_B
                                                (EQ_M 
                                                  (m (f mphi1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                                (EQ_M 
                                                  (m (f mphi2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse) FAlse)
                                          FAlse)   (exp (pi1 (ggen (N 0))) 
                                       (m (f mphi2)) 
                                       (r (N 1)))
                                   
                                                (if_then_else_M
                                       (EQ_M (reveal (f mphi3)) (i 2))
                                       (if_then_else_M
                                          (EQ_M (to (f mphi0)) (i 2))
                                          (exp (pi1 (ggen (N 0)))
                                             (m (f mphi0)) 
                                             (r (N 1)))
                                          (if_then_else_M
                                             (EQ_M (to (f mphi2)) (i 2))
                                             (exp (pi1 (ggen (N 0)))
                                                (m (f mphi2)) 
                                                (r (N 3)))
                                             (if_then_else_M
                                                (EQ_M (act (f mphi1)) new) O
                                                (if_then_else_M
                                                  (EQ_M 
                                                  (reveal (f mphi3)) 
                                                  (i 1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi1)) 
                                                  (r (N 1))) O))))
                                       (if_then_else_M
                                          (EQ_M (act (f mphi1)) new) O
                                          (if_then_else_M
                                             (EQ_M (reveal (f mphi3)) (i 1))
                                             (exp (pi1 (ggen (N 0)))
                                                (m (f mphi1)) 
                                                (r (N 1))) O)))
                                                 ) ; 
                       apply Forall_ELM_EVAL_M with (n:=0) (x:=    (EQ_M (act (f mphi2)) new)) in H;
simpl in H;  try rewrite IFFALSE_M in H; rewrite H; clear H.


pose proof(IFMORPH_B1   (if_then_else_B
                                                (EQ_M 
                                                  (m (f mphi1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                                (EQ_M 
                                                  (m (f mphi2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse) FAlse
                                          FAlse 0 1 );
rewrite IFSAME_B in H;

apply Forall_ELM_EVAL_B with (n:=1) (b:= (EQ_M (to (f mphi2)) (i 1))) in H;
simpl in H;

apply Forall_ELM_EVAL_B with (n:=0) (b:=   (EQ_M (to (f mphi1)) (i 2))) in H;
simpl in H;
rewrite H;
clear H. 




pose proof (IFMORPH_M2 0  (if_then_else_B
                                             (EQ_M (to (f mphi2)) (i 1))
                                             (if_then_else_B
                                                (EQ_M 
                                                  (m (f mphi1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                                (EQ_M 
                                                  (m (f mphi2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse) FAlse)
                                          FAlse (exp (pi1 (ggen (N 0))) 
                                          (m (f mphi2)) 
                                          (r (N 1)))
                                      
                                   
                                                (if_then_else_M
                                          (EQ_M (reveal (f mphi3)) (i 2))
                                          (if_then_else_M
                                             (EQ_M (to (f mphi0)) (i 2))
                                             (exp (pi1 (ggen (N 0)))
                                                (m (f mphi0)) 
                                                (r (N 1)))
                                             (if_then_else_M
                                                (EQ_M (to (f mphi2)) (i 2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi2)) 
                                                  (r (N 3)))
                                                (if_then_else_M
                                                  (EQ_M (act (f mphi1)) new)
                                                  O
                                                  (if_then_else_M
                                                  (EQ_M 
                                                  (reveal (f mphi3)) 
                                                  (i 1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi1)) 
                                                  (r (N 1))) O))))
                                          (if_then_else_M
                                             (EQ_M (act (f mphi1)) new) O
                                             (if_then_else_M
                                                (EQ_M 
                                                  (reveal (f mphi3)) 
                                                  (i 1))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi1)) 
                                                  (r (N 1))) O)))
                                                 ) ; 
                       apply Forall_ELM_EVAL_M with (n:=0) (x:=     (EQ_M (to (f mphi1)) (i 2))) in H;
simpl in H;  try rewrite IFFALSE_M in H; rewrite H; clear H.






pose proof (IFMORPH_M2 0  (if_then_else_B
                                                (EQ_M 
                                                  (m (f mphi1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 1))))
                                                (EQ_M 
                                                  (m (f mphi2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (pi2 (ggen (N 0)))
                                                  (r (N 2)))) FAlse) FAlse
                                          (exp (pi1 (ggen (N 0)))
                                             (m (f mphi2)) 
                                             (r (N 1)))
                                                (if_then_else_M
                                             (EQ_M (reveal (f mphi3)) (i 2))
                                             (if_then_else_M
                                                (EQ_M (to (f mphi0)) (i 2))
                                                (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi0)) 
                                                  (r (N 1)))
                                                (if_then_else_M
                                                  (EQ_M (to (f mphi2)) (i 2))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi2)) 
                                                  (r (N 3)))
                                                  (if_then_else_M
                                                  (EQ_M (act (f mphi1)) new)
                                                  O
                                                  (if_then_else_M
                                                  (EQ_M 
                                                  (reveal (f mphi3)) 
                                                  (i 1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi1)) 
                                                  (r (N 1))) O))))
                                             (if_then_else_M
                                                (EQ_M (act (f mphi1)) new) O
                                                (if_then_else_M
                                                  (EQ_M 
                                                  (reveal (f mphi3)) 
                                                  (i 1))
                                                  (exp 
                                                  (pi1 (ggen (N 0)))
                                                  (m (f mphi1)) 
                                                  (r (N 1))) O))) ) ; 
                       apply Forall_ELM_EVAL_M with (n:=0) (x:=     (EQ_M (to (f mphi2)) (i 1))) in H;
simpl in H;  try rewrite IFFALSE_M in H; rewrite H; clear H.


