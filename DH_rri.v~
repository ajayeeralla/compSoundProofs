Load "extra_theorems".

(*****************Real or random Secrecy*****************************************)
(********************************************************************************)
(******protocol Pi1 :The oracle reveals the actual Key if there is any*************)

(********************************************************************************)


Definition phi0  := [ msg (G 0) ; msg (g 0)].
Definition mphi0 := (conv_mylist_listm phi0).
Definition grn (n:nat) := (exp (G 0) (g 0) (r n)).

Definition x1 := (f mphi0).
(******start state****************)
Definition qa000:= (if_then_else_M (EQ_M (reveal x1) (i 1) ) O (if_then_else_M (EQ_M (reveal x1) (i 2) ) O (if_then_else_M (EQ_M (reveal x1) (i 3) ) O (if_then_else_M (EQ_M (to x1) (i 1)) (grn 1) (if_then_else_M (EQ_M (to x1) (i 2)) (grn 2) (if_then_else_M ((EQ_M (to x1) (i 3)) & (EQ_M (act x1) new)) (grn 3 )  O) ) )))).

(************************)
Definition t12:= msg qa000.
Definition phi1 := phi0 ++ [ t12 ].


(***********************************************************)

Definition mphi1 := (conv_mylist_listm phi1).
Definition mx1rn1 := (exp (G 0) (m x1) (r 1)).
Definition mx1rn2 := (exp (G 0) (m x1) (r 2)).
Definition grn2:= (exp (G 0) (g 0) (r 2)).

Definition x2 := (f mphi1).

Definition tta1 ( x2 x1 :message) (j :nat) := (EQ_M (reveal x2) (i j)) & (EQ_M (to x1) (i j)).
Definition tta2 (x3 x2 x1 :message) (j:nat) := (EQ_M (reveal x3) (i j)) & (EQ_M (to x2) (i j)) & (EQ_M (to x1) (i j))& (notb (EQ_M (act x2) new)) & (EQ_M (act x1) new).

(**********qa0000 -> qa1000, qa0010, qa0100, qa0001*************************************************)

Definition qa100 := (if_then_else_M (EQ_M (reveal x2) (i 1)) & (EQ_M (to x1) (i 1)) mx1rn1 (if_then_else_M (EQ_M (reveal x2) (i 2) ) O (if_then_else_M (EQ_M (reveal x2) (i 3) ) O (if_then_else_M (EQ_M (to x2) (i 2)) (grn 2)  (if_then_else_M (EQ_M (to x2 ) (i 3)) & (EQ_M (act x2) new) (grn 3) O))))).


Definition qa010 := (if_then_else_M (EQ_M (reveal x2) (i 2)) & (EQ_M (to x1) (i 2)) mx1rn2 (if_then_else_M (EQ_M (reveal x2) (i 1) ) O  (if_then_else_M (EQ_M (reveal x2) (i 3) ) O  (if_then_else_M (EQ_M (to x2) (i 1)) (grn 1)  (if_then_else_M (EQ_M (to x2 ) (i 3)) & (EQ_M (act x2) new) (grn 3) O))))).

Definition qa001:=  (if_then_else_M (EQ_M (reveal x2) (i 1) ) O (if_then_else_M (EQ_M (reveal x2) (i 2) ) O (if_then_else_M (EQ_M (reveal x2) (i 3) ) O (if_then_else_M (EQ_M (to x2) (i 1)) (grn 1) (if_then_else_M (EQ_M (to x2) (i 2)) (grn 2) (if_then_else_M (EQ_M (to x2) (i 3)) acc  O) ) )))).


Definition t13 :=  msg (if_then_else_M (EQ_M (reveal x1) (i 1) ) O (if_then_else_M (EQ_M (reveal x1) (i 2) ) O (if_then_else_M (EQ_M (reveal x1) (i 3) ) O (if_then_else_M (EQ_M (to x1) (i 1)) qa100 (if_then_else_M (EQ_M (to x1) (i 2)) qa010 (if_then_else_M ((EQ_M (to x1) (i 3)) & (EQ_M (act x1) new)) qa001  O) ) )))).
Definition phi2:= phi1 ++ [t13].



(***************************************************************************)

Definition mphi2 := (conv_mylist_listm phi2).
Definition mx2rn1 := (exp (G 0) (m x2) (r 1)).
Definition mx2rn2 := (exp (G 0) (m x2) (r 2)).
Definition mx1rn3 := (exp (G 0) (m x1) (r 3)).
Definition mx2rn3 := (exp (G 0) (m x2) (r 3)).
Definition grn3:= (exp (G 0) (g 0) (r 3)).
Definition x3 := (f mphi2).



(************* qa100 -> qbar, qa200, qa110, qa101, qbar*******************************************************)

Definition qa200 := (if_then_else_M (EQ_M (reveal x3) (i 2) ) O (if_then_else_M (EQ_M (reveal x3) (i 3) ) O (if_then_else_M (EQ_M (to x3) (i 2)) (grn 2)  (if_then_else_M (EQ_M (to x3 ) (i 3)) & (EQ_M (act x3) new) (grn 3) O)))).

Definition qa110 := (if_then_else_M (EQ_M (reveal x3) (i 1)) & (EQ_M (to x1) (i 1)) mx1rn1 (if_then_else_M (EQ_M (reveal x3) (i 1)) & (EQ_M (to x2) (i 1)) mx2rn2 (if_then_else_M (EQ_M (reveal x3) (i 2)) & (EQ_M (to x1) (i 2)) mx1rn2 (if_then_else_M (EQ_M (reveal x3) (i 2)) & (EQ_M (to x3) (i 2)) mx2rn2 (if_then_else_M (EQ_M (reveal x3) (i 3) ) O
 (if_then_else_M ((EQ_M (to x3) (i 3)) & (EQ_M (act x3) new)) (grn 3)  O)))))).

Definition qa101 :=  (if_then_else_M (EQ_M (reveal x3) (i 1)) & (EQ_M (to x3) (i 1)) mx1rn1 (if_then_else_M (EQ_M (reveal x3) (i 1)) & (EQ_M (to x3) (i 1)) mx1rn3  (if_then_else_M (EQ_M (reveal x3) (i 2) ) O (if_then_else_M (EQ_M (reveal x3) (i 3) ) O (if_then_else_M (EQ_M (to x3) (i 2)) (grn 2)
 (if_then_else_M (EQ_M (to x3) (i 3)) acc  O)))))).
(*************qa010 -> qbar, qa020, qa110, qa011*****************************)

Definition qa020:= (if_then_else_M (EQ_M (reveal x3) (i 1) ) O (if_then_else_M (EQ_M (reveal x3) (i 3) ) O (if_then_else_M (EQ_M (to x3) (i 1)) (grn 1)
 (if_then_else_M ((EQ_M (to x3) (i 3)) & (EQ_M (act x3) new)) (grn 3)  O)))).

Definition qa011 := (if_then_else_M (EQ_M (reveal x3) (i 1)) & (EQ_M (to x1) (i 1)) mx1rn1 (if_then_else_M (EQ_M (reveal x3) (i 1)) & (EQ_M (to x2) (i 1)) mx1rn3 
 (if_then_else_M (EQ_M (reveal x3) (i 1) ) O (if_then_else_M (EQ_M (reveal x3) (i 3) ) O (if_then_else_M (EQ_M (to x3) (i 1)) (grn 1)
 (if_then_else_M (EQ_M (to x3) (i 3)) acc  O)))))).
(************qa001 -> qabar, qa101, qa011, qa002*****************************)

Definition qa002:= (if_then_else_M  (EQ_M (reveal x3) (i 3)) & (EQ_M (to x2) (i 3)) & (EQ_M (to x1) (i 3))& (notb (EQ_M (act x2) new)) & (EQ_M (act x1) new) mx2rn3 (if_then_else_M (EQ_M (reveal x3) (i 1) ) O (if_then_else_M (EQ_M (reveal x3) (i 2) ) O (if_then_else_M (EQ_M (to x3) (i 1)) (grn 1)
 (if_then_else_M (EQ_M (to x3) (i 2) ) (grn 2)  O))))).


(***********************************************************)
 
Definition qa100_s := (if_then_else_M (EQ_M (reveal x2) (i 1)) & (EQ_M (to x1) (i 1)) qa200 (if_then_else_M (EQ_M (reveal x2) (i 2) ) O (if_then_else_M (EQ_M (reveal x2) (i 3) ) O (if_then_else_M (EQ_M (to x2) (i 2)) qa110  (if_then_else_M (EQ_M (to x2 ) (i 3)) & (EQ_M (act x2) new) qa101  O))))).


Definition qa010_s := (if_then_else_M (EQ_M (reveal x2) (i 2)) & (EQ_M (to x1) (i 2)) qa020 (if_then_else_M (EQ_M (reveal x2) (i 1) ) O  (if_then_else_M (EQ_M (reveal x2) (i 3) ) O  (if_then_else_M (EQ_M (to x2) (i 1)) qa110  (if_then_else_M (EQ_M (to x2 ) (i 3)) & (EQ_M (act x2) new) qa011 O))))).

Definition qa001_s:=  (if_then_else_M (EQ_M (reveal x2) (i 1) ) O (if_then_else_M (EQ_M (reveal x2) (i 2) ) O (if_then_else_M (EQ_M (reveal x2) (i 3) ) O (if_then_else_M (EQ_M (to x2) (i 1)) qa101 (if_then_else_M (EQ_M (to x2) (i 2)) qa011 (if_then_else_M (EQ_M (to x2) (i 3)) qa002  O) ) )))).


Definition t14 :=  msg (if_then_else_M (EQ_M (reveal x1) (i 1) ) O (if_then_else_M (EQ_M (reveal x1) (i 2) ) O (if_then_else_M (EQ_M (reveal x1) (i 3) ) O (if_then_else_M (EQ_M (to x1) (i 1)) qa100_s (if_then_else_M (EQ_M (to x1) (i 2)) qa010_s (if_then_else_M ((EQ_M (to x1) (i 3)) & (EQ_M (act x1) new)) qa001_s  O) ) )))).
Definition phi3:= phi2 ++ [t14].



(*******************************************phi4*****************************************************)
(************************************************************************************************)
Definition mphi3 := (conv_mylist_listm phi3).
Definition x4 := (f mphi3).
Definition mx3rn3 := (exp (G 0) (m x3) (r 3)).
Definition mx3rn2 := (exp (G 0) (m x3) (r 2)).
Definition mx3rn1 := (exp (G 0) (m x3) (r 1)).

Definition qa210 :=  (if_then_else_M (EQ_M (reveal x4) (i 2)) & (EQ_M (to x1) (i 2)) mx1rn2  (if_then_else_M (EQ_M (reveal x4) (i 2)) & (EQ_M (to x2) (i 2)) mx2rn2  (if_then_else_M (EQ_M (reveal x4) (i 2)) & (EQ_M (to x3) (i 2)) mx3rn2 (if_then_else_M (EQ_M (reveal x4) (i 3) ) O  (if_then_else_M ((EQ_M (to x4) (i 3)) & (EQ_M (act x4) new)) (grn 3) O) )))).

Definition qa201 := (if_then_else_M (EQ_M (reveal x4) (i 2) ) O (if_then_else_M (EQ_M (reveal x4) (i 3) ) O   (if_then_else_M (EQ_M (to x4) (i 2)) (grn 1)     (if_then_else_M (EQ_M (to x4) (i 3))  acc O)))).

Definition qa120 :=    (if_then_else_M (EQ_M (reveal x4) (i 1)) & (EQ_M (to x1) (i 1)) mx1rn1 (if_then_else_M (EQ_M (reveal x4) (i 1)) & (EQ_M (to x2) (i 1)) mx2rn1     (if_then_else_M (EQ_M (reveal x4) (i 3)) & (EQ_M (to x3) (i 3)) mx3rn1 (if_then_else_M (EQ_M (reveal x4) (i 3) ) O  (if_then_else_M ((EQ_M (to x4) (i 3)) & (EQ_M (act x4) new)) (grn 3) O) )))).

Definition qa111 := (if_then_else_M (EQ_M (reveal x4) (i 1)) & (EQ_M (to x1) (i 1)) mx1rn1 (if_then_else_M (EQ_M (reveal x4) (i 1)) & (EQ_M (to x2) (i 1)) mx2rn1 (if_then_else_M (EQ_M (reveal x4) (i 1)) & (EQ_M (to x3) (i 1)) mx3rn1    (if_then_else_M (EQ_M (reveal x4) (i 2)) & (EQ_M (to x1) (i 2)) mx1rn2 (if_then_else_M (EQ_M (reveal x4) (i 2)) & (EQ_M (to x2) (i 2)) mx2rn2 (if_then_else_M (EQ_M (reveal x4) (i 2)) & (EQ_M (to x3) (i 2)) mx3rn2   (if_then_else_M (EQ_M (reveal x4) (i 3) ) O (if_then_else_M (EQ_M (to x4) (i 3)) (grn 3) O)))))))).


Definition qa102 := (if_then_else_M (EQ_M (reveal x4) (i 1)) & (EQ_M (to x1) (i 1)) mx1rn1 (if_then_else_M (EQ_M (reveal x4) (i 1)) & (EQ_M (to x2) (i 1)) mx2rn1 (if_then_else_M (EQ_M (reveal x4) (i 1)) & (EQ_M (to x3) (i 1)) mx3rn1 (if_then_else_M  (EQ_M (reveal x4) (i 3)) & (EQ_M (to x2) (i 3)) & (EQ_M (to x1) (i 3))& (notb (EQ_M (act x2) new)) & (EQ_M (act x1) new) mx2rn3 (if_then_else_M  (EQ_M (reveal x4) (i 3)) & (EQ_M (to x3) (i 3)) & (EQ_M (to x2) (i 3))& (notb (EQ_M (act x3) new)) & (EQ_M (act x2) new) mx3rn3  (if_then_else_M (EQ_M (to x4) (i 3)) (grn 3) O) ))))).

Definition qa021 := (if_then_else_M (EQ_M (reveal x4) (i 1) ) O (if_then_else_M (EQ_M (reveal x4) (i 3) ) O   (if_then_else_M (EQ_M (to x4) (i 1)) (grn 1)  (if_then_else_M (EQ_M (to x4) (i 3)) acc O )))).

Definition qa012 :=  (if_then_else_M (EQ_M (reveal x4) (i 2)) & (EQ_M (to x1) (i 2)) mx1rn2 (if_then_else_M (EQ_M (reveal x4) (i 2)) & (EQ_M (to x2) (i 2)) mx2rn2 (if_then_else_M (EQ_M (reveal x4) (i 1)) & (EQ_M (to x3) (i 2)) mx3rn2  (if_then_else_M  (EQ_M (reveal x4) (i 3)) & (EQ_M (to x2) (i 3)) & (EQ_M (to x1) (i 3))& (notb (EQ_M (act x2) new)) & (EQ_M (act x1) new) mx2rn3 (if_then_else_M  (EQ_M (reveal x4) (i 3)) & (EQ_M (to x3) (i 3)) & (EQ_M (to x1) (i 3))& (notb (EQ_M (act x3) new)) & (EQ_M (act x1) new) mx3rn3   (if_then_else_M (EQ_M (reveal x4) (i 1) ) O  (if_then_else_M (EQ_M (to x4) (i 1)) (grn 1) O))))))).

Definition qa003 := (if_then_else_M (EQ_M (reveal x4) (i 1) ) O (if_then_else_M (EQ_M (reveal x4) (i 2) ) O (if_then_else_M (EQ_M (to x4) (i 1)) (grn 1) (if_then_else_M (EQ_M (to x4) (i 2)) (grn 2) O)))).

(********************************************************************************************)
(*******************************************************************************************)

Definition qa200_s := (if_then_else_M (EQ_M (reveal x3) (i 2) ) O (if_then_else_M (EQ_M (reveal x3) (i 3) ) O (if_then_else_M (EQ_M (to x3) (i 2))  qa210 (if_then_else_M (EQ_M (to x3 ) (i 3)) & (EQ_M (act x3) new) qa201 O)))).

Definition qa110_s := (if_then_else_M (EQ_M (reveal x3) (i 1)) & (EQ_M (to x1) (i 1))  qa210 (if_then_else_M (EQ_M (reveal x3) (i 1)) & (EQ_M (to x2) (i 1))  qa210 (if_then_else_M (EQ_M (reveal x3) (i 2)) & (EQ_M (to x1) (i 2))  qa120 (if_then_else_M (EQ_M (reveal x3) (i 2)) & (EQ_M (to x3) (i 2))  qa120 (if_then_else_M (EQ_M (reveal x3) (i 3) ) O
 (if_then_else_M ((EQ_M (to x3) (i 3)) & (EQ_M (act x3) new))  qa111  O)))))).

Definition qa101_s :=  (if_then_else_M (EQ_M (reveal x3) (i 1)) & (EQ_M (to x3) (i 1))  qa201 (if_then_else_M (EQ_M (reveal x3) (i 1)) & (EQ_M (to x3) (i 1))  qa201  (if_then_else_M (EQ_M (reveal x3) (i 2) ) O (if_then_else_M (EQ_M (reveal x3) (i 3) ) O (if_then_else_M (EQ_M (to x3) (i 2))  qa111
 (if_then_else_M (EQ_M (to x3) (i 3))  qa102  O)))))).
(*************qa010 -> qbar, qa020, qa110, qa011*****************************)

Definition qa020_s:= (if_then_else_M (EQ_M (reveal x3) (i 1) ) O (if_then_else_M (EQ_M (reveal x3) (i 3) ) O (if_then_else_M (EQ_M (to x3) (i 1))  qa120
 (if_then_else_M ((EQ_M (to x3) (i 3)) & (EQ_M (act x3) new))  qa021  O)))).

Definition qa011_s := (if_then_else_M (EQ_M (reveal x3) (i 2)) & (EQ_M (to x1) (i 2)) qa021  (if_then_else_M (EQ_M (reveal x3) (i 2)) & (EQ_M (to x2) (i 2)) qa021
 (if_then_else_M (EQ_M (reveal x3) (i 1) ) O (if_then_else_M (EQ_M (reveal x3) (i 3) ) O (if_then_else_M (EQ_M (to x3) (i 1)) qa111
 (if_then_else_M (EQ_M (to x3) (i 3)) qa012  O)))))).
(************qa001 -> qabar, qa101, qa011, qa002*****************************)

Definition qa002_s:= (if_then_else_M  (EQ_M (reveal x3) (i 3)) & (EQ_M (to x2) (i 3)) & (EQ_M (to x1) (i 3))& (notb (EQ_M (act x2) new)) & (EQ_M (act x1) new) qa003 (if_then_else_M (EQ_M (reveal x3) (i 1) ) O (if_then_else_M (EQ_M (reveal x3) (i 2) ) O (if_then_else_M (EQ_M (to x3) (i 1)) qa102
 (if_then_else_M (EQ_M (to x3) (i 2) ) qa012  O))))).


(***********************************************************)
 
Definition qa100_ss := (if_then_else_M (EQ_M (reveal x2) (i 1)) & (EQ_M (to x1) (i 1)) qa200_s (if_then_else_M (EQ_M (reveal x2) (i 2) ) O (if_then_else_M (EQ_M (reveal x2) (i 3) ) O (if_then_else_M (EQ_M (to x2) (i 2)) qa110_s  (if_then_else_M (EQ_M (to x2 ) (i 3)) & (EQ_M (act x2) new) qa101_s  O))))).


Definition qa010_ss := (if_then_else_M (EQ_M (reveal x2) (i 2)) & (EQ_M (to x1) (i 2)) qa020_s (if_then_else_M (EQ_M (reveal x2) (i 1) ) O  (if_then_else_M (EQ_M (reveal x2) (i 3) ) O  (if_then_else_M (EQ_M (to x2) (i 1)) qa110_s  (if_then_else_M (EQ_M (to x2 ) (i 3)) & (EQ_M (act x2) new) qa011_s O))))).

Definition qa001_ss:=  (if_then_else_M (EQ_M (reveal x2) (i 1) ) O (if_then_else_M (EQ_M (reveal x2) (i 2) ) O (if_then_else_M (EQ_M (reveal x2) (i 3) ) O (if_then_else_M (EQ_M (to x2) (i 1)) qa101_s (if_then_else_M (EQ_M (to x2) (i 2)) qa011_s (if_then_else_M (EQ_M (to x2) (i 3)) qa002_s  O) ) )))).


Definition t24 :=  msg (if_then_else_M (EQ_M (reveal x1) (i 1) ) O (if_then_else_M (EQ_M (reveal x1) (i 2) ) O (if_then_else_M (EQ_M (reveal x1) (i 3) ) O (if_then_else_M (EQ_M (to x1) (i 1)) qa100_ss (if_then_else_M (EQ_M (to x1) (i 2)) qa010_ss (if_then_else_M ((EQ_M (to x1) (i 3)) & (EQ_M (act x1) new)) qa001_ss  O) ) )))).
Definition phi4:= phi3 ++ [t24].

(*******************************************phi5****************************************************************)
(***************************************************************************************************************)


Definition mphi4 := (conv_mylist_listm phi4).
Definition x5 := (f mphi4).
Definition mx4rn4 := (exp (G 0) (m x4) (r 4)).
Definition mx4rn3 := (exp (G 0) (m x4) (r 3)).

Definition qa220:= (if_then_else_M (EQ_M (reveal x5) (i 3) ) O  (if_then_else_M ((EQ_M (to x5) (i 3)) & (EQ_M (act x5) new)) (grn 3) O) ).

(***************resume here**********************)
(************************)


Definition qa211:= (if_then_else_M (tta1 x5 x1 2) mx1rn1  (if_then_else_M (tta1 x5 x2 2) mx2rn2   (if_then_else_M (tta1 x5 x3 2) mx3rn3  (if_then_else_M (tta1 x5 x4 2) mx4rn4 (if_then_else_M (EQ_M (reveal x5) (i 3) ) O   (if_then_else_M (EQ_M (to x5) (i 3)) acc O)))))).


Definition qa202 := (if_then_else_M (tta2 x5 x2 x1 3) mx2rn1  (if_then_else_M (tta2 x5 x3 x1 3) mx3rn1  (if_then_else_M (tta2 x5 x3 x2 3) mx3rn2 (if_then_else_M (tta2 x5 x4 x3 3) mx4rn3 (if_then_else_M (EQ_M (reveal x5) (i 2) ) O (if_then_else_M (EQ_M (to x5) (i 2)) (grn 29) O) ))))).
Definition qa121 := (if_then_else_M (tta1 x5 x1 2) mx1rn1  (if_then_else_M (tta1 x5 x2 2) mx2rn2   (if_then_else_M (tta1 x5 x3 2) mx3rn3  (if_then_else_M (tta1 x5 x4 2) mx4rn4 (if_then_else_M (EQ_M (reveal x5) (i 3) ) O  (if_then_else_M (EQ_M (to x5) (i 2)) acc O)))))).

Definition qa112:= (if_then_else_M (tta1 x5 x1 1) mx1rn1  (if_then_else_M (tta1 x5 x2 1) mx2rn2   (if_then_else_M (tta1 x5 x3 1) mx3rn3  (if_then_else_M (tta1 x5 x4 1) mx4rn4 (if_then_else_M (tta1 x5 x1 2) mx1rn1  (if_then_else_M (tta1 x5 x2 2) mx2rn2   (if_then_else_M (tta1 x5 x3 2) mx3rn3  (if_then_else_M (tta1 x5 x4 2) mx4rn4  (if_then_else_M (tta2 x5 x2 x1 3) mx2rn1  (if_then_else_M (tta2 x5 x3 x1 3) mx3rn1  (if_then_else_M (tta2 x5 x3 x2 3) mx3rn2 (if_then_else_M (tta2 x5 x4 x3 3) mx4rn3 O)))))))))))).

Definition qa103 := (if_then_else_M (tta1 x5 x1 1) mx1rn1  (if_then_else_M (tta1 x5 x2 1) mx2rn2   (if_then_else_M (tta1 x5 x3 1) mx3rn3  (if_then_else_M (tta1 x5 x4 1) mx4rn4   (if_then_else_M (EQ_M (reveal x5) (i 2) ) O (if_then_else_M (EQ_M (to x5) (i 2)) (grn 30) O)))))).
Definition qa022 :=  (if_then_else_M (tta2 x5 x2 x1 3) mx2rn1  (if_then_else_M (tta2 x5 x3 x1 3) mx3rn1  (if_then_else_M (tta2 x5 x3 x2 3) mx3rn2 (if_then_else_M (tta2 x5 x4 x3 3) mx4rn3 (if_then_else_M (EQ_M (reveal x5) (i 1) ) O (if_then_else_M (EQ_M (to x5) (i 1)) (grn 31) O) ))))).
Definition qa013 :=  (if_then_else_M (tta1 x5 x1 1) mx1rn1  (if_then_else_M (tta1 x5 x2 1) mx2rn2   (if_then_else_M (tta1 x5 x3 1) mx3rn3  (if_then_else_M (tta1 x5 x4 1) mx4rn4   (if_then_else_M (EQ_M (reveal x5) (i 1) ) O  (if_then_else_M (EQ_M (reveal x5) (i 2) ) O (if_then_else_M (EQ_M (to x5) (i 1)) (grn 32) O))))))).

(*******************************************************************************************************************)
(********************************************************************************************************************)
Definition qa210_s :=  (if_then_else_M (tta1 x4 x1 2) qa220  (if_then_else_M (tta1 x4 x2 2) qa220   (if_then_else_M (tta1 x4 x2 2) qa220 (if_then_else_M (EQ_M (reveal x4) (i 3) ) O  (if_then_else_M ((EQ_M (to x4) (i 3)) & (EQ_M (act x4) new)) qa211 O) )))).

Definition  qa201_s := (if_then_else_M (EQ_M (reveal x4) (i 2) ) O (if_then_else_M (EQ_M (reveal x4) (i 3) ) O   (if_then_else_M (EQ_M (to x4) (i 2))  qa211    (if_then_else_M (EQ_M (to x4) (i 3))  qa202   O)))).

Definition qa120_s :=   (if_then_else_M (tta1 x4 x1 1) qa220  (if_then_else_M (tta1 x4 x2 1) qa220  (if_then_else_M ((EQ_M (to x4) (i 3)) & (EQ_M (act x4) new)) qa121 O) )).

Definition qa111_s := (if_then_else_M (tta1 x4 x1 1) qa211  (if_then_else_M (tta1 x4 x2 1) qa211  (if_then_else_M (tta1 x4 x3 1)  qa211 (if_then_else_M (tta1 x4 x1 2)  qa211  (if_then_else_M (tta1 x4 x2 2) qa121  (if_then_else_M (tta1 x4 x3 2) qa121  (if_then_else_M (EQ_M (reveal x4) (i 3) ) O (if_then_else_M (EQ_M (to x4) (i 3)) qa112 O)))))))).

Definition qa102_s :=  (if_then_else_M (tta1 x4 x1 1) qa202  (if_then_else_M (tta1 x4 x2 1) qa202  (if_then_else_M (tta1 x4 x3 1) qa202 (if_then_else_M (tta2 x4 x2 x1 3) qa103  (if_then_else_M (tta2 x4 x3 x1 3) qa103  (if_then_else_M (tta2 x4 x3 x2 3) qa103 (if_then_else_M (EQ_M (to x4) (i 2)) qa112 O) )))))).

Definition qa021_s := (if_then_else_M (EQ_M (reveal x4) (i 1) ) O (if_then_else_M (EQ_M (reveal x4) (i 3) ) O   (if_then_else_M (EQ_M (to x4) (i 1)) qa121 (if_then_else_M (EQ_M (to x4) (i 3)) qa022 O )))).

Definition qa012_s :=  (if_then_else_M (tta1 x4 x1 2) qa022  (if_then_else_M (tta1 x4 x2 2) qa022  (if_then_else_M (tta1 x4 x3 2) qa022 (if_then_else_M (tta2 x4 x2 x1 3) qa013  (if_then_else_M (tta2 x4 x3 x1 3)  qa013  (if_then_else_M (tta2 x4 x3 x2 3)  qa013 (if_then_else_M (EQ_M (reveal x4) (i 1) ) O  (if_then_else_M (EQ_M (to x4) (i 1)) qa112 O)))))))).

Definition qa003_s := (if_then_else_M (EQ_M (reveal x4) (i 1) ) O (if_then_else_M (EQ_M (reveal x4) (i 2) ) O (if_then_else_M (EQ_M (to x4) (i 1)) qa103 (if_then_else_M (EQ_M (to x4) (i 2)) qa013 O)))).

(********************************************************************************************)
(*******************************************************************************************)

Definition qa200_ss := (if_then_else_M (EQ_M (reveal x3) (i 2) ) O (if_then_else_M (EQ_M (reveal x3) (i 3) ) O (if_then_else_M (EQ_M (to x3) (i 2)) qa210_s  (if_then_else_M (EQ_M (to x3 ) (i 3)) & (EQ_M (act x3) new) qa201_s O)))).
Definition qa110_ss := (if_then_else_M (tta1 x3 x1 1) qa210_s (if_then_else_M (tta1 x3 x2 1) qa210_s 
 (if_then_else_M (tta1 x3 x1 2) qa210_s (if_then_else_M (tta1 x3 x2 2) qa210_s 
 (if_then_else_M ((EQ_M (to x3) (i 3)) & (EQ_M (act x3) new)) qa111_s  O))))).

Definition qa101_ss := (if_then_else_M (tta1 x3 x1 1) qa201_s (if_then_else_M (tta1 x3 x2 1) qa201_s  (if_then_else_M (EQ_M (reveal x3) (i 2) ) O (if_then_else_M (EQ_M (reveal x3) (i 3) ) O (if_then_else_M (EQ_M (to x3) (i 2)) qa111_s
 (if_then_else_M (EQ_M (to x3) (i 3)) qa102_s  O)))))).
(*************qa010 -> qbar, qa020, qa110, qa011*****************************)

Definition qa020_ss:= (if_then_else_M (EQ_M (reveal x3) (i 1) ) O (if_then_else_M (EQ_M (reveal x3) (i 3) ) O (if_then_else_M (EQ_M (to x3) (i 1)) qa120_s
 (if_then_else_M ((EQ_M (to x3) (i 3)) & (EQ_M (act x3) new)) qa021_s  O)))).

Definition qa011_ss := (if_then_else_M (tta1 x3 x1 2) qa021_s  (if_then_else_M (tta1 x3 x2 2) qa021_s 
 (if_then_else_M (EQ_M (reveal x3) (i 1) ) O (if_then_else_M (EQ_M (reveal x3) (i 3) ) O (if_then_else_M (EQ_M (to x3) (i 1)) qa111_s
 (if_then_else_M (EQ_M (to x3) (i 3)) qa012_s  O)))))).

(************qa001 -> qabar, qa101, qa011, qa002*****************************)

Definition qa002_ss:= (if_then_else_M (tta2 x3 x2 x1 3) qa003_s (if_then_else_M (EQ_M (reveal x3) (i 1) ) O (if_then_else_M (EQ_M (reveal x3) (i 2) ) O (if_then_else_M (EQ_M (to x3) (i 1)) qa102_s
 (if_then_else_M (EQ_M (to x3) (i 2) ) qa012_s  O))))).




(***********************************************************)

Definition qa100_sss := (if_then_else_M (tta1 x2 x1 1) qa200_ss (if_then_else_M (EQ_M (reveal x2) (i 2) ) O (if_then_else_M (EQ_M (reveal x2) (i 3) ) O (if_then_else_M (EQ_M (to x2) (i 2)) qa110_ss  (if_then_else_M (EQ_M (to x2 ) (i 3)) & (EQ_M (act x2) new) qa101_ss O))))).


Definition qa010_sss := (if_then_else_M (tta1 x2 x1 2) qa020_ss  (if_then_else_M (EQ_M (reveal x2) (i 1) ) O (if_then_else_M (EQ_M (reveal x2) (i 2) ) O (if_then_else_M (EQ_M (reveal x2) (i 3) ) O  (if_then_else_M (EQ_M (to x2) (i 1)) qa110_ss  (if_then_else_M (EQ_M (to x2 ) (i 3)) & (EQ_M (act x2) new) qa011_ss O)))))).

Definition qa001_sss :=  (if_then_else_M (EQ_M (reveal x2) (i 1) ) O (if_then_else_M (EQ_M (reveal x2) (i 2) ) O (if_then_else_M (EQ_M (reveal x2) (i 3) ) O (if_then_else_M (EQ_M (to x2) (i 1))  qa101_ss  (if_then_else_M (EQ_M (to x2) (i 2))  qa011_ss (if_then_else_M (EQ_M (to x2) (i 3))  qa002_ss  O) ) )))).


Definition t16 :=  msg (if_then_else_M (EQ_M (reveal x1) (i 1) ) O (if_then_else_M (EQ_M (reveal x1) (i 2) ) O (if_then_else_M (EQ_M (reveal x1) (i 3) ) O (if_then_else_M (EQ_M (to x1) (i 1)) qa100_sss (if_then_else_M (EQ_M (to x1) (i 2)) qa010_sss (if_then_else_M ((EQ_M (to x1) (i 3)) & (EQ_M (act x1) new)) qa001_sss  O) ) )))).
Definition phi5:= phi4 ++ [t16].

(*******************************************phi6****************************************************************)
(***************************************************************************************************************)


Definition mphi5 := (conv_mylist_listm phi5).
Definition x6 := (f mphi5).
Definition qa221 :=  (if_then_else_M (EQ_M (reveal x6) (i 3) ) O  (if_then_else_M (EQ_M (to x6) (i 3)) acc O) ).
Definition qa212 :=(if_then_else_M (tta1 x6 x2 2) mx2rn2   (if_then_else_M (tta1 x6 x3 2) mx3rn3  (if_then_else_M (tta1 x6 x4 2) mx4rn4  (if_then_else_M (tta2 x6 x2 x1 3) mx2rn1  (if_then_else_M (tta2 x6 x3 x1 3) mx3rn1  (if_then_else_M (tta2 x6 x3 x2 3) mx3rn2 (if_then_else_M (tta2 x6 x4 x3 3) mx4rn3 O))))))).

Definition qa203:=  (if_then_else_M (EQ_M (reveal x6) (i 2) ) O  (if_then_else_M (EQ_M (to x6) (i 3)) (grn 33) O) ).
(*
Definition qa123 := (if_then_else_M (tta1 x6 x2 1) mx2rn2   (if_then_else_M (tta1 x6 x3 1) mx3rn3  (if_then_else_M (tta1 x6 x4 1) mx4rn4  (if_then_else_M (EQ_M (to x6) (i 1)) (grn 34) O)))). *)
Definition qa122 := (if_then_else_M (tta1 x6 x2 1) mx2rn2   (if_then_else_M (tta1 x6 x3 1) mx3rn3  (if_then_else_M (tta1 x6 x4 1) mx4rn4  (if_then_else_M (tta2 x6 x2 x1 1) mx2rn1  (if_then_else_M (tta2 x6 x3 x1 3) mx3rn1  (if_then_else_M (tta2 x6 x3 x2 3) mx3rn2 (if_then_else_M (tta2 x6 x4 x3 3) mx4rn3 O))))))).
Definition qa113 :=(if_then_else_M (tta1 x6 x2 1) mx2rn2   (if_then_else_M (tta1 x6 x3 1) mx3rn3  (if_then_else_M (tta1 x6 x4 1) mx4rn4  (if_then_else_M (tta2 x6 x2 x1 1) mx2rn1  (if_then_else_M (tta1 x6 x2 2) mx2rn2   (if_then_else_M (tta1 x6 x3 2) mx3rn3  (if_then_else_M (tta1 x6 x4 2) mx4rn4  (if_then_else_M (tta2 x6 x2 x1 2) mx2rn1 O)))))))). 
Definition qa023 :=  (if_then_else_M (EQ_M (reveal x6) (i 1) ) O  (if_then_else_M (EQ_M (to x6) (i 1)) (grn 34) O) ).

(*********************************************************************)

Definition qa220_s := (if_then_else_M (EQ_M (reveal x5) (i 3) ) O  (if_then_else_M ((EQ_M (to x5) (i 3)) & (EQ_M (act x5) new)) qa221 O) ).
Definition qa211_s := (if_then_else_M (tta1 x5 x1 2) qa221  (if_then_else_M (tta1 x5 x2 2) qa221   (if_then_else_M (tta1 x5 x3 2) qa221  (if_then_else_M (tta1 x5 x4 2) qa221 (if_then_else_M (EQ_M (reveal x5) (i 3) ) O   (if_then_else_M (EQ_M (to x5) (i 3)) qa212 O)))))).


Definition qa202_s := (if_then_else_M (tta2 x5 x2 x1 3) qa203  (if_then_else_M (tta2 x5 x3 x1 3) qa203  (if_then_else_M (tta2 x5 x3 x2 3) qa203 (if_then_else_M (tta2 x5 x4 x3 3) qa203 (if_then_else_M (EQ_M (reveal x5) (i 2) ) O (if_then_else_M (EQ_M (to x5) (i 2)) qa212 O) ))))).

Definition qa121_s := (if_then_else_M (tta1 x5 x1 1) qa221  (if_then_else_M (tta1 x5 x2 1) qa221  (if_then_else_M (tta1 x5 x3 1) qa221 (if_then_else_M (tta1 x5 x4 1) qa221 (if_then_else_M (EQ_M (reveal x5) (i 3) ) O  (if_then_else_M (EQ_M (to x5) (i 2)) qa122 O)))))).

Definition qa112_s := (if_then_else_M (tta1 x5 x1 1) qa212  (if_then_else_M (tta1 x5 x2 1) qa212  (if_then_else_M (tta1 x5 x3 1) qa212  (if_then_else_M (tta1 x5 x4 1) qa212 (if_then_else_M (tta1 x5 x1 2) qa122 (if_then_else_M (tta1 x5 x2 2) qa122   (if_then_else_M (tta1 x5 x3 2) qa122  (if_then_else_M (tta1 x5 x4 2) qa122  (if_then_else_M (tta2 x5 x2 x1 3) qa122  (if_then_else_M (tta2 x5 x3 x1 3) qa122  (if_then_else_M (tta2 x5 x3 x2 3) qa122 (if_then_else_M (tta2 x5 x4 x3 3) qa122 O)))))))))))).

Definition qa103_s := (if_then_else_M (tta1 x5 x1 1) qa203  (if_then_else_M (tta1 x5 x2 1) qa203  (if_then_else_M (tta1 x5 x3 1) qa203  (if_then_else_M (tta1 x5 x4 1) qa203   (if_then_else_M (EQ_M (reveal x5) (i 2) ) O (if_then_else_M (EQ_M (to x5) (i 2)) qa113 O)))))).
Definition qa022_s :=  (if_then_else_M (tta2 x5 x2 x1 3) qa023  (if_then_else_M (tta2 x5 x3 x1 3) qa023 (if_then_else_M (tta2 x5 x3 x2 3) qa023 (if_then_else_M (tta2 x5 x4 x3 3) qa023 (if_then_else_M (EQ_M (reveal x5) (i 1) ) O (if_then_else_M (EQ_M (to x5) (i 1)) qa122 O) ))))).
Definition qa013_s :=  (if_then_else_M (tta1 x5 x1 2) qa023  (if_then_else_M (tta1 x5 x2 2) qa023   (if_then_else_M (tta1 x5 x3 2) qa023  (if_then_else_M (tta1 x5 x4 2) qa023   (if_then_else_M (EQ_M (reveal x5) (i 1) ) O  (if_then_else_M (EQ_M (reveal x5) (i 2) ) O (if_then_else_M (EQ_M (to x5) (i 1)) qa113 O ))))))).

(*******************************************************************************************************************)
(********************************************************************************************************************)
Definition qa210_ss :=  (if_then_else_M (tta1 x4 x1 2) qa220_s  (if_then_else_M (tta1 x4 x2 2) qa220_s   (if_then_else_M (tta1 x4 x2 2) qa220_s (if_then_else_M (EQ_M (reveal x4) (i 3) ) O  (if_then_else_M ((EQ_M (to x4) (i 3)) & (EQ_M (act x4) new)) qa211_s O) )))).

Definition  qa201_ss := (if_then_else_M (EQ_M (reveal x4) (i 2) ) O (if_then_else_M (EQ_M (reveal x4) (i 3) ) O   (if_then_else_M (EQ_M (to x4) (i 2))  qa211_s    (if_then_else_M (EQ_M (to x4) (i 3))  qa202_s   O)))).

Definition qa120_ss :=   (if_then_else_M (tta1 x4 x1 1) qa220_s  (if_then_else_M (tta1 x4 x2 1) qa220_s  (if_then_else_M ((EQ_M (to x4) (i 3)) & (EQ_M (act x4) new)) qa121_s O) )).

Definition qa111_ss := (if_then_else_M (tta1 x4 x1 1) qa211_s  (if_then_else_M (tta1 x4 x2 1) qa211_s  (if_then_else_M (tta1 x4 x3 1)  qa211_s (if_then_else_M (tta1 x4 x1 2)  qa211_s  (if_then_else_M (tta1 x4 x2 2) qa121_s  (if_then_else_M (tta1 x4 x3 2) qa121_s  (if_then_else_M (EQ_M (reveal x4) (i 3) ) O (if_then_else_M (EQ_M (to x4) (i 3)) qa112_s O)))))))).

Definition qa102_ss :=  (if_then_else_M (tta1 x4 x1 1) qa202_s  (if_then_else_M (tta1 x4 x2 1) qa202_s  (if_then_else_M (tta1 x4 x3 1) qa202_s (if_then_else_M (tta2 x4 x2 x1 3) qa103_s  (if_then_else_M (tta2 x4 x3 x1 3) qa103_s  (if_then_else_M (tta2 x4 x3 x2 3) qa103_s (if_then_else_M (EQ_M (to x4) (i 2)) qa112_s O) )))))).

Definition qa021_ss := (if_then_else_M (EQ_M (reveal x4) (i 1) ) O (if_then_else_M (EQ_M (reveal x4) (i 3) ) O   (if_then_else_M (EQ_M (to x4) (i 1)) qa121_s (if_then_else_M (EQ_M (to x4) (i 3)) qa022_s O )))).

Definition qa012_ss :=  (if_then_else_M (tta1 x4 x1 2) qa022_s  (if_then_else_M (tta1 x4 x2 2) qa022_s  (if_then_else_M (tta1 x4 x3 2) qa022_s (if_then_else_M (tta2 x4 x2 x1 3) qa013_s  (if_then_else_M (tta2 x4 x3 x1 3)  qa013_s  (if_then_else_M (tta2 x4 x3 x2 3)  qa013_s (if_then_else_M (EQ_M (reveal x4) (i 1) ) O  (if_then_else_M (EQ_M (to x4) (i 1)) qa112_s O)))))))).

Definition qa003_ss := (if_then_else_M (EQ_M (reveal x4) (i 1) ) O (if_then_else_M (EQ_M (reveal x4) (i 2) ) O (if_then_else_M (EQ_M (to x4) (i 1)) qa103_s (if_then_else_M (EQ_M (to x4) (i 2)) qa013_s O)))).

(********************************************************************************************)
(*******************************************************************************************)

Definition qa200_sss := (if_then_else_M (EQ_M (reveal x3) (i 2) ) O (if_then_else_M (EQ_M (reveal x3) (i 3) ) O (if_then_else_M (EQ_M (to x3) (i 2)) qa210_ss  (if_then_else_M (EQ_M (to x3 ) (i 3)) & (EQ_M (act x3) new) qa201_ss O)))).
Definition qa110_sss := (if_then_else_M (tta1 x3 x1 1) qa210_ss (if_then_else_M (tta1 x3 x2 1) qa210_ss 
 (if_then_else_M (tta1 x3 x1 2) qa210_ss (if_then_else_M (tta1 x3 x2 2) qa210_ss 
 (if_then_else_M ((EQ_M (to x3) (i 3)) & (EQ_M (act x3) new)) qa111_ss  O))))).

Definition qa101_sss := (if_then_else_M (tta1 x3 x1 1) qa201_s (if_then_else_M (tta1 x3 x2 1) qa201_s  (if_then_else_M (EQ_M (reveal x3) (i 2) ) O (if_then_else_M (EQ_M (reveal x3) (i 3) ) O (if_then_else_M (EQ_M (to x3) (i 2)) qa111_s
 (if_then_else_M (EQ_M (to x3) (i 3)) qa102_s  O)))))).
(*************qa010 -> qbar, qa020, qa110, qa011*****************************)

Definition qa020_sss:= (if_then_else_M (EQ_M (reveal x3) (i 1) ) O (if_then_else_M (EQ_M (reveal x3) (i 3) ) O (if_then_else_M (EQ_M (to x3) (i 1)) qa120_ss
 (if_then_else_M ((EQ_M (to x3) (i 3)) & (EQ_M (act x3) new)) qa021_ss  O)))).

Definition qa011_sss := (if_then_else_M (tta1 x3 x1 2) qa021_ss  (if_then_else_M (tta1 x3 x2 2) qa021_ss 
 (if_then_else_M (EQ_M (reveal x3) (i 1) ) O (if_then_else_M (EQ_M (reveal x3) (i 3) ) O (if_then_else_M (EQ_M (to x3) (i 1)) qa111_ss
 (if_then_else_M (EQ_M (to x3) (i 3)) qa012_ss  O)))))).

(************qa001 -> qabar, qa101, qa011, qa002*****************************)

Definition qa002_sss := (if_then_else_M (tta2 x3 x2 x1 3) qa003_ss (if_then_else_M (EQ_M (reveal x3) (i 1) ) O (if_then_else_M (EQ_M (reveal x3) (i 2) ) O (if_then_else_M (EQ_M (to x3) (i 1)) qa102_ss
 (if_then_else_M (EQ_M (to x3) (i 2) ) qa012_ss  O))))).




(***********************************************************)

Definition qa100_ssss := (if_then_else_M (tta1 x2 x1 1) qa200_sss (if_then_else_M (EQ_M (reveal x2) (i 2) ) O (if_then_else_M (EQ_M (reveal x2) (i 3) ) O (if_then_else_M (EQ_M (to x2) (i 2)) qa110_sss  (if_then_else_M (EQ_M (to x2 ) (i 3)) & (EQ_M (act x2) new) qa101_sss O))))).


Definition qa010_ssss := (if_then_else_M (tta1 x2 x1 2) qa020_sss  (if_then_else_M (EQ_M (reveal x2) (i 1) ) O (if_then_else_M (EQ_M (reveal x2) (i 2) ) O (if_then_else_M (EQ_M (reveal x2) (i 3) ) O  (if_then_else_M (EQ_M (to x2) (i 1)) qa110_sss  (if_then_else_M (EQ_M (to x2 ) (i 3)) & (EQ_M (act x2) new) qa011_sss O)))))).

Definition qa001_ssss :=  (if_then_else_M (EQ_M (reveal x2) (i 1) ) O (if_then_else_M (EQ_M (reveal x2) (i 2) ) O (if_then_else_M (EQ_M (reveal x2) (i 3) ) O (if_then_else_M (EQ_M (to x2) (i 1))  qa101_sss  (if_then_else_M (EQ_M (to x2) (i 2))  qa011_sss (if_then_else_M (EQ_M (to x2) (i 3))  qa002_sss  O) ) )))).


Definition t17 :=  msg (if_then_else_M (EQ_M (reveal x1) (i 1) ) O (if_then_else_M (EQ_M (reveal x1) (i 2) ) O (if_then_else_M (EQ_M (reveal x1) (i 3) ) O (if_then_else_M (EQ_M (to x1) (i 1)) qa100_ssss (if_then_else_M (EQ_M (to x1) (i 2)) qa010_ssss (if_then_else_M ((EQ_M (to x1) (i 3)) & (EQ_M (act x1) new)) qa001_ssss  O) ) )))).
Definition phi6:= phi5 ++ [t17].




(******************************phi7*********************************************)
(****************************************************************************)





Definition mphi6 := (conv_mylist_listm phi6).
Definition x7 := (f mphi6).


Definition qa222 := (if_then_else_M (tta2 x6 x2 x1 3) mx2rn1  (if_then_else_M (tta2 x6 x3 x1 3) mx3rn1  (if_then_else_M (tta2 x6 x3 x2 3) mx3rn2 (if_then_else_M (tta2 x6 x4 x3 3) mx4rn3 O)))).
Definition qa213:= (if_then_else_M (tta1 x5 x1 2) mx1rn1  (if_then_else_M (tta1 x5 x2 2) mx2rn2   (if_then_else_M (tta1 x5 x3 2) mx3rn3  (if_then_else_M (tta1 x5 x4 2) mx4rn4 O)))).


Definition qa123 :=  (if_then_else_M (tta1 x5 x1 1) mx1rn1  (if_then_else_M (tta1 x5 x2 1) mx2rn2   (if_then_else_M (tta1 x5 x3 1) mx3rn3  (if_then_else_M (tta1 x5 x4 1) mx4rn4 O)))).

(*************************************************************************************************)
(************************************************************************************************)



Definition qa221_s :=  (if_then_else_M (EQ_M (reveal x6) (i 3) ) O  (if_then_else_M (EQ_M (to x6) (i 3)) qa222 O) ).
Definition qa212_s :=(if_then_else_M (tta1 x6 x2 2) qa222   (if_then_else_M (tta1 x6 x3 2) qa222  (if_then_else_M (tta1 x6 x4 2) qa222  (if_then_else_M (tta2 x6 x2 x1 3) qa213  (if_then_else_M (tta2 x6 x3 x1 3) qa213  (if_then_else_M (tta2 x6 x3 x2 3) qa213 (if_then_else_M (tta2 x6 x4 x3 3) qa213 O))))))).

Definition qa203_s :=  (if_then_else_M (EQ_M (reveal x6) (i 2) ) O  (if_then_else_M (EQ_M (to x6) (i 1)) qa213  O) ).

Definition qa122_s := (if_then_else_M (tta1 x6 x2 1) qa222   (if_then_else_M (tta1 x6 x3 1) qa222  (if_then_else_M (tta1 x6 x4 1) qa222  (if_then_else_M (tta2 x6 x2 x1 1) qa222  (if_then_else_M (tta2 x6 x3 x1 3) qa123  (if_then_else_M (tta2 x6 x3 x2 3) qa123 (if_then_else_M (tta2 x6 x4 x3 3) qa123 O))))))).
Definition qa113_s :=(if_then_else_M (tta1 x6 x2 1) qa213   (if_then_else_M (tta1 x6 x3 1) qa213  (if_then_else_M (tta1 x6 x4 1) qa213 (if_then_else_M (tta2 x6 x2 x1 1) qa213  (if_then_else_M (tta1 x6 x2 2) qa123  (if_then_else_M (tta1 x6 x3 2) qa123 (if_then_else_M (tta1 x6 x4 2) qa123  (if_then_else_M (tta2 x6 x2 x1 2) qa123 O)))))))). 
Definition qa023_s :=  (if_then_else_M (EQ_M (reveal x6) (i 1) ) O  (if_then_else_M (EQ_M (to x6) (i 1)) qa123 O) ).

(*********************************************************************)

Definition qa220_ss := (if_then_else_M (EQ_M (reveal x5) (i 3) ) O  (if_then_else_M ((EQ_M (to x5) (i 3)) & (EQ_M (act x5) new)) qa221_s O) ).
Definition qa211_ss := (if_then_else_M (tta1 x5 x1 2) qa221_s  (if_then_else_M (tta1 x5 x2 2) qa221_s   (if_then_else_M (tta1 x5 x3 2) qa221_s  (if_then_else_M (tta1 x5 x4 2) qa221_s (if_then_else_M (EQ_M (reveal x5) (i 3) ) O   (if_then_else_M (EQ_M (to x5) (i 3)) qa212_s O)))))).


Definition qa202_ss := (if_then_else_M (tta2 x5 x2 x1 3) qa203_s  (if_then_else_M (tta2 x5 x3 x1 3) qa203_s  (if_then_else_M (tta2 x5 x3 x2 3) qa203_s (if_then_else_M (tta2 x5 x4 x3 3) qa203_s (if_then_else_M (EQ_M (reveal x5) (i 2) ) O (if_then_else_M (EQ_M (to x5) (i 2)) qa212_s O) ))))).

Definition qa121_ss := (if_then_else_M (tta1 x5 x1 1) qa221_s  (if_then_else_M (tta1 x5 x2 1) qa221_s  (if_then_else_M (tta1 x5 x3 1) qa221_s (if_then_else_M (tta1 x5 x4 1) qa221_s (if_then_else_M (EQ_M (reveal x5) (i 3) ) O  (if_then_else_M (EQ_M (to x5) (i 2)) qa122_s O)))))).

Definition qa112_ss := (if_then_else_M (tta1 x5 x1 1) qa212_s  (if_then_else_M (tta1 x5 x2 1) qa212_s  (if_then_else_M (tta1 x5 x3 1) qa212_s  (if_then_else_M (tta1 x5 x4 1) qa212_s (if_then_else_M (tta1 x5 x1 2) qa122_s (if_then_else_M (tta1 x5 x2 2) qa122_s   (if_then_else_M (tta1 x5 x3 2) qa122_s  (if_then_else_M (tta1 x5 x4 2) qa122_s  (if_then_else_M (tta2 x5 x2 x1 3) qa113_s  (if_then_else_M (tta2 x5 x3 x1 3) qa113_s  (if_then_else_M (tta2 x5 x3 x2 3) qa113_s (if_then_else_M (tta2 x5 x4 x3 3) qa113_s O)))))))))))).

Definition qa103_ss := (if_then_else_M (tta1 x5 x1 1) qa203_s  (if_then_else_M (tta1 x5 x2 1) qa203_s  (if_then_else_M (tta1 x5 x3 1) qa203_s  (if_then_else_M (tta1 x5 x4 1) qa203_s   (if_then_else_M (EQ_M (reveal x5) (i 2) ) O (if_then_else_M (EQ_M (to x5) (i 2)) qa113_s O)))))).
Definition qa022_ss :=  (if_then_else_M (tta2 x5 x2 x1 3) qa023_s  (if_then_else_M (tta2 x5 x3 x1 3) qa023_s (if_then_else_M (tta2 x5 x3 x2 3) qa023_s (if_then_else_M (tta2 x5 x4 x3 3) qa023_s (if_then_else_M (EQ_M (reveal x5) (i 1) ) O (if_then_else_M (EQ_M (to x5) (i 1)) qa122_s O) ))))).
Definition qa013_ss :=  (if_then_else_M (tta1 x5 x1 2) qa023_s  (if_then_else_M (tta1 x5 x2 2) qa023_s   (if_then_else_M (tta1 x5 x3 2) qa023_s  (if_then_else_M (tta1 x5 x4 2) qa023_s   (if_then_else_M (EQ_M (reveal x5) (i 1) ) O  (if_then_else_M (EQ_M (reveal x5) (i 2) ) O (if_then_else_M (EQ_M (to x5) (i 1)) qa113_s O ))))))).

(*******************************************************************************************************************)
(********************************************************************************************************************)
Definition qa210_sss :=  (if_then_else_M (tta1 x4 x1 2) qa220_ss  (if_then_else_M (tta1 x4 x2 2) qa220_ss   (if_then_else_M (tta1 x4 x2 2) qa220_ss (if_then_else_M (EQ_M (reveal x4) (i 3) ) O  (if_then_else_M ((EQ_M (to x4) (i 3)) & (EQ_M (act x4) new)) qa211_ss O) )))).

Definition  qa201_sss := (if_then_else_M (EQ_M (reveal x4) (i 2) ) O (if_then_else_M (EQ_M (reveal x4) (i 3) ) O   (if_then_else_M (EQ_M (to x4) (i 2))  qa211_ss    (if_then_else_M (EQ_M (to x4) (i 3))  qa202_ss   O)))).

Definition qa120_sss :=   (if_then_else_M (tta1 x4 x1 1) qa220_ss  (if_then_else_M (tta1 x4 x2 1) qa220_ss  (if_then_else_M ((EQ_M (to x4) (i 3)) & (EQ_M (act x4) new)) qa121_ss O) )).

Definition qa111_sss := (if_then_else_M (tta1 x4 x1 1) qa211_ss  (if_then_else_M (tta1 x4 x2 1) qa211_ss  (if_then_else_M (tta1 x4 x3 1)  qa211_ss (if_then_else_M (tta1 x4 x1 2)  qa211_ss  (if_then_else_M (tta1 x4 x2 2) qa121_ss  (if_then_else_M (tta1 x4 x3 2) qa121_ss  (if_then_else_M (EQ_M (reveal x4) (i 3) ) O (if_then_else_M (EQ_M (to x4) (i 3)) qa112_ss O)))))))).

Definition qa102_sss :=  (if_then_else_M (tta1 x4 x1 1) qa202_ss  (if_then_else_M (tta1 x4 x2 1) qa202_ss  (if_then_else_M (tta1 x4 x3 1) qa202_ss (if_then_else_M (tta2 x4 x2 x1 3) qa103_ss  (if_then_else_M (tta2 x4 x3 x1 3) qa103_ss  (if_then_else_M (tta2 x4 x3 x2 3) qa103_ss (if_then_else_M (EQ_M (to x4) (i 2)) qa112_ss O) )))))).

Definition qa021_sss := (if_then_else_M (EQ_M (reveal x4) (i 1) ) O (if_then_else_M (EQ_M (reveal x4) (i 3) ) O   (if_then_else_M (EQ_M (to x4) (i 1)) qa121_ss (if_then_else_M (EQ_M (to x4) (i 3)) qa022_ss O )))).

Definition qa012_sss :=  (if_then_else_M (tta1 x4 x1 2) qa022_ss  (if_then_else_M (tta1 x4 x2 2) qa022_ss  (if_then_else_M (tta1 x4 x3 2) qa022_ss (if_then_else_M (tta2 x4 x2 x1 3) qa013_ss  (if_then_else_M (tta2 x4 x3 x1 3)  qa013_s  (if_then_else_M (tta2 x4 x3 x2 3)  qa013_ss (if_then_else_M (EQ_M (reveal x4) (i 1) ) O  (if_then_else_M (EQ_M (to x4) (i 1)) qa112_ss O)))))))).

Definition qa003_sss := (if_then_else_M (EQ_M (reveal x4) (i 1) ) O (if_then_else_M (EQ_M (reveal x4) (i 2) ) O (if_then_else_M (EQ_M (to x4) (i 1)) qa103_ss (if_then_else_M (EQ_M (to x4) (i 2)) qa013_ss O)))).

(********************************************************************************************)
(*******************************************************************************************)

Definition qa200_ssss := (if_then_else_M (EQ_M (reveal x3) (i 2) ) O (if_then_else_M (EQ_M (reveal x3) (i 3) ) O (if_then_else_M (EQ_M (to x3) (i 2)) qa210_sss  (if_then_else_M (EQ_M (to x3 ) (i 3)) & (EQ_M (act x3) new) qa201_sss O)))).
Definition qa110_ssss := (if_then_else_M (tta1 x3 x1 1) qa210_sss (if_then_else_M (tta1 x3 x2 1) qa210_sss 
 (if_then_else_M (tta1 x3 x1 2) qa210_sss (if_then_else_M (tta1 x3 x2 2) qa210_sss 
 (if_then_else_M ((EQ_M (to x3) (i 3)) & (EQ_M (act x3) new)) qa111_sss  O))))).

Definition qa101_ssss := (if_then_else_M (tta1 x3 x1 1) qa201_sss (if_then_else_M (tta1 x3 x2 1) qa201_sss  (if_then_else_M (EQ_M (reveal x3) (i 2) ) O (if_then_else_M (EQ_M (reveal x3) (i 3) ) O (if_then_else_M (EQ_M (to x3) (i 2)) qa111_sss
 (if_then_else_M (EQ_M (to x3) (i 3)) qa102_sss  O)))))).
(*************qa010 -> qbar, qa020, qa110, qa011*****************************)

Definition qa020_ssss:= (if_then_else_M (EQ_M (reveal x3) (i 1) ) O (if_then_else_M (EQ_M (reveal x3) (i 3) ) O (if_then_else_M (EQ_M (to x3) (i 1)) qa120_sss
 (if_then_else_M ((EQ_M (to x3) (i 3)) & (EQ_M (act x3) new)) qa021_sss  O)))).

Definition qa011_ssss := (if_then_else_M (tta1 x3 x1 2) qa021_sss  (if_then_else_M (tta1 x3 x2 2) qa021_sss 
 (if_then_else_M (EQ_M (reveal x3) (i 1) ) O (if_then_else_M (EQ_M (reveal x3) (i 3) ) O (if_then_else_M (EQ_M (to x3) (i 1)) qa111_sss
 (if_then_else_M (EQ_M (to x3) (i 3)) qa012_sss  O)))))).

(************qa001 -> qabar, qa101, qa011, qa002*****************************)

Definition qa002_ssss := (if_then_else_M (tta2 x3 x2 x1 3) qa003_sss (if_then_else_M (EQ_M (reveal x3) (i 1) ) O (if_then_else_M (EQ_M (reveal x3) (i 2) ) O (if_then_else_M (EQ_M (to x3) (i 1)) qa102_sss
 (if_then_else_M (EQ_M (to x3) (i 2) ) qa012_sss  O))))).




(***********************************************************)

Definition qa100_sssss := (if_then_else_M (tta1 x2 x1 1) qa200_ssss (if_then_else_M (EQ_M (reveal x2) (i 2) ) O (if_then_else_M (EQ_M (reveal x2) (i 3) ) O (if_then_else_M (EQ_M (to x2) (i 2)) qa110_ssss  (if_then_else_M (EQ_M (to x2 ) (i 3)) & (EQ_M (act x2) new) qa101_ssss O))))).


Definition qa010_sssss := (if_then_else_M (tta1 x2 x1 2) qa020_ssss  (if_then_else_M (EQ_M (reveal x2) (i 1) ) O (if_then_else_M (EQ_M (reveal x2) (i 2) ) O (if_then_else_M (EQ_M (reveal x2) (i 3) ) O  (if_then_else_M (EQ_M (to x2) (i 1)) qa110_ssss  (if_then_else_M (EQ_M (to x2 ) (i 3)) & (EQ_M (act x2) new) qa011_ssss O)))))).

Definition qa001_sssss :=  (if_then_else_M (EQ_M (reveal x2) (i 1) ) O (if_then_else_M (EQ_M (reveal x2) (i 2) ) O (if_then_else_M (EQ_M (reveal x2) (i 3) ) O (if_then_else_M (EQ_M (to x2) (i 1))  qa101_ssss  (if_then_else_M (EQ_M (to x2) (i 2))  qa011_ssss (if_then_else_M (EQ_M (to x2) (i 3))  qa002_ssss  O) ) )))).


Definition t18 :=  msg (if_then_else_M (EQ_M (reveal x1) (i 1) ) O (if_then_else_M (EQ_M (reveal x1) (i 2) ) O (if_then_else_M (EQ_M (reveal x1) (i 3) ) O (if_then_else_M (EQ_M (to x1) (i 1)) qa100_ssss (if_then_else_M (EQ_M (to x1) (i 2)) qa010_ssss (if_then_else_M ((EQ_M (to x1) (i 3)) & (EQ_M (act x1) new)) qa001_ssss  O) ) )))).
Definition phi7:= phi6 ++ [t18].


(*************************************Phi8*********************************************************)
(**********************************************************************************************)



Definition mphi7 := (conv_mylist_listm phi7).
Definition x8 := (f mphi7).


Definition qa223:= O.


(*****************************************************************************************)
Definition qa222_s := (if_then_else_M (tta2 x6 x2 x1 3) qa223  (if_then_else_M (tta2 x6 x3 x1 3) qa223 (if_then_else_M (tta2 x6 x3 x2 3) qa223 (if_then_else_M (tta2 x6 x4 x3 3) qa223 O)))).
Definition qa213_s := (if_then_else_M (tta1 x5 x1 2) qa223  (if_then_else_M (tta1 x5 x2 2) qa223  (if_then_else_M (tta1 x5 x3 2) qa223  (if_then_else_M (tta1 x5 x4 2) qa223 O)))).


Definition qa123_s :=  (if_then_else_M (tta1 x5 x1 1) qa223  (if_then_else_M (tta1 x5 x2 1) qa223  (if_then_else_M (tta1 x5 x3 1) qa223  (if_then_else_M (tta1 x5 x4 1) qa223 O)))).

(*************************************************************************************************)
(************************************************************************************************)



Definition qa221_ss :=  (if_then_else_M (EQ_M (reveal x6) (i 3) ) O  (if_then_else_M (EQ_M (to x6) (i 3)) qa222_s O) ).
Definition qa212_ss :=(if_then_else_M (tta1 x6 x2 2) qa222_s   (if_then_else_M (tta1 x6 x3 2) qa222  (if_then_else_M (tta1 x6 x4 2) qa222_s  (if_then_else_M (tta2 x6 x2 x1 3) qa213_s  (if_then_else_M (tta2 x6 x3 x1 3) qa213_s  (if_then_else_M (tta2 x6 x3 x2 3) qa213_s (if_then_else_M (tta2 x6 x4 x3 3) qa213_s O))))))).

Definition qa203_ss :=  (if_then_else_M (EQ_M (reveal x6) (i 2) ) O  (if_then_else_M (EQ_M (to x6) (i 1)) qa213_s  O) ).

Definition qa122_ss := (if_then_else_M (tta1 x6 x2 1) qa222_s   (if_then_else_M (tta1 x6 x3 1) qa222_s  (if_then_else_M (tta1 x6 x4 1) qa222_s  (if_then_else_M (tta2 x6 x2 x1 1) qa222_s  (if_then_else_M (tta2 x6 x3 x1 3) qa123_s  (if_then_else_M (tta2 x6 x3 x2 3) qa123_s (if_then_else_M (tta2 x6 x4 x3 3) qa123_s O))))))).
Definition qa113_ss :=(if_then_else_M (tta1 x6 x2 1) qa213_s   (if_then_else_M (tta1 x6 x3 1) qa213_s  (if_then_else_M (tta1 x6 x4 1) qa213_s (if_then_else_M (tta2 x6 x2 x1 1) qa213_s  (if_then_else_M (tta1 x6 x2 2) qa123_s  (if_then_else_M (tta1 x6 x3 2) qa123_s (if_then_else_M (tta1 x6 x4 2) qa123_s  (if_then_else_M (tta2 x6 x2 x1 2) qa123_s O)))))))). 
Definition qa023_ss :=  (if_then_else_M (EQ_M (reveal x6) (i 1) ) O  (if_then_else_M (EQ_M (to x6) (i 1)) qa123_s O) ).

(*********************************************************************)

Definition qa220_sss := (if_then_else_M (EQ_M (reveal x5) (i 3) ) O  (if_then_else_M ((EQ_M (to x5) (i 3)) & (EQ_M (act x5) new)) qa221_ss O) ).
Definition qa211_sss := (if_then_else_M (tta1 x5 x1 2) qa221_ss  (if_then_else_M (tta1 x5 x2 2) qa221_ss   (if_then_else_M (tta1 x5 x3 2) qa221_ss  (if_then_else_M (tta1 x5 x4 2) qa221_ss (if_then_else_M (EQ_M (reveal x5) (i 3) ) O   (if_then_else_M (EQ_M (to x5) (i 3)) qa212_ss O)))))).


Definition qa202_sss := (if_then_else_M (tta2 x5 x2 x1 3) qa203_ss  (if_then_else_M (tta2 x5 x3 x1 3) qa203_ss  (if_then_else_M (tta2 x5 x3 x2 3) qa203_ss (if_then_else_M (tta2 x5 x4 x3 3) qa203_ss (if_then_else_M (EQ_M (reveal x5) (i 2) ) O (if_then_else_M (EQ_M (to x5) (i 2)) qa212_ss O) ))))).

Definition qa121_sss := (if_then_else_M (tta1 x5 x1 1) qa221_ss  (if_then_else_M (tta1 x5 x2 1) qa221_ss  (if_then_else_M (tta1 x5 x3 1) qa221_ss (if_then_else_M (tta1 x5 x4 1) qa221_ss (if_then_else_M (EQ_M (reveal x5) (i 3) ) O  (if_then_else_M (EQ_M (to x5) (i 2)) qa122_ss O)))))).

Definition qa112_sss := (if_then_else_M (tta1 x5 x1 1) qa212_ss  (if_then_else_M (tta1 x5 x2 1) qa212_ss  (if_then_else_M (tta1 x5 x3 1) qa212_ss  (if_then_else_M (tta1 x5 x4 1) qa212_ss (if_then_else_M (tta1 x5 x1 2) qa122_ss (if_then_else_M (tta1 x5 x2 2) qa122_ss   (if_then_else_M (tta1 x5 x3 2) qa122_ss  (if_then_else_M (tta1 x5 x4 2) qa122_ss  (if_then_else_M (tta2 x5 x2 x1 3) qa113_ss  (if_then_else_M (tta2 x5 x3 x1 3) qa113_ss  (if_then_else_M (tta2 x5 x3 x2 3) qa113_ss (if_then_else_M (tta2 x5 x4 x3 3) qa113_ss O)))))))))))).

Definition qa103_sss := (if_then_else_M (tta1 x5 x1 1) qa203_ss  (if_then_else_M (tta1 x5 x2 1) qa203_ss  (if_then_else_M (tta1 x5 x3 1) qa203_ss  (if_then_else_M (tta1 x5 x4 1) qa203_ss   (if_then_else_M (EQ_M (reveal x5) (i 2) ) O (if_then_else_M (EQ_M (to x5) (i 2)) qa113_ss O)))))).
Definition qa022_sss :=  (if_then_else_M (tta2 x5 x2 x1 3) qa023_ss  (if_then_else_M (tta2 x5 x3 x1 3) qa023_ss (if_then_else_M (tta2 x5 x3 x2 3) qa023_ss (if_then_else_M (tta2 x5 x4 x3 3) qa023_ss (if_then_else_M (EQ_M (reveal x5) (i 1) ) O (if_then_else_M (EQ_M (to x5) (i 1)) qa122_ss O) ))))).
Definition qa013_sss :=  (if_then_else_M (tta1 x5 x1 2) qa023_ss  (if_then_else_M (tta1 x5 x2 2) qa023_ss   (if_then_else_M (tta1 x5 x3 2) qa023_ss  (if_then_else_M (tta1 x5 x4 2) qa023_ss   (if_then_else_M (EQ_M (reveal x5) (i 1) ) O  (if_then_else_M (EQ_M (reveal x5) (i 2) ) O (if_then_else_M (EQ_M (to x5) (i 1)) qa113_s O ))))))).

(*******************************************************************************************************************)
(********************************************************************************************************************)
Definition qa210_ssss :=  (if_then_else_M (tta1 x4 x1 2) qa220_sss  (if_then_else_M (tta1 x4 x2 2) qa220_sss   (if_then_else_M (tta1 x4 x2 2) qa220_sss (if_then_else_M (EQ_M (reveal x4) (i 3) ) O  (if_then_else_M ((EQ_M (to x4) (i 3)) & (EQ_M (act x4) new)) qa211_sss O) )))).

Definition  qa201_ssss := (if_then_else_M (EQ_M (reveal x4) (i 2) ) O (if_then_else_M (EQ_M (reveal x4) (i 3) ) O   (if_then_else_M (EQ_M (to x4) (i 2))  qa211_sss    (if_then_else_M (EQ_M (to x4) (i 3))  qa202_sss   O)))).

Definition qa120_ssss :=   (if_then_else_M (tta1 x4 x1 1) qa220_sss  (if_then_else_M (tta1 x4 x2 1) qa220_sss  (if_then_else_M ((EQ_M (to x4) (i 3)) & (EQ_M (act x4) new)) qa121_sss O) )).

Definition qa111_ssss := (if_then_else_M (tta1 x4 x1 1) qa211_sss  (if_then_else_M (tta1 x4 x2 1) qa211_sss  (if_then_else_M (tta1 x4 x3 1)  qa211_sss (if_then_else_M (tta1 x4 x1 2)  qa211_sss  (if_then_else_M (tta1 x4 x2 2) qa121_sss  (if_then_else_M (tta1 x4 x3 2) qa121_sss  (if_then_else_M (EQ_M (reveal x4) (i 3) ) O (if_then_else_M (EQ_M (to x4) (i 3)) qa112_sss O)))))))).

Definition qa102_ssss :=  (if_then_else_M (tta1 x4 x1 1) qa202_sss  (if_then_else_M (tta1 x4 x2 1) qa202_sss  (if_then_else_M (tta1 x4 x3 1) qa202_sss (if_then_else_M (tta2 x4 x2 x1 3) qa103_sss  (if_then_else_M (tta2 x4 x3 x1 3) qa103_sss  (if_then_else_M (tta2 x4 x3 x2 3) qa103_sss (if_then_else_M (EQ_M (to x4) (i 2)) qa112_sss O) )))))).

Definition qa021_ssss := (if_then_else_M (EQ_M (reveal x4) (i 1) ) O (if_then_else_M (EQ_M (reveal x4) (i 3) ) O   (if_then_else_M (EQ_M (to x4) (i 1)) qa121_sss (if_then_else_M (EQ_M (to x4) (i 3)) qa022_sss O )))).

Definition qa012_ssss :=  (if_then_else_M (tta1 x4 x1 2) qa022_sss  (if_then_else_M (tta1 x4 x2 2) qa022_sss  (if_then_else_M (tta1 x4 x3 2) qa022_sss (if_then_else_M (tta2 x4 x2 x1 3) qa013_sss  (if_then_else_M (tta2 x4 x3 x1 3)  qa013_sss  (if_then_else_M (tta2 x4 x3 x2 3)  qa013_sss (if_then_else_M (EQ_M (reveal x4) (i 1) ) O  (if_then_else_M (EQ_M (to x4) (i 1)) qa112_sss O)))))))).

Definition qa003_ssss := (if_then_else_M (EQ_M (reveal x4) (i 1) ) O (if_then_else_M (EQ_M (reveal x4) (i 2) ) O (if_then_else_M (EQ_M (to x4) (i 1)) qa103_sss (if_then_else_M (EQ_M (to x4) (i 2)) qa013_sss O)))).

(********************************************************************************************)
(*******************************************************************************************)

Definition qa200_sssss := (if_then_else_M (EQ_M (reveal x3) (i 2) ) O (if_then_else_M (EQ_M (reveal x3) (i 3) ) O (if_then_else_M (EQ_M (to x3) (i 2)) qa210_ssss  (if_then_else_M (EQ_M (to x3 ) (i 3)) & (EQ_M (act x3) new) qa201_ssss O)))).
Definition qa110_sssss := (if_then_else_M (tta1 x3 x1 1) qa210_ssss (if_then_else_M (tta1 x3 x2 1) qa210_ssss
 (if_then_else_M (tta1 x3 x1 2) qa210_ssss (if_then_else_M (tta1 x3 x2 2) qa210_ssss 
 (if_then_else_M ((EQ_M (to x3) (i 3)) & (EQ_M (act x3) new)) qa111_ssss  O))))).

Definition qa101_sssss := (if_then_else_M (tta1 x3 x1 1) qa201_ssss (if_then_else_M (tta1 x3 x2 1) qa201_ssss  (if_then_else_M (EQ_M (reveal x3) (i 2) ) O (if_then_else_M (EQ_M (reveal x3) (i 3) ) O (if_then_else_M (EQ_M (to x3) (i 2)) qa111_ssss
 (if_then_else_M (EQ_M (to x3) (i 3)) qa102_ssss  O)))))).
(*************qa010 -> qbar, qa020, qa110, qa011*****************************)

Definition qa020_sssss := (if_then_else_M (EQ_M (reveal x3) (i 1) ) O (if_then_else_M (EQ_M (reveal x3) (i 3) ) O (if_then_else_M (EQ_M (to x3) (i 1)) qa120_ssss
 (if_then_else_M ((EQ_M (to x3) (i 3)) & (EQ_M (act x3) new)) qa021_ssss  O)))).

Definition qa011_sssss := (if_then_else_M (tta1 x3 x1 2) qa021_ssss  (if_then_else_M (tta1 x3 x2 2) qa021_ssss 
 (if_then_else_M (EQ_M (reveal x3) (i 1) ) O (if_then_else_M (EQ_M (reveal x3) (i 3) ) O (if_then_else_M (EQ_M (to x3) (i 1)) qa111_ssss
 (if_then_else_M (EQ_M (to x3) (i 3)) qa012_ssss  O)))))).

(************qa001 -> qabar, qa101, qa011, qa002*****************************)

Definition qa002_sssss := (if_then_else_M (tta2 x3 x2 x1 3) qa003_ssss (if_then_else_M (EQ_M (reveal x3) (i 1) ) O (if_then_else_M (EQ_M (reveal x3) (i 2) ) O (if_then_else_M (EQ_M (to x3) (i 1)) qa102_ssss
 (if_then_else_M (EQ_M (to x3) (i 2) ) qa012_ssss  O))))).




(***********************************************************)

Definition qa100_ssssss := (if_then_else_M (tta1 x2 x1 1) qa200_sssss (if_then_else_M (EQ_M (reveal x2) (i 2) ) O (if_then_else_M (EQ_M (reveal x2) (i 3) ) O (if_then_else_M (EQ_M (to x2) (i 2)) qa110_sssss  (if_then_else_M (EQ_M (to x2 ) (i 3)) & (EQ_M (act x2) new) qa101_sssss O))))).


Definition qa010_ssssss := (if_then_else_M (tta1 x2 x1 2) qa020_sssss  (if_then_else_M (EQ_M (reveal x2) (i 1) ) O (if_then_else_M (EQ_M (reveal x2) (i 2) ) O (if_then_else_M (EQ_M (reveal x2) (i 3) ) O  (if_then_else_M (EQ_M (to x2) (i 1)) qa110_sssss  (if_then_else_M (EQ_M (to x2 ) (i 3)) & (EQ_M (act x2) new) qa011_sssss O)))))).

Definition qa001_ssssss :=  (if_then_else_M (EQ_M (reveal x2) (i 1) ) O (if_then_else_M (EQ_M (reveal x2) (i 2) ) O (if_then_else_M (EQ_M (reveal x2) (i 3) ) O (if_then_else_M (EQ_M (to x2) (i 1))  qa101_sssss  (if_then_else_M (EQ_M (to x2) (i 2))  qa011_sssss (if_then_else_M (EQ_M (to x2) (i 3))  qa002_sssss  O) ) )))).


Definition t19 :=  msg (if_then_else_M (EQ_M (reveal x1) (i 1) ) O (if_then_else_M (EQ_M (reveal x1) (i 2) ) O (if_then_else_M (EQ_M (reveal x1) (i 3) ) O (if_then_else_M (EQ_M (to x1) (i 1)) qa100_sssss (if_then_else_M (EQ_M (to x1) (i 2)) qa010_sssss (if_then_else_M ((EQ_M (to x1) (i 3)) & (EQ_M (act x1) new)) qa001_sssss  O) ) )))).
Definition phi8:= phi7 ++ [t19].









(******************************************************************************************************************************************************)
(******************************************************************************************************************************************************)
(***********************protocol Pi2 : add transitions to qa2001************)
(***************************************************************************)



Definition phi21 := phi1.
Definition phi22 := phi2.
Definition phi23 := phi3.

(*****************alpha = 3, beta =1**********************)
Definition qb102 :=   (if_then_else_M (EQ_M (reveal  x4) (i 1) ) & (EQ_M (to  x3) (i 3)) &(EQ_M (to x2) (i 1))&(EQ_M (to x1) (i 3)) & (notb (EQ_M ( act x3) new)) &(EQ_M (act x1) new) &(EQ_M (m x2) (grn 1)) &(EQ_M (m  x3) (grn 2)) (grn 4) (if_then_else_M (EQ_M (reveal  x4) (i 3) ) & (EQ_M (to  x3) (i 3)) &(EQ_M (to x2) (i 1))&(EQ_M (to x1) (i 3)) & (notb (EQ_M ( act x3) new)) &(EQ_M (act x1) new) &(EQ_M (m x2) (grn 1)) &(EQ_M (m  x3) (grn 2)) (grn 4)  (if_then_else_M (tta1 x4 x1 1) mx1rn1  (if_then_else_M (tta1 x4 x2 1) mx2rn2  (if_then_else_M (tta1 x4 x3 1) mx3rn3 (if_then_else_M (tta2 x4 x2 x1 3) mx2rn1  (if_then_else_M (tta2 x4 x3 x1 3) mx3rn1  (if_then_else_M (tta2 x4 x3 x2 3) mx3rn2 (if_then_else_M (EQ_M (to x4) (i 3)) (grn 23) O) )))))))).
(***********alpha=3, beta=2******************************)

Definition qb012 :=  (if_then_else_M (EQ_M (reveal  x4) (i 2) ) & (EQ_M (to  x3) (i 3)) &(EQ_M (to x2) (i 1))&(EQ_M (to x1) (i 3)) & (notb (EQ_M ( act x3) new)) &(EQ_M (act x1) new) &(EQ_M (m x2) (grn 1)) &(EQ_M (m  x3) (grn 2)) (grn 4) (if_then_else_M (EQ_M (reveal  x4) (i 3) ) & (EQ_M (to  x3) (i 3)) &(EQ_M (to x2) (i 1))&(EQ_M (to x1) (i 3)) & (notb (EQ_M ( act x3) new)) &(EQ_M (act x1) new) &(EQ_M (m x2) (grn 1)) &(EQ_M (m  x3) (grn 2)) (grn 4)  (if_then_else_M (tta1 x4 x1 2) mx1rn1  (if_then_else_M (tta1 x4 x2 2) mx2rn2  (if_then_else_M (tta1 x4 x3 2) mx3rn3 (if_then_else_M (tta2 x4 x2 x1 3) mx2rn1  (if_then_else_M (tta2 x4 x3 x1 3) mx3rn1  (if_then_else_M (tta2 x4 x3 x2 3) mx3rn2 (if_then_else_M (EQ_M (reveal x4) (i 1) ) O  (if_then_else_M (EQ_M (to x4) (i 1)) (grn 25) O)))))))))).

(**************************************************************************************************)

(********************************************************************************************)
(*******************************************************************************************)



Definition qb101_s := (if_then_else_M (tta1 x3 x1 1) qa201 (if_then_else_M (tta1 x3 x2 1) qa201  (if_then_else_M (EQ_M (reveal x3) (i 2) ) O (if_then_else_M (EQ_M (reveal x3) (i 3) ) O (if_then_else_M (EQ_M (to x3) (i 2)) qa111
 (if_then_else_M (EQ_M (to x3) (i 3)) qb102  O)))))).
(*************qa010 -> qbar, qa020, qa110, qa011*****************************)


Definition qb011_s := (if_then_else_M (tta1 x3 x1 2) qa021  (if_then_else_M (tta1 x3 x2 2) qa021 
 (if_then_else_M (EQ_M (reveal x3) (i 1) ) O (if_then_else_M (EQ_M (reveal x3) (i 3) ) O (if_then_else_M (EQ_M (to x3) (i 1)) qa111
 (if_then_else_M (EQ_M (to x3) (i 3)) qa012  O)))))).

(************qa001 -> qabar, qa101, qa011, qa002*****************************)

Definition qb002_s:= (if_then_else_M (tta2 x3 x2 x1 3) qa003 (if_then_else_M (EQ_M (reveal x3) (i 1) ) O (if_then_else_M (EQ_M (reveal x3) (i 2) ) O (if_then_else_M (EQ_M (to x3) (i 1)) qb102
 (if_then_else_M (EQ_M (to x3) (i 2) ) qa012  O))))).




(***********************************************************)

Definition qb100_ss := (if_then_else_M (tta1 x2 x1 1) qa200_s (if_then_else_M (EQ_M (reveal x2) (i 2) ) O (if_then_else_M (EQ_M (reveal x2) (i 3) ) O (if_then_else_M (EQ_M (to x2) (i 2)) qa110_s  (if_then_else_M (EQ_M (to x2 ) (i 3)) & (EQ_M (act x2) new) qb101_s O))))).




Definition qb001_ss:=  (if_then_else_M (EQ_M (reveal x2) (i 1) ) O (if_then_else_M (EQ_M (reveal x2) (i 2) ) O (if_then_else_M (EQ_M (reveal x2) (i 3) ) O (if_then_else_M (EQ_M (to x2) (i 1))  qb101_s  (if_then_else_M (EQ_M (to x2) (i 2))  qa011_s (if_then_else_M (EQ_M (to x2) (i 3))  qa002_s  O) ) )))).


Definition t25 :=  msg (if_then_else_M (EQ_M (reveal x1) (i 1) ) O (if_then_else_M (EQ_M (reveal x1) (i 2) ) O (if_then_else_M (EQ_M (reveal x1) (i 3) ) O (if_then_else_M (EQ_M (to x1) (i 1)) qb100_ss (if_then_else_M (EQ_M (to x1) (i 2)) qa010_ss (if_then_else_M ((EQ_M (to x1) (i 3)) & (EQ_M (act x1) new)) qb001_ss  O) ) )))).
Definition phi24:= phi3 ++ [t25].


(*********************************phi25***********************************************************)
(*************************************************************************************************)

(*********************alpha = 3, beta=2****************************)
Definition qb112:=  (if_then_else_M (EQ_M (reveal  x4) (i 2) ) & (EQ_M (to  x3) (i 3)) &(EQ_M (to x2) (i 1))&(EQ_M (to x1) (i 3)) & (notb (EQ_M ( act x3) new)) &(EQ_M (act x1) new) &(EQ_M (m x2) (grn 1)) &(EQ_M (m  x3) (grn 2)) (grn 4) (if_then_else_M (EQ_M (reveal  x4) (i 3) ) & (EQ_M (to  x3) (i 3)) &(EQ_M (to x2) (i 1))&(EQ_M (to x1) (i 3)) & (notb (EQ_M ( act x3) new)) &(EQ_M (act x1) new) &(EQ_M (m x2) (grn 1)) &(EQ_M (m  x3) (grn 2)) (grn 4) (if_then_else_M (EQ_M (reveal  x4) (i 1) ) & (EQ_M (to  x3) (i 3)) &(EQ_M (to x2) (i 1))&(EQ_M (to x1) (i 3)) & (notb (EQ_M ( act x3) new)) &(EQ_M (act x1) new) &(EQ_M (m x2) (grn 1)) &(EQ_M (m  x3) (grn 2)) (grn 4)  (if_then_else_M (tta1 x5 x1 1) mx1rn1  (if_then_else_M (tta1 x5 x2 1) mx2rn2   (if_then_else_M (tta1 x5 x3 1) mx3rn3  (if_then_else_M (tta1 x5 x4 1) mx4rn4 (if_then_else_M (tta1 x5 x1 2) mx1rn1  (if_then_else_M (tta1 x5 x2 2) mx2rn2   (if_then_else_M (tta1 x5 x3 2) mx3rn3  (if_then_else_M (tta1 x5 x4 2) mx4rn4  (if_then_else_M (tta2 x5 x2 x1 3) mx2rn1  (if_then_else_M (tta2 x5 x3 x1 3) mx3rn1  (if_then_else_M (tta2 x5 x3 x2 3) mx3rn2 (if_then_else_M (tta2 x5 x4 x3 3) mx4rn3 O))))))))))))))).



(*******************************************************************************************************************)
(********************************************************************************************************************)


Definition qb111_s := (if_then_else_M (tta1 x4 x1 1) qa211  (if_then_else_M (tta1 x4 x2 1) qa211  (if_then_else_M (tta1 x4 x3 1)  qa211 (if_then_else_M (tta1 x4 x1 2)  qa211  (if_then_else_M (tta1 x4 x2 2) qa121  (if_then_else_M (tta1 x4 x3 2) qa121  (if_then_else_M (EQ_M (reveal x4) (i 3) ) O (if_then_else_M (EQ_M (to x4) (i 3)) qb112 O)))))))).

Definition qb102_s :=  (if_then_else_M (tta1 x4 x1 1) qa202  (if_then_else_M (tta1 x4 x2 1) qa202  (if_then_else_M (tta1 x4 x3 1) qa202 (if_then_else_M (tta2 x4 x2 x1 3) qa103  (if_then_else_M (tta2 x4 x3 x1 3) qa103  (if_then_else_M (tta2 x4 x3 x2 3) qa103 (if_then_else_M (EQ_M (to x4) (i 2)) qb112 O) )))))).


Definition qb012_s :=  (if_then_else_M (tta1 x4 x1 2) qa022  (if_then_else_M (tta1 x4 x2 2) qa022  (if_then_else_M (tta1 x4 x3 2) qa022 (if_then_else_M (tta2 x4 x2 x1 3) qa013  (if_then_else_M (tta2 x4 x3 x1 3)  qa013  (if_then_else_M (tta2 x4 x3 x2 3)  qa013 (if_then_else_M (EQ_M (reveal x4) (i 1) ) O  (if_then_else_M (EQ_M (to x4) (i 1)) qb112 O)))))))).

(********************************************************************************************)
(*******************************************************************************************)


Definition qb110_ss := (if_then_else_M (tta1 x3 x1 1) qa210_s (if_then_else_M (tta1 x3 x2 1) qa210_s 
 (if_then_else_M (tta1 x3 x1 2) qa210_s (if_then_else_M (tta1 x3 x2 2) qa210_s 
 (if_then_else_M ((EQ_M (to x3) (i 3)) & (EQ_M (act x3) new)) qb111_s  O))))).

Definition qb101_ss := (if_then_else_M (tta1 x3 x1 1) qa201_s (if_then_else_M (tta1 x3 x2 1) qa201_s  (if_then_else_M (EQ_M (reveal x3) (i 2) ) O (if_then_else_M (EQ_M (reveal x3) (i 3) ) O (if_then_else_M (EQ_M (to x3) (i 2)) qb111_s
 (if_then_else_M (EQ_M (to x3) (i 3)) qa102_s  O)))))).
(*************qa010 -> qbar, qa020, qa110, qa011*****************************)


Definition qb011_ss := (if_then_else_M (tta1 x3 x1 2) qa021_s  (if_then_else_M (tta1 x3 x2 2) qa021_s 
 (if_then_else_M (EQ_M (reveal x3) (i 1) ) O (if_then_else_M (EQ_M (reveal x3) (i 3) ) O (if_then_else_M (EQ_M (to x3) (i 1)) qb111_s
 (if_then_else_M (EQ_M (to x3) (i 3)) qa012_s  O)))))).







(***********************************************************)

Definition qb100_sss := (if_then_else_M (tta1 x2 x1 1) qa200_ss (if_then_else_M (EQ_M (reveal x2) (i 2) ) O (if_then_else_M (EQ_M (reveal x2) (i 3) ) O (if_then_else_M (EQ_M (to x2) (i 2)) qb110_ss  (if_then_else_M (EQ_M (to x2 ) (i 3)) & (EQ_M (act x2) new) qa101_ss O))))).


Definition qb010_sss := (if_then_else_M (tta1 x2 x1 2) qa020_ss  (if_then_else_M (EQ_M (reveal x2) (i 1) ) O (if_then_else_M (EQ_M (reveal x2) (i 2) ) O (if_then_else_M (EQ_M (reveal x2) (i 3) ) O  (if_then_else_M (EQ_M (to x2) (i 1)) qb110_ss  (if_then_else_M (EQ_M (to x2 ) (i 3)) & (EQ_M (act x2) new) qa011_ss O)))))).




Definition t26 :=  msg (if_then_else_M (EQ_M (reveal x1) (i 1) ) O (if_then_else_M (EQ_M (reveal x1) (i 2) ) O (if_then_else_M (EQ_M (reveal x1) (i 3) ) O (if_then_else_M (EQ_M (to x1) (i 1)) qb100_sss (if_then_else_M (EQ_M (to x1) (i 2)) qb010_sss (if_then_else_M ((EQ_M (to x1) (i 3)) & (EQ_M (act x1) new)) qa001_sss  O) ) )))).
Definition phi25:= phi24 ++ [t26].





(************************************************************************************)
(************************************************************************************)
(************************Protocol Pi2'': replace the output grn4 by mx12rn2 , mx13rn1 in the term qb2001 in Pi2**********)
(************************************************************************************************************************)



Definition phi31 := phi1.
Definition phi32 := phi2.
Definition phi33 := phi3.

(*****************alpha = 3, beta =1**********************)
Definition qc102 :=   (if_then_else_M (EQ_M (reveal  x4) (i 1) ) & (EQ_M (to  x3) (i 3)) &(EQ_M (to x2) (i 1))&(EQ_M (to x1) (i 3)) & (notb (EQ_M ( act x3) new)) &(EQ_M (act x1) new) &(EQ_M (m x2) (grn 1)) &(EQ_M (m  x3) (grn 2)) mx2rn2 (if_then_else_M (EQ_M (reveal  x4) (i 3) ) & (EQ_M (to  x3) (i 3)) &(EQ_M (to x2) (i 1))&(EQ_M (to x1) (i 3)) & (notb (EQ_M ( act x3) new)) &(EQ_M (act x1) new) &(EQ_M (m x2) (grn 1)) &(EQ_M (m  x3) (grn 2)) mx3rn1  (if_then_else_M (tta1 x4 x1 1) mx1rn1  (if_then_else_M (tta1 x4 x2 1) mx2rn2  (if_then_else_M (tta1 x4 x3 1) mx3rn3 (if_then_else_M (tta2 x4 x2 x1 3) mx2rn1  (if_then_else_M (tta2 x4 x3 x1 3) mx3rn1  (if_then_else_M (tta2 x4 x3 x2 3) mx3rn2 (if_then_else_M (EQ_M (to x4) (i 3)) (grn 23) O) )))))))).
(***********alpha=3, beta=2******************************)

Definition qc012 :=  (if_then_else_M (EQ_M (reveal  x4) (i 2) ) & (EQ_M (to  x3) (i 3)) &(EQ_M (to x2) (i 1))&(EQ_M (to x1) (i 3)) & (notb (EQ_M ( act x3) new)) &(EQ_M (act x1) new) &(EQ_M (m x2) (grn 1)) &(EQ_M (m  x3) (grn 2)) mx2rn2 (if_then_else_M (EQ_M (reveal  x4) (i 3) ) & (EQ_M (to  x3) (i 3)) &(EQ_M (to x2) (i 1))&(EQ_M (to x1) (i 3)) & (notb (EQ_M ( act x3) new)) &(EQ_M (act x1) new) &(EQ_M (m x2) (grn 1)) &(EQ_M (m  x3) (grn 2)) mx3rn1  (if_then_else_M (tta1 x4 x1 2) mx1rn1  (if_then_else_M (tta1 x4 x2 2) mx2rn2  (if_then_else_M (tta1 x4 x3 2) mx3rn3 (if_then_else_M (tta2 x4 x2 x1 3) mx2rn1  (if_then_else_M (tta2 x4 x3 x1 3) mx3rn1  (if_then_else_M (tta2 x4 x3 x2 3) mx3rn2 (if_then_else_M (EQ_M (reveal x4) (i 1) ) O  (if_then_else_M (EQ_M (to x4) (i 1)) (grn 25) O)))))))))).

(**************************************************************************************************)

(********************************************************************************************)
(*******************************************************************************************)



Definition qc101_s := (if_then_else_M (tta1 x3 x1 1) qa201 (if_then_else_M (tta1 x3 x2 1) qa201  (if_then_else_M (EQ_M (reveal x3) (i 2) ) O (if_then_else_M (EQ_M (reveal x3) (i 3) ) O (if_then_else_M (EQ_M (to x3) (i 2)) qa111
 (if_then_else_M (EQ_M (to x3) (i 3)) qc102  O)))))).
(*************qa010 -> qbar, qa020, qa110, qa011*****************************)


Definition qc011_s := (if_then_else_M (tta1 x3 x1 2) qa021  (if_then_else_M (tta1 x3 x2 2) qa021 
 (if_then_else_M (EQ_M (reveal x3) (i 1) ) O (if_then_else_M (EQ_M (reveal x3) (i 3) ) O (if_then_else_M (EQ_M (to x3) (i 1)) qa111
 (if_then_else_M (EQ_M (to x3) (i 3)) qa012  O)))))).

(************qa001 -> qabar, qa101, qa011, qa002*****************************)

Definition qc002_s:= (if_then_else_M (tta2 x3 x2 x1 3) qa003 (if_then_else_M (EQ_M (reveal x3) (i 1) ) O (if_then_else_M (EQ_M (reveal x3) (i 2) ) O (if_then_else_M (EQ_M (to x3) (i 1)) qc102
 (if_then_else_M (EQ_M (to x3) (i 2) ) qa012  O))))).




(***********************************************************)

Definition qc100_ss := (if_then_else_M (tta1 x2 x1 1) qa200_s (if_then_else_M (EQ_M (reveal x2) (i 2) ) O (if_then_else_M (EQ_M (reveal x2) (i 3) ) O (if_then_else_M (EQ_M (to x2) (i 2)) qa110_s  (if_then_else_M (EQ_M (to x2 ) (i 3)) & (EQ_M (act x2) new) qc101_s O))))).




Definition qc001_ss:=  (if_then_else_M (EQ_M (reveal x2) (i 1) ) O (if_then_else_M (EQ_M (reveal x2) (i 2) ) O (if_then_else_M (EQ_M (reveal x2) (i 3) ) O (if_then_else_M (EQ_M (to x2) (i 1))  qc101_s  (if_then_else_M (EQ_M (to x2) (i 2))  qa011_s (if_then_else_M (EQ_M (to x2) (i 3))  qa002_s  O) ) )))).


Definition t35 :=  msg (if_then_else_M (EQ_M (reveal x1) (i 1) ) O (if_then_else_M (EQ_M (reveal x1) (i 2) ) O (if_then_else_M (EQ_M (reveal x1) (i 3) ) O (if_then_else_M (EQ_M (to x1) (i 1)) qc100_ss (if_then_else_M (EQ_M (to x1) (i 2)) qa010_ss (if_then_else_M ((EQ_M (to x1) (i 3)) & (EQ_M (act x1) new)) qc001_ss  O) ) )))).
Definition phi34:= phi33 ++ [t35].


(*********************************phi25***********************************************************)
(*************************************************************************************************)

(*********************alpha = 3, beta=2****************************)
Definition qc112:=  (if_then_else_M (EQ_M (reveal  x4) (i 2) ) & (EQ_M (to  x3) (i 3)) &(EQ_M (to x2) (i 1))&(EQ_M (to x1) (i 3)) & (notb (EQ_M ( act x3) new)) &(EQ_M (act x1) new) &(EQ_M (m x2) (grn 1)) &(EQ_M (m  x3) (grn 2)) (grn 4) (if_then_else_M (EQ_M (reveal  x4) (i 3) ) & (EQ_M (to  x3) (i 3)) &(EQ_M (to x2) (i 1))&(EQ_M (to x1) (i 3)) & (notb (EQ_M ( act x3) new)) &(EQ_M (act x1) new) &(EQ_M (m x2) (grn 1)) &(EQ_M (m  x3) (grn 2)) (grn 4) (if_then_else_M (EQ_M (reveal  x4) (i 1) ) & (EQ_M (to  x3) (i 3)) &(EQ_M (to x2) (i 1))&(EQ_M (to x1) (i 3)) & (notb (EQ_M ( act x3) new)) &(EQ_M (act x1) new) &(EQ_M (m x2) (grn 1)) &(EQ_M (m  x3) (grn 2)) (grn 4)  (if_then_else_M (tta1 x5 x1 1) mx1rn1  (if_then_else_M (tta1 x5 x2 1) mx2rn2   (if_then_else_M (tta1 x5 x3 1) mx3rn3  (if_then_else_M (tta1 x5 x4 1) mx4rn4 (if_then_else_M (tta1 x5 x1 2) mx1rn1  (if_then_else_M (tta1 x5 x2 2) mx2rn2   (if_then_else_M (tta1 x5 x3 2) mx3rn3  (if_then_else_M (tta1 x5 x4 2) mx4rn4  (if_then_else_M (tta2 x5 x2 x1 3) mx2rn1  (if_then_else_M (tta2 x5 x3 x1 3) mx3rn1  (if_then_else_M (tta2 x5 x3 x2 3) mx3rn2 (if_then_else_M (tta2 x5 x4 x3 3) mx4rn3 O))))))))))))))).



(*******************************************************************************************************************)
(********************************************************************************************************************)


Definition qc111_s := (if_then_else_M (tta1 x4 x1 1) qa211  (if_then_else_M (tta1 x4 x2 1) qa211  (if_then_else_M (tta1 x4 x3 1)  qa211 (if_then_else_M (tta1 x4 x1 2)  qa211  (if_then_else_M (tta1 x4 x2 2) qa121  (if_then_else_M (tta1 x4 x3 2) qa121  (if_then_else_M (EQ_M (reveal x4) (i 3) ) O (if_then_else_M (EQ_M (to x4) (i 3)) qc112 O)))))))).

Definition qc102_s :=  (if_then_else_M (tta1 x4 x1 1) qa202  (if_then_else_M (tta1 x4 x2 1) qa202  (if_then_else_M (tta1 x4 x3 1) qa202 (if_then_else_M (tta2 x4 x2 x1 3) qa103  (if_then_else_M (tta2 x4 x3 x1 3) qa103  (if_then_else_M (tta2 x4 x3 x2 3) qa103 (if_then_else_M (EQ_M (to x4) (i 2)) qc112 O) )))))).


Definition qc012_s :=  (if_then_else_M (tta1 x4 x1 2) qa022  (if_then_else_M (tta1 x4 x2 2) qa022  (if_then_else_M (tta1 x4 x3 2) qa022 (if_then_else_M (tta2 x4 x2 x1 3) qa013  (if_then_else_M (tta2 x4 x3 x1 3)  qa013  (if_then_else_M (tta2 x4 x3 x2 3)  qa013 (if_then_else_M (EQ_M (reveal x4) (i 1) ) O  (if_then_else_M (EQ_M (to x4) (i 1)) qc112 O)))))))).

(********************************************************************************************)
(*******************************************************************************************)


Definition qc110_ss := (if_then_else_M (tta1 x3 x1 1) qa210_s (if_then_else_M (tta1 x3 x2 1) qa210_s 
 (if_then_else_M (tta1 x3 x1 2) qa210_s (if_then_else_M (tta1 x3 x2 2) qa210_s 
 (if_then_else_M ((EQ_M (to x3) (i 3)) & (EQ_M (act x3) new)) qc111_s  O))))).

Definition qc101_ss := (if_then_else_M (tta1 x3 x1 1) qa201_s (if_then_else_M (tta1 x3 x2 1) qa201_s  (if_then_else_M (EQ_M (reveal x3) (i 2) ) O (if_then_else_M (EQ_M (reveal x3) (i 3) ) O (if_then_else_M (EQ_M (to x3) (i 2)) qc111_s
 (if_then_else_M (EQ_M (to x3) (i 3)) qa102_s  O)))))).
(*************qa010 -> qbar, qa020, qa110, qa011*****************************)


Definition qc011_ss := (if_then_else_M (tta1 x3 x1 2) qa021_s  (if_then_else_M (tta1 x3 x2 2) qa021_s 
 (if_then_else_M (EQ_M (reveal x3) (i 1) ) O (if_then_else_M (EQ_M (reveal x3) (i 3) ) O (if_then_else_M (EQ_M (to x3) (i 1)) qc111_s
 (if_then_else_M (EQ_M (to x3) (i 3)) qa012_s  O)))))).







(***********************************************************)

Definition qc100_sss := (if_then_else_M (tta1 x2 x1 1) qa200_ss (if_then_else_M (EQ_M (reveal x2) (i 2) ) O (if_then_else_M (EQ_M (reveal x2) (i 3) ) O (if_then_else_M (EQ_M (to x2) (i 2)) qc110_ss  (if_then_else_M (EQ_M (to x2 ) (i 3)) & (EQ_M (act x2) new) qa101_ss O))))).


Definition qc010_sss := (if_then_else_M (tta1 x2 x1 2) qa020_ss  (if_then_else_M (EQ_M (reveal x2) (i 1) ) O (if_then_else_M (EQ_M (reveal x2) (i 2) ) O (if_then_else_M (EQ_M (reveal x2) (i 3) ) O  (if_then_else_M (EQ_M (to x2) (i 1)) qc110_ss  (if_then_else_M (EQ_M (to x2 ) (i 3)) & (EQ_M (act x2) new) qa011_ss O)))))).




Definition t36 :=  msg (if_then_else_M (EQ_M (reveal x1) (i 1) ) O (if_then_else_M (EQ_M (reveal x1) (i 2) ) O (if_then_else_M (EQ_M (reveal x1) (i 3) ) O (if_then_else_M (EQ_M (to x1) (i 1)) qc100_sss (if_then_else_M (EQ_M (to x1) (i 2)) qc010_sss (if_then_else_M ((EQ_M (to x1) (i 3)) & (EQ_M (act x1) new)) qa001_sss  O) ) )))).
Definition phi35:= phi34 ++ [t36].









(******************************Protocol Pi2' : replace the output grn4 by grn21 in the term qb2001 in Pi2********)
(****************************************************************************************************************)

Definition grn21:= (exp (G 0) (exp (G 0) (g 0) (r 2)) (r 1)).

Definition phi41 := phi1.
Definition phi42 := phi2.
Definition phi43 := phi3.

(*****************alpha = 3, beta =1**********************)
Definition qd102 :=   (if_then_else_M (EQ_M (reveal  x4) (i 1) ) & (EQ_M (to  x3) (i 3)) &(EQ_M (to x2) (i 1))&(EQ_M (to x1) (i 3)) & (notb (EQ_M ( act x3) new)) &(EQ_M (act x1) new) &(EQ_M (m x2) (grn 1)) &(EQ_M (m  x3) (grn 2)) grn21 (if_then_else_M (EQ_M (reveal  x4) (i 3) ) & (EQ_M (to  x3) (i 3)) &(EQ_M (to x2) (i 1))&(EQ_M (to x1) (i 3)) & (notb (EQ_M ( act x3) new)) &(EQ_M (act x1) new) &(EQ_M (m x2) (grn 1)) &(EQ_M (m  x3) (grn 2)) grn21  (if_then_else_M (tta1 x4 x1 1) mx1rn1  (if_then_else_M (tta1 x4 x2 1) mx2rn2  (if_then_else_M (tta1 x4 x3 1) mx3rn3 (if_then_else_M (tta2 x4 x2 x1 3) mx2rn1  (if_then_else_M (tta2 x4 x3 x1 3) mx3rn1  (if_then_else_M (tta2 x4 x3 x2 3) mx3rn2 (if_then_else_M (EQ_M (to x4) (i 3)) (grn 23) O) )))))))).
(***********alpha=3, beta=2******************************)

Definition qd012 :=  (if_then_else_M (EQ_M (reveal  x4) (i 2) ) & (EQ_M (to  x3) (i 3)) &(EQ_M (to x2) (i 1))&(EQ_M (to x1) (i 3)) & (notb (EQ_M ( act x3) new)) &(EQ_M (act x1) new) &(EQ_M (m x2) (grn 1)) &(EQ_M (m  x3) (grn 2)) grn21 (if_then_else_M (EQ_M (reveal  x4) (i 3) ) & (EQ_M (to  x3) (i 3)) &(EQ_M (to x2) (i 1))&(EQ_M (to x1) (i 3)) & (notb (EQ_M ( act x3) new)) &(EQ_M (act x1) new) &(EQ_M (m x2) (grn 1)) &(EQ_M (m  x3) (grn 2)) grn21  (if_then_else_M (tta1 x4 x1 2) mx1rn1  (if_then_else_M (tta1 x4 x2 2) mx2rn2  (if_then_else_M (tta1 x4 x3 2) mx3rn3 (if_then_else_M (tta2 x4 x2 x1 3) mx2rn1  (if_then_else_M (tta2 x4 x3 x1 3) mx3rn1  (if_then_else_M (tta2 x4 x3 x2 3) mx3rn2 (if_then_else_M (EQ_M (reveal x4) (i 1) ) O  (if_then_else_M (EQ_M (to x4) (i 1)) (grn 25) O)))))))))).

(**************************************************************************************************)

(********************************************************************************************)
(*******************************************************************************************)



Definition qd101_s := (if_then_else_M (tta1 x3 x1 1) qa201 (if_then_else_M (tta1 x3 x2 1) qa201  (if_then_else_M (EQ_M (reveal x3) (i 2) ) O (if_then_else_M (EQ_M (reveal x3) (i 3) ) O (if_then_else_M (EQ_M (to x3) (i 2)) qa111
 (if_then_else_M (EQ_M (to x3) (i 3)) qd102  O)))))).
(*************qa010 -> qbar, qa020, qa110, qa011*****************************)


Definition qd011_s := (if_then_else_M (tta1 x3 x1 2) qa021  (if_then_else_M (tta1 x3 x2 2) qa021 
 (if_then_else_M (EQ_M (reveal x3) (i 1) ) O (if_then_else_M (EQ_M (reveal x3) (i 3) ) O (if_then_else_M (EQ_M (to x3) (i 1)) qa111
 (if_then_else_M (EQ_M (to x3) (i 3)) qa012  O)))))).

(************qa001 -> qabar, qa101, qa011, qa002*****************************)

Definition qd002_s:= (if_then_else_M (tta2 x3 x2 x1 3) qa003 (if_then_else_M (EQ_M (reveal x3) (i 1) ) O (if_then_else_M (EQ_M (reveal x3) (i 2) ) O (if_then_else_M (EQ_M (to x3) (i 1)) qd102
 (if_then_else_M (EQ_M (to x3) (i 2) ) qa012  O))))).




(***********************************************************)

Definition qd100_ss := (if_then_else_M (tta1 x2 x1 1) qa200_s (if_then_else_M (EQ_M (reveal x2) (i 2) ) O (if_then_else_M (EQ_M (reveal x2) (i 3) ) O (if_then_else_M (EQ_M (to x2) (i 2)) qa110_s  (if_then_else_M (EQ_M (to x2 ) (i 3)) & (EQ_M (act x2) new) qd101_s O))))).




Definition qd001_ss:=  (if_then_else_M (EQ_M (reveal x2) (i 1) ) O (if_then_else_M (EQ_M (reveal x2) (i 2) ) O (if_then_else_M (EQ_M (reveal x2) (i 3) ) O (if_then_else_M (EQ_M (to x2) (i 1))  qd101_s  (if_then_else_M (EQ_M (to x2) (i 2))  qa011_s (if_then_else_M (EQ_M (to x2) (i 3))  qa002_s  O) ) )))).


Definition t45 :=  msg (if_then_else_M (EQ_M (reveal x1) (i 1) ) O (if_then_else_M (EQ_M (reveal x1) (i 2) ) O (if_then_else_M (EQ_M (reveal x1) (i 3) ) O (if_then_else_M (EQ_M (to x1) (i 1)) qd100_ss (if_then_else_M (EQ_M (to x1) (i 2)) qa010_ss (if_then_else_M ((EQ_M (to x1) (i 3)) & (EQ_M (act x1) new)) qd001_ss  O) ) )))).
Definition phi44:= phi43 ++ [t45].


(*********************************phi25***********************************************************)
(*************************************************************************************************)

(*********************alpha = 3, beta=2****************************)
Definition qd112:=  (if_then_else_M (EQ_M (reveal  x4) (i 2) ) & (EQ_M (to  x3) (i 3)) &(EQ_M (to x2) (i 1))&(EQ_M (to x1) (i 3)) & (notb (EQ_M ( act x3) new)) &(EQ_M (act x1) new) &(EQ_M (m x2) (grn 1)) &(EQ_M (m  x3) (grn 2)) grn21 (if_then_else_M (EQ_M (reveal  x4) (i 3) ) & (EQ_M (to  x3) (i 3)) &(EQ_M (to x2) (i 1))&(EQ_M (to x1) (i 3)) & (notb (EQ_M ( act x3) new)) &(EQ_M (act x1) new) &(EQ_M (m x2) (grn 1)) &(EQ_M (m  x3) (grn 2)) grn21 (if_then_else_M (EQ_M (reveal  x4) (i 1) ) & (EQ_M (to  x3) (i 3)) &(EQ_M (to x2) (i 1))&(EQ_M (to x1) (i 3)) & (notb (EQ_M ( act x3) new)) &(EQ_M (act x1) new) &(EQ_M (m x2) (grn 1)) &(EQ_M (m  x3) (grn 2)) grn21  (if_then_else_M (tta1 x5 x1 1) mx1rn1  (if_then_else_M (tta1 x5 x2 1) mx2rn2   (if_then_else_M (tta1 x5 x3 1) mx3rn3  (if_then_else_M (tta1 x5 x4 1) mx4rn4 (if_then_else_M (tta1 x5 x1 2) mx1rn1  (if_then_else_M (tta1 x5 x2 2) mx2rn2   (if_then_else_M (tta1 x5 x3 2) mx3rn3  (if_then_else_M (tta1 x5 x4 2) mx4rn4  (if_then_else_M (tta2 x5 x2 x1 3) mx2rn1  (if_then_else_M (tta2 x5 x3 x1 3) mx3rn1  (if_then_else_M (tta2 x5 x3 x2 3) mx3rn2 (if_then_else_M (tta2 x5 x4 x3 3) mx4rn3 O))))))))))))))).



(*******************************************************************************************************************)
(********************************************************************************************************************)


Definition qd111_s := (if_then_else_M (tta1 x4 x1 1) qa211  (if_then_else_M (tta1 x4 x2 1) qa211  (if_then_else_M (tta1 x4 x3 1)  qa211 (if_then_else_M (tta1 x4 x1 2)  qa211  (if_then_else_M (tta1 x4 x2 2) qa121  (if_then_else_M (tta1 x4 x3 2) qa121  (if_then_else_M (EQ_M (reveal x4) (i 3) ) O (if_then_else_M (EQ_M (to x4) (i 3)) qd112 O)))))))).

Definition qd102_s :=  (if_then_else_M (tta1 x4 x1 1) qa202  (if_then_else_M (tta1 x4 x2 1) qa202  (if_then_else_M (tta1 x4 x3 1) qa202 (if_then_else_M (tta2 x4 x2 x1 3) qa103  (if_then_else_M (tta2 x4 x3 x1 3) qa103  (if_then_else_M (tta2 x4 x3 x2 3) qa103 (if_then_else_M (EQ_M (to x4) (i 2)) qd112 O) )))))).


Definition qd012_s :=  (if_then_else_M (tta1 x4 x1 2) qa022  (if_then_else_M (tta1 x4 x2 2) qa022  (if_then_else_M (tta1 x4 x3 2) qa022 (if_then_else_M (tta2 x4 x2 x1 3) qa013  (if_then_else_M (tta2 x4 x3 x1 3)  qa013  (if_then_else_M (tta2 x4 x3 x2 3)  qa013 (if_then_else_M (EQ_M (reveal x4) (i 1) ) O  (if_then_else_M (EQ_M (to x4) (i 1)) qd112 O)))))))).

(********************************************************************************************)
(*******************************************************************************************)


Definition qd110_ss := (if_then_else_M (tta1 x3 x1 1) qa210_s (if_then_else_M (tta1 x3 x2 1) qa210_s 
 (if_then_else_M (tta1 x3 x1 2) qa210_s (if_then_else_M (tta1 x3 x2 2) qa210_s 
 (if_then_else_M ((EQ_M (to x3) (i 3)) & (EQ_M (act x3) new)) qd111_s  O))))).

Definition qd101_ss := (if_then_else_M (tta1 x3 x1 1) qa201_s (if_then_else_M (tta1 x3 x2 1) qa201_s  (if_then_else_M (EQ_M (reveal x3) (i 2) ) O (if_then_else_M (EQ_M (reveal x3) (i 3) ) O (if_then_else_M (EQ_M (to x3) (i 2)) qd111_s
 (if_then_else_M (EQ_M (to x3) (i 3)) qa102_s  O)))))).
(*************qa010 -> qbar, qa020, qa110, qa011*****************************)


Definition qd011_ss := (if_then_else_M (tta1 x3 x1 2) qa021_s  (if_then_else_M (tta1 x3 x2 2) qa021_s 
 (if_then_else_M (EQ_M (reveal x3) (i 1) ) O (if_then_else_M (EQ_M (reveal x3) (i 3) ) O (if_then_else_M (EQ_M (to x3) (i 1)) qd111_s
 (if_then_else_M (EQ_M (to x3) (i 3)) qa012_s  O)))))).







(***********************************************************)

Definition qd100_sss := (if_then_else_M (tta1 x2 x1 1) qa200_ss (if_then_else_M (EQ_M (reveal x2) (i 2) ) O (if_then_else_M (EQ_M (reveal x2) (i 3) ) O (if_then_else_M (EQ_M (to x2) (i 2)) qd110_ss  (if_then_else_M (EQ_M (to x2 ) (i 3)) & (EQ_M (act x2) new) qa101_ss O))))).


Definition qd010_sss := (if_then_else_M (tta1 x2 x1 2) qa020_ss  (if_then_else_M (EQ_M (reveal x2) (i 1) ) O (if_then_else_M (EQ_M (reveal x2) (i 2) ) O (if_then_else_M (EQ_M (reveal x2) (i 3) ) O  (if_then_else_M (EQ_M (to x2) (i 1)) qd110_ss  (if_then_else_M (EQ_M (to x2 ) (i 3)) & (EQ_M (act x2) new) qa011_ss O)))))).




Definition t46 :=  msg (if_then_else_M (EQ_M (reveal x1) (i 1) ) O (if_then_else_M (EQ_M (reveal x1) (i 2) ) O (if_then_else_M (EQ_M (reveal x1) (i 3) ) O (if_then_else_M (EQ_M (to x1) (i 1)) qd100_sss (if_then_else_M (EQ_M (to x1) (i 2)) qd010_sss (if_then_else_M ((EQ_M (to x1) (i 3)) & (EQ_M (act x1) new)) qa001_sss  O) ) )))).
Definition phi45:= phi44 ++ [t46].

